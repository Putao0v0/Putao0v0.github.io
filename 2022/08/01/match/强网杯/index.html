<!-- build time:Sat Mar 04 2023 20:39:50 GMT+0800 (中国标准时间) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="putao" href="http://example.com/rss.xml"><link rel="alternate" type="application/atom+xml" title="putao" href="http://example.com/atom.xml"><link rel="alternate" type="application/json" title="putao" href="http://example.com/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><link rel="canonical" href="http://example.com/2022/08/01/match/%E5%BC%BA%E7%BD%91%E6%9D%AF/"><title>强网杯2022 - 比赛 | Putao0v0 = putao</title><meta name="generator" content="Hexo 6.2.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">强网杯2022</h1><div class="meta"><span class="item" title="创建时间：2022-08-01 00:00:00"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2022-08-01T00:00:00+08:00">2022-08-01</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>32k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>29 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Putao0v0</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://pic.imgdb.cn/item/63f1dd6df144a01007af3559.jpg"></li><li class="item" data-background-image="https://pic.imgdb.cn/item/63f1dd6cf144a01007af3424.jpg"></li><li class="item" data-background-image="https://pic.imgdb.cn/item/63f1dd6cf144a01007af346b.jpg"></li><li class="item" data-background-image="https://pic.imgdb.cn/item/63f1df1af144a01007b2ae47.jpg"></li><li class="item" data-background-image="https://pic.imgdb.cn/item/63f1dd6df144a01007af3540.jpg"></li><li class="item" data-background-image="https://pic.imgdb.cn/item/63f1dd76f144a01007af416d.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/match/" itemprop="item" rel="index" title="分类于 比赛"><span itemprop="name">比赛</span></a><meta itemprop="position" content="1"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="http://example.com/2022/08/01/match/%E5%BC%BA%E7%BD%91%E6%9D%AF/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/1.jpg"><meta itemprop="name" content="Putao0v0"><meta itemprop="description" content=", "></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="putao"></span><div class="body md" itemprop="articleBody"><blockquote><p>前言：出了 4 道密码题 (mxx307yyds)，还有两道关于格的，，，不太会 等复现吧</p></blockquote><h1 id="crypto-polydiv"><a class="anchor" href="#crypto-polydiv">#</a> crypto-polydiv</h1><h2 id="题目"><a class="anchor" href="#题目">#</a> 题目</h2><ul><li><p>题目描述</p><p>多项式乘法，已知 <code>a(x)*b(x)+c(x)=r(x)</code> ， <code>a(x),c(x),r(x)</code> 求 `b (x)</p><p>可以直接在 sage 上跑</p></li></ul><h2 id="exp"><a class="anchor" href="#exp">#</a> exp</h2><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> string</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span> hashlib</pre></td></tr><tr><td data-num="4"></td><td><pre>table <span class="token operator">=</span> string<span class="token punctuation">.</span>ascii_letters <span class="token operator">+</span> string<span class="token punctuation">.</span>digits</pre></td></tr><tr><td data-num="5"></td><td><pre>re <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">'182.92.222.142'</span><span class="token punctuation">,</span><span class="token number">45390</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre>re<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'sha256(XXXX+'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>x <span class="token operator">=</span> re<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>re<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b') == '</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>y <span class="token operator">=</span> re<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>flag <span class="token operator">=</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">for</span> a <span class="token keyword">in</span> table<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token keyword">if</span> flag<span class="token punctuation">:</span><span class="token keyword">break</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token keyword">for</span> b <span class="token keyword">in</span> table<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        <span class="token keyword">if</span> flag<span class="token punctuation">:</span> <span class="token keyword">break</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token keyword">for</span> c <span class="token keyword">in</span> table<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="18"></td><td><pre>            <span class="token keyword">if</span> flag<span class="token punctuation">:</span> <span class="token keyword">break</span></pre></td></tr><tr><td data-num="19"></td><td><pre>            <span class="token keyword">for</span> d <span class="token keyword">in</span> table<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="20"></td><td><pre>                z <span class="token operator">=</span> <span class="token punctuation">(</span>a <span class="token operator">+</span> b <span class="token operator">+</span> c <span class="token operator">+</span> d<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="21"></td><td><pre>                <span class="token keyword">if</span> hashlib<span class="token punctuation">.</span>sha256<span class="token punctuation">(</span>z <span class="token operator">+</span> x<span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> y<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="22"></td><td><pre>                    flag <span class="token operator">=</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="23"></td><td><pre>                    re<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'Give me XXXX: '</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre>                    re<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>z<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="25"></td><td><pre>                    <span class="token keyword">break</span></pre></td></tr><tr><td data-num="26"></td><td><pre></pre></td></tr><tr><td data-num="27"></td><td><pre>PR<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token operator">></span> <span class="token operator">=</span> Zmod<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="29"></td><td><pre>    re<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'r(x) = '</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="30"></td><td><pre>    r <span class="token operator">=</span> <span class="token builtin">eval</span><span class="token punctuation">(</span>re<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'^'</span><span class="token punctuation">,</span><span class="token string">'**'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    re<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'a(x) = '</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="32"></td><td><pre>    a <span class="token operator">=</span> <span class="token builtin">eval</span><span class="token punctuation">(</span>re<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'^'</span><span class="token punctuation">,</span><span class="token string">'**'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="33"></td><td><pre>    re<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'c(x) = '</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="34"></td><td><pre>    c <span class="token operator">=</span> <span class="token builtin">eval</span><span class="token punctuation">(</span>re<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'^'</span><span class="token punctuation">,</span><span class="token string">'**'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="35"></td><td><pre>    re<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'> b(x) = '</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="36"></td><td><pre>    b <span class="token operator">=</span> <span class="token punctuation">(</span>r <span class="token operator">-</span> c<span class="token punctuation">)</span> <span class="token operator">//</span> a</pre></td></tr><tr><td data-num="37"></td><td><pre>    <span class="token comment"># print(f'r = &#123;r&#125;')</span></pre></td></tr><tr><td data-num="38"></td><td><pre>    <span class="token comment"># print(f'a = &#123;a&#125;')</span></pre></td></tr><tr><td data-num="39"></td><td><pre>    <span class="token comment"># print(f'c = &#123;c&#125;')</span></pre></td></tr><tr><td data-num="40"></td><td><pre>    <span class="token comment"># print(f'(r-c)//a')</span></pre></td></tr><tr><td data-num="41"></td><td><pre>    <span class="token comment"># b = input()</span></pre></td></tr><tr><td data-num="42"></td><td><pre>    re<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="43"></td><td><pre>re<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="44"></td><td><pre><span class="token comment">#flag&#123;6c108498-234f-4626-8319-4aa26dcc1a10&#125;</span></pre></td></tr></table></figure><p><img data-src="https://img-blog.csdnimg.cn/c7284be2e2e84ab0883f669005fe3158.png" alt="img"></p><h1 id="crypto-asr"><a class="anchor" href="#crypto-asr">#</a> crypto-ASR</h1><h2 id="题目-2"><a class="anchor" href="#题目-2">#</a> 题目</h2><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> getPrime</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> secret <span class="token keyword">import</span> falg</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>pad <span class="token operator">=</span> <span class="token keyword">lambda</span> s<span class="token punctuation">:</span>s <span class="token operator">+</span> <span class="token builtin">bytes</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">16</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">16</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre>n <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span> <span class="token operator">*</span> getPrime<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span> <span class="token operator">*</span> getPrime<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span> <span class="token operator">*</span> getPrime<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span></pre></td></tr><tr><td data-num="7"></td><td><pre>e <span class="token operator">=</span> <span class="token number">3</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre>flag <span class="token operator">=</span> pad<span class="token punctuation">(</span>flag<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">assert</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">48</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>m <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>flag<span class="token punctuation">,</span><span class="token string">'big'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre>c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'n = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>n<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'e = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>e<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'c = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>c<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token triple-quoted-string string">'''</span></pre></td></tr><tr><td data-num="20"></td><td><pre>n = 8250871280281573979365095715711359115372504458973444367083195431861307534563246537364248104106494598081988216584432003199198805753721448450911308558041115465900179230798939615583517756265557814710419157462721793864532239042758808298575522666358352726060578194045804198551989679722201244547561044646931280001</pre></td></tr><tr><td data-num="21"></td><td><pre>e = 3</pre></td></tr><tr><td data-num="22"></td><td><pre>c = 945272793717722090962030960824180726576357481511799904903841312265308706852971155205003971821843069272938250385935597609059700446530436381124650731751982419593070224310399320617914955227288662661442416421725698368791013785074809691867988444306279231013360024747585261790352627234450209996422862329513284149</pre></td></tr><tr><td data-num="23"></td><td><pre>'''</pre></td></tr></table></figure><p n="">4 个因子，因为都是 128 位，yafu 直接分解\sqrt</p><p><img data-src="https://img-blog.csdnimg.cn/fb70be5c8116449c92ab1c8b9094ad58.png" alt="img"></p><p>最后<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">e=3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">3</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>φ</mi></mrow><annotation encoding="application/x-tex">\varphi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathnormal">φ</span></span></span></span> 有公因子 9 分别来自两个因子；由于<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">m</span></span></span></span> 比较小，直接选用另外两个因子做模数就好了</p><h2 id="exp-2"><a class="anchor" href="#exp-2">#</a> exp</h2><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>e <span class="token operator">=</span> <span class="token number">3</span></pre></td></tr><tr><td data-num="5"></td><td><pre>c <span class="token operator">=</span> <span class="token number">945272793717722090962030960824180726576357481511799904903841312265308706852971155205003971821843069272938250385935597609059700446530436381124650731751982419593070224310399320617914955227288662661442416421725698368791013785074809691867988444306279231013360024747585261790352627234450209996422862329513284149</span></pre></td></tr><tr><td data-num="6"></td><td><pre>n <span class="token operator">=</span> <span class="token number">8250871280281573979365095715711359115372504458973444367083195431861307534563246537364248104106494598081988216584432003199198805753721448450911308558041115465900179230798939615583517756265557814710419157462721793864532239042758808298575522666358352726060578194045804198551989679722201244547561044646931280001</span></pre></td></tr><tr><td data-num="7"></td><td><pre>n1 <span class="token operator">=</span> iroot<span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre>r1<span class="token punctuation">,</span> r2<span class="token punctuation">,</span> r3<span class="token punctuation">,</span> r4 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">225933944608558304529179430753170813347</span><span class="token punctuation">,</span> <span class="token number">218566259296037866647273372633238739089</span><span class="token punctuation">,</span> <span class="token number">223213222467584072959434495118689164399</span><span class="token punctuation">,</span> <span class="token number">260594583349478633632570848336184053653</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre>phi <span class="token operator">=</span> r3 <span class="token operator">*</span> r4 <span class="token operator">*</span> <span class="token punctuation">(</span>r3 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>r4 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>new_n <span class="token operator">=</span> <span class="token punctuation">(</span>r3 <span class="token operator">*</span> r4<span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span></pre></td></tr><tr><td data-num="13"></td><td><pre>d <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>m <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> new_n<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token comment"># b'flag&#123;Fear_can_hold_you_prisoner_Hope_can_set_you_free&#125;\x06\x06\x06\x06\x06\x06'</span></pre></td></tr></table></figure><h1 id="crypto-myjwt"><a class="anchor" href="#crypto-myjwt">#</a> crypto-myJWT</h1><h2 id="题目-3"><a class="anchor" href="#题目-3">#</a> 题目</h2><ul><li>考点：<span class="exturl" data-url="aHR0cHM6Ly9uZWlsbWFkZGVuLmJsb2cvMjAyMi8wNC8xOS9wc3ljaGljLXNpZ25hdHVyZXMtaW4tamF2YS8=">CVE-2022-21449</span></li></ul><p>使用的是 ECDSA，虽然是密码题，但并不是对 ECDSA 的签名、验证等步骤操作，这些都由 java 封装好了</p><p>所以是 java 的问题</p><p>由于代码中使用的格式是 <code>SHA384withECDSAinP1363Format</code> ，经过搜索是<span class="exturl" data-url="aHR0cHM6Ly9uZWlsbWFkZGVuLmJsb2cvMjAyMi8wNC8xOS9wc3ljaGljLXNpZ25hdHVyZXMtaW4tamF2YS8="> CVE-2022-21449</span>，发现竟然是 java 没有判断<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>r</mi><mo separator="true">,</mo><mi>s</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(r,s)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal">s</span><span class="mclose">)</span></span></span></span> 是否等于 0。。。</p><h2 id="exp-3"><a class="anchor" href="#exp-3">#</a> exp</h2><p>这里如何实现将<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo separator="true">,</mo><mi>s</mi></mrow><annotation encoding="application/x-tex">r,s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal">s</span></span></span></span> 都赋值为 0？我是直接穿了 0 的 base64 编码但是不对，，，看 CVE 的 demo 是直接喂 <code>\x00</code> 的 base64 编码，不懂为什么，还没深究</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> base64 <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>io <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">'47.104.76.78'</span><span class="token punctuation">,</span> <span class="token number">23334</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre>fake_sig <span class="token operator">=</span> <span class="token string">b'\x00\x00'</span></pre></td></tr><tr><td data-num="7"></td><td><pre>name <span class="token operator">=</span> <span class="token string">b'4xwi11'</span></pre></td></tr><tr><td data-num="8"></td><td><pre>io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">b'your name:'</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">b'>'</span><span class="token punctuation">,</span> <span class="token string">b'1'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>token <span class="token operator">=</span> io<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="11"></td><td><pre>head<span class="token punctuation">,</span> payload<span class="token punctuation">,</span> _ <span class="token operator">=</span> token<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>payload <span class="token operator">=</span> b64decode<span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">b'false'</span><span class="token punctuation">,</span> <span class="token string">b'true'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre>io<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">b'>'</span><span class="token punctuation">,</span> <span class="token string">b'2'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>payload_x <span class="token operator">=</span> head<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">b'.'</span> <span class="token operator">+</span> b64encode<span class="token punctuation">(</span>payload<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">b'.'</span> <span class="token operator">+</span> b64encode<span class="token punctuation">(</span>fake_sig<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre>io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload_x<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>io<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token comment"># b'your token:flag&#123;cve-2022-21449_Secur1ty_0f_c0de_1mplementation&#125;'</span></pre></td></tr></table></figure><h1 id="crypto-factor"><a class="anchor" href="#crypto-factor">#</a> crypto-Factor</h1><h2 id="题目-4"><a class="anchor" href="#题目-4">#</a> 题目</h2><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#encoding:utf-8</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">from</span> random <span class="token keyword">import</span> randint</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">from</span> flag <span class="token keyword">import</span> flag</pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">def</span> <span class="token function">gen1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="8"></td><td><pre>	r <span class="token operator">=</span> <span class="token number">2</span></pre></td></tr><tr><td data-num="9"></td><td><pre>	<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="10"></td><td><pre>		p2 <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1792</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>		p1 <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1792</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre>		q1 <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>		q2 <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre>		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token builtin">abs</span><span class="token punctuation">(</span>p1<span class="token operator">-</span>p2<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span>p1<span class="token operator">//</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>r<span class="token operator">*</span>q1<span class="token operator">*</span>q2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="17"></td><td><pre>			n1<span class="token punctuation">,</span> n2 <span class="token operator">=</span> <span class="token punctuation">(</span>p1<span class="token operator">**</span>r<span class="token punctuation">)</span><span class="token operator">*</span>q1<span class="token punctuation">,</span> <span class="token punctuation">(</span>p2<span class="token operator">**</span>r<span class="token punctuation">)</span><span class="token operator">*</span>q2</pre></td></tr><tr><td data-num="18"></td><td><pre>			<span class="token keyword">break</span></pre></td></tr><tr><td data-num="19"></td><td><pre></pre></td></tr><tr><td data-num="20"></td><td><pre>	phi1 <span class="token operator">=</span> <span class="token punctuation">(</span>p1<span class="token operator">**</span><span class="token punctuation">(</span>r<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>p1<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q1<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="21"></td><td><pre>	phi2 <span class="token operator">=</span> <span class="token punctuation">(</span>p2<span class="token operator">**</span><span class="token punctuation">(</span>r<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>p2<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q2<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="22"></td><td><pre>	<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="23"></td><td><pre>		e1 <span class="token operator">=</span> randint<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>p1<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q1<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre>		e2 <span class="token operator">=</span> randint<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>p2<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q2<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="25"></td><td><pre>		<span class="token keyword">if</span> gcd<span class="token punctuation">(</span>e1<span class="token punctuation">,</span> e2<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token keyword">and</span> gcd<span class="token punctuation">(</span>phi1<span class="token punctuation">,</span> e1<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token keyword">and</span> gcd<span class="token punctuation">(</span>phi2<span class="token punctuation">,</span> e2<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="26"></td><td><pre>			<span class="token keyword">break</span></pre></td></tr><tr><td data-num="27"></td><td><pre>	<span class="token keyword">return</span> n11<span class="token punctuation">,</span> n12<span class="token punctuation">,</span> e11<span class="token punctuation">,</span> e12</pre></td></tr><tr><td data-num="28"></td><td><pre></pre></td></tr><tr><td data-num="29"></td><td><pre></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token keyword">def</span> <span class="token function">gen2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="31"></td><td><pre>	r <span class="token operator">=</span> <span class="token number">7</span></pre></td></tr><tr><td data-num="32"></td><td><pre>	<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="33"></td><td><pre>		p <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="34"></td><td><pre>		q <span class="token operator">=</span>	getPrime<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="35"></td><td><pre>		N <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">**</span>r<span class="token punctuation">)</span><span class="token operator">*</span>q</pre></td></tr><tr><td data-num="36"></td><td><pre>		<span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">bin</span><span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">4096</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="37"></td><td><pre>			<span class="token keyword">break</span></pre></td></tr><tr><td data-num="38"></td><td><pre></pre></td></tr><tr><td data-num="39"></td><td><pre>	idx <span class="token operator">=</span> <span class="token punctuation">(</span>r<span class="token operator">*</span><span class="token punctuation">(</span>r<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>r<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>r<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="40"></td><td><pre>	delta <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>mpz<span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">,</span> idx<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="41"></td><td><pre>	phi <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">**</span><span class="token punctuation">(</span>r<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="42"></td><td><pre></pre></td></tr><tr><td data-num="43"></td><td><pre>	<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="44"></td><td><pre>		d1 <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token number">2048</span><span class="token operator">*</span>idx<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="45"></td><td><pre>		d2 <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token number">2048</span><span class="token operator">*</span>idx<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="46"></td><td><pre>		<span class="token keyword">if</span> <span class="token builtin">abs</span><span class="token punctuation">(</span>d1<span class="token operator">-</span>d2<span class="token punctuation">)</span> <span class="token operator">&lt;</span> delta<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="47"></td><td><pre>			m1 <span class="token operator">=</span> invert<span class="token punctuation">(</span>d1<span class="token punctuation">,</span> phi<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="48"></td><td><pre>			m2 <span class="token operator">=</span> invert<span class="token punctuation">(</span>d2<span class="token punctuation">,</span> phi<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="49"></td><td><pre>			<span class="token keyword">break</span></pre></td></tr><tr><td data-num="50"></td><td><pre></pre></td></tr><tr><td data-num="51"></td><td><pre>	e2 <span class="token operator">=</span> <span class="token number">0x10001</span></pre></td></tr><tr><td data-num="52"></td><td><pre>	<span class="token keyword">return</span> n2<span class="token punctuation">,</span> e2<span class="token punctuation">,</span> m1<span class="token punctuation">,</span> m2</pre></td></tr><tr><td data-num="53"></td><td><pre></pre></td></tr><tr><td data-num="54"></td><td><pre><span class="token keyword">def</span> <span class="token function">gen3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="55"></td><td><pre>	r <span class="token operator">=</span> <span class="token number">7</span></pre></td></tr><tr><td data-num="56"></td><td><pre>	<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="57"></td><td><pre>		p <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="58"></td><td><pre>		q <span class="token operator">=</span>	getPrime<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="59"></td><td><pre>		N <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">**</span>r<span class="token punctuation">)</span><span class="token operator">*</span>q</pre></td></tr><tr><td data-num="60"></td><td><pre>		phi <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">**</span><span class="token punctuation">(</span>r<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="61"></td><td><pre></pre></td></tr><tr><td data-num="62"></td><td><pre>		<span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">bin</span><span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">2</span> <span class="token operator">==</span> <span class="token number">4096</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="63"></td><td><pre>			<span class="token keyword">break</span></pre></td></tr><tr><td data-num="64"></td><td><pre></pre></td></tr><tr><td data-num="65"></td><td><pre>	idx <span class="token operator">=</span> <span class="token punctuation">(</span>r<span class="token operator">*</span><span class="token punctuation">(</span>r<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>r<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>r<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="66"></td><td><pre>	delta <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>mpz<span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">,</span> idx<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="67"></td><td><pre></pre></td></tr><tr><td data-num="68"></td><td><pre>	<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="69"></td><td><pre>		b <span class="token operator">=</span> getRandomNBitInteger<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token number">2048</span><span class="token operator">*</span>idx<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="70"></td><td><pre>		a <span class="token operator">=</span> getRandomNBitInteger<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token number">2048</span><span class="token operator">*</span>idx<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="71"></td><td><pre>		<span class="token keyword">if</span> a<span class="token operator">*</span>b <span class="token operator">&lt;</span> delta<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="72"></td><td><pre>			e <span class="token operator">=</span> invert<span class="token punctuation">(</span>a<span class="token punctuation">,</span> phi<span class="token punctuation">)</span><span class="token operator">*</span>b</pre></td></tr><tr><td data-num="73"></td><td><pre>			<span class="token keyword">return</span> n3<span class="token punctuation">,</span> e3<span class="token punctuation">,</span> b</pre></td></tr><tr><td data-num="74"></td><td><pre></pre></td></tr><tr><td data-num="75"></td><td><pre></pre></td></tr><tr><td data-num="76"></td><td><pre>n11<span class="token punctuation">,</span> n12<span class="token punctuation">,</span> e11<span class="token punctuation">,</span> e12 <span class="token operator">=</span> gen1<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="77"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"n11=</span><span class="token interpolation"><span class="token punctuation">&#123;</span>n11<span class="token punctuation">&#125;</span></span><span class="token string">\nn12=</span><span class="token interpolation"><span class="token punctuation">&#123;</span>n12<span class="token punctuation">&#125;</span></span><span class="token string">\ne11=</span><span class="token interpolation"><span class="token punctuation">&#123;</span>e11<span class="token punctuation">&#125;</span></span><span class="token string">\ne12=</span><span class="token interpolation"><span class="token punctuation">&#123;</span>e12<span class="token punctuation">&#125;</span></span><span class="token string">\n"</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="78"></td><td><pre>n2<span class="token punctuation">,</span> e2<span class="token punctuation">,</span> m1<span class="token punctuation">,</span> m2 <span class="token operator">=</span> gen2<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="79"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"n2=</span><span class="token interpolation"><span class="token punctuation">&#123;</span>n2<span class="token punctuation">&#125;</span></span><span class="token string">\ne2=</span><span class="token interpolation"><span class="token punctuation">&#123;</span>e2<span class="token punctuation">&#125;</span></span><span class="token string">\n"</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="80"></td><td><pre>n3<span class="token punctuation">,</span> e3<span class="token punctuation">,</span> b <span class="token operator">=</span> gen3<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="81"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"n3=</span><span class="token interpolation"><span class="token punctuation">&#123;</span>n3<span class="token punctuation">&#125;</span></span><span class="token string">\ne3=</span><span class="token interpolation"><span class="token punctuation">&#123;</span>e3<span class="token punctuation">&#125;</span></span><span class="token string">\n"</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="82"></td><td><pre></pre></td></tr><tr><td data-num="83"></td><td><pre>m3 <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="84"></td><td><pre>c11 <span class="token operator">=</span> powmod<span class="token punctuation">(</span>m1<span class="token punctuation">,</span> e11<span class="token punctuation">,</span> n11<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="85"></td><td><pre>c12 <span class="token operator">=</span> powmod<span class="token punctuation">(</span>m2<span class="token punctuation">,</span> e12<span class="token punctuation">,</span> n12<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="86"></td><td><pre>c2 <span class="token operator">=</span> powmod<span class="token punctuation">(</span>b<span class="token punctuation">,</span> e2<span class="token punctuation">,</span> n2<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="87"></td><td><pre>c3 <span class="token operator">=</span> powmod<span class="token punctuation">(</span>m3<span class="token punctuation">,</span> e3<span class="token punctuation">,</span> n3<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="88"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"c11=</span><span class="token interpolation"><span class="token punctuation">&#123;</span>c11<span class="token punctuation">&#125;</span></span><span class="token string">\nc12=</span><span class="token interpolation"><span class="token punctuation">&#123;</span>c12<span class="token punctuation">&#125;</span></span><span class="token string">\nc2=</span><span class="token interpolation"><span class="token punctuation">&#123;</span>c2<span class="token punctuation">&#125;</span></span><span class="token string">\nc3=</span><span class="token interpolation"><span class="token punctuation">&#123;</span>c3<span class="token punctuation">&#125;</span></span><span class="token string">\n"</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="89"></td><td><pre><span class="token triple-quoted-string string">'''</span></pre></td></tr><tr><td data-num="90"></td><td><pre>n11=801049932940568005269978912396585741498810389425615966036828877784238116634177290247194019425111606811005728521368879065336038221361037062407029836155148874719789714345603547779284558101833801155509762818376470874215789574939002212274399950433269775325144015468620263028557804618774240232988157961712628677901130814703917513004114547234375629747176834581166306552311075522669403347828095831520693563291249869832390698646691647204371133362254846234990175138047928703289833460734235302093916147489509206061923877623300596194317059884824322527532662470348274079800781120104946546063500763852622187404608639542858285661288293918912184354236687975919510300221932074135531028314170475917110204254042336116619335841213418990605590620842511615815443114612333881430920769002933370887494558640833005339906706603497809846863863967391543647049224309556936909768179259581851520214669904560467640473144481633920438487615788689262961741053146610554997224861331949716721056553499531186695425439163222802917813140266513735841447717418846360096652592844940362932171019143434080184728093326143821165097895058935372215708948088248596585127475770021962501262915274497478428868130455122612016408381607561200802267038869516896665387576895570245272035575637</pre></td></tr><tr><td data-num="91"></td><td><pre>n12=635401970340205725139325006504978344512744926958688031423448003992072769931808217486709574151492230879374574313457662436423263437792389711379687512056391117410807565492548718691166183372633151644917135272259770997096195518489056319350258673723095417922153182423913759272893696867426193704479752772511081457729513843682588951499551132432923147997238597538055902932123792252593514225328196541483451747314048080824405530742533473914329294346486691684904100406972073037050089861816604505650042953778360621934380815999541183067585498606053857125775979915077329566722531830089714823979965934190338538564188253271016367299890015449611141166780048763403252309160517164569110740561584100839212138661881615351382946813818078899882595313362934594951895560189003438775450675343590147821186953526262224973333962454561275321925151619178204499342339749637758100126893330994252902926509705617882239610380420830791088907378397226817514095468815228186716220057075095711894070032344613244803934541318573847029365563159918970404057137270884587905766828750387753130065274147902379993224780149663600462492281891320702134153853359393588902750423972068679293373333869389393970353760507436913233657422185531482023237384247535554666481760197851108297145147371</pre></td></tr><tr><td data-num="92"></td><td><pre>e11=1898839980562048754607069073527844852132536432440793106124181406514770178066775988232362054809850074774981836898118651469424148725970708199461113088705044905633592578936333918328544505910996746428679299419879472444790941363558025887620570856598548320246426354974395765243741646121743413447132297230365355148066914830856904433750379114692122900723772114991199979638987571559860550883470977246459523068862898859694461427148626628283198896659337135438506574799585378178678790308410266713256003479022699264568844505977513537013529212961573269494683740987283682608189406719573301573662696753903050991812884192192569737274321828986847640839813424701894578472933385727757445011291134961124822612239865</pre></td></tr><tr><td data-num="93"></td><td><pre>e12=1262647419018930022617189608995712260095623047273893811529510754596636390255564988827821761126917976430978175522450277907063247981106405519094560616378241247111698915199999363948015703788616554657275147338766805289909261129165025156078136718573006479030827585347458143645738353716189131209398056741864848486818076440355778886993462012533397208330925057305502653219173629466948635110352752162442552541812665607516753186595817376029707777599029040724727499952161261179707271814405907165207904499722122779096230563548011491932378429654764486855147873135769116637484240454596231092684424572258119768093562747249251518965380465994055049411715353547147466711949391814550591591830515262296556050946881</pre></td></tr><tr><td data-num="94"></td><td><pre></pre></td></tr><tr><td data-num="95"></td><td><pre>n2=209798341155088334158217087474227805455138848036904381404809759100627849272231840321985747935471287990313456209656625928356468120896887536235496490078123448217785939608443507649096688546074968476040552137270080120417769906047001451239544719039212180059396791491281787790213953488743488306241516010351179070869410418232801398578982244984544906579574766534671056023774009163991804748763929626213884208260660722705479782932001102089367261720194650874553305179520889083170973755913964440175393646890791491057655226024046525748177999422035469428780228224800114202385209306803288475439775037067014297973202621118959024226798935588827359265962780792266516120013602384766460619793738405476219362508944225007365127768741191310079985425349292613888185378948854602285379329682053663283534930182589905986063348509703027498270111412063194971956202729807710253369312175636837558252924035002153389909587349043986253518050303628071319876207392440085675892353421232158925122721273720564784886530611286461575045181073744696415657043278123662980166364494583141297996445429477446442693717498789391918530672770193730629928408766563592081857706608049076318165712479742423149330311238462044666384622153280310696667586565906758451118241914402257039981388209</pre></td></tr><tr><td data-num="96"></td><td><pre>e2=65537</pre></td></tr><tr><td data-num="97"></td><td><pre></pre></td></tr><tr><td data-num="98"></td><td><pre>n3=539779851369541956878655738599584730199799866957191805784596190682932284216781781433367450841202917758999300635019369629627621029957135109806205877317954671312041249493462048283611940752235036153024920172209763260723728345918562258401803973624430150143563078517485996070862532682695228590709019451174548520135142052216785774589096706631010293690859363524584240662502290912412366366114571976050857239915691266377257797199583543940504695517331512813468837128344612227973709974625418257243011036826241599265375741977853552204640800449679679351666009764297016524814036295707311913711955324055690490892097177271718850857268982130811714517356073266905474635370690445031512184247179039751734276906533177939993769044135143389748416635981226449566039039202521305851567296884751935162651063209779647359922622084851547605090230221057349511482738300221222563908357379545905837110168948295030747460300104202323692732549831403834387939156877086852393515817984772384147449841124275061609701453997579569931391166586163299940486204581696722731952467570857217406030804590055255431828403195798003509083922294733709507134156466158642941338493323430671502043066148246348074878064089651235355282144209668143249348243220714471988019011613749340243917652821</pre></td></tr><tr><td data-num="99"></td><td><pre>e3=8179300978753084587812861894047395225516049110376948812109811319430275614612773726672345893359691900281432484382670047044697374818043512731533402576374645405477207239801498428774783768163880078495448747421425078521981578408638790336528372019271073712013371141939808017049399434858687299480461753638164719404612128939787055797762174745092074547412183349192156638711750872083313795551439465507724807626674514935170104573715458782366469587138508845980490673890245713729782917089910271980557159592807350504157192913530007199510144004848020221181558472160543018733124225266127379373751910439604459368078652499029070936707349862139053913745186413782066470461478961703013591655136140060879250067379283913798867648758171004535775565306842444545755351202796833177560656564652632975685912935281581268141803696686952259539945588609591385807620108279333498170028167338690235117003515264281843953984997958878272347778561933726792473981855755454522886321669676790813189668084373153897754540290867346751033567500922477317530445967753955221454744946208555394588111484610700789566547507402309549957740815535069057837915204852490930168843605732632328017129154852857227895362549146737618906180651623216848500491438142456250653458053922622240299736136335179639180898730269690699965799644757774472147210271111150769048976871249731156387939260749192370361488285775377622944817570292095201906142567403539151179209316853493906909989301225903409448461436855145</pre></td></tr><tr><td data-num="100"></td><td><pre></pre></td></tr><tr><td data-num="101"></td><td><pre>c11=18979511327426975645936984732782737165217332092805655747550406443960209507493506811471688957217003792679188427155591583024966608843371190136274378868083075515877811693937328204553788450031542610082653080302874606750443090466407543829279067099563572849101374714795279414177737277837595409805721290786607138569322435729584574023597293220443351227559400618351504654781318871214405850541820427562291662456382362148698864044961814456827646881685994720468255382299912036854657082505810206237294593538092338544641919051145900715456411365065867357857347860000894624247098719102875782712030938806816332901861114078070638796157513248160442185781635520426230183818695937457557248160135402734489627723104008584934936245208116232179751448263136309595931691285743580695792601141363221346329077184688857290503770641398917586422369221744736905117499140140651493031622040723274355292502182795605723573863581253354922291984335841915632076694172921289489383700174864888664946302588049384130628381766560976143458735712162489811693014419190718601945154153130272620025118408017441490090252674737105557818759190934585829634273698371996797545908125156282869589331913665938038870431655063063535672001112420959158339261862052308986374193671007982914711432579</pre></td></tr><tr><td data-num="102"></td><td><pre>c12=336587005671304527566745948355290412636261748969581976214239578621816863343117433524033533838636941679300497270909696775021031004312477997130741361709262822736904340641138652359632950455651920464042448022467664596484055174270895170499076347333381222768518599018520948098943626229061996126260154604038101543546588917619576702866444998578555907070990331574722135141778182631559802154493815687284077524469331290249057291163803290619701104007028836609832847351748020354798788508790258935718399783002069490123663345156902440501507117289747695510266461539019431610123351176227443612317037899257774045751487135646052309277098939919088029284437221840182769808850184827681307611389353392683707516141736067793897378911235819049432542758429901945202632117089595899280390575706266239252841152490534353760118231918190110043319877744119083811214707593122757409240645257409097436061825613686773916466122693168971062418046703969144004779270391320645495586024342668002497155358623795942692477164489475917351003149045087283510728981096449890130735055015075557614253867698702479920619299919816768972581273507837309179450374634916567083251630203067065663910073926990517108921490442919372774170201239734064819301693527366233007925670043499415100789027665</pre></td></tr><tr><td data-num="103"></td><td><pre>c2=18352572608055902550350386950073774530453857897248738030380007830701135570310622004368605208336922266513238134127496822199799761713782366178177809597137102612444147565578155260524747439899150012223027218489946124086276814899675563837669559795153349686434242738207425653079514376089070980797596457151965772460109519623572502109592612394316680202287712465721767341302234806130244551387296133051760893033194962691942040228545508895009195291106297581470066545991352668826197346830561010198417527057944507902143965634058848276017283478933675052993657822322866778994956205033704582047618324071045349072526540250707463112668579342537349567247810715604220690215313641329522674080146047291570752430231923566302463491877377617044768978997438596643458475128936850994934029476030136643053997549253792076260765459166618369864942681056864815996253315631930002738854235841120321870075261782250357506436825550088826469396508045912258303652912217151127280959435741419961721418428605515096160344688795655562889755165362006775317188009008288782691705879510655892181975003485714604340542378477388225736316682379616676770234557939471098919647053799313777248678455620231721202780830980063824003076308811540534492317719811588898727134190545533822501681653</pre></td></tr><tr><td data-num="104"></td><td><pre>c3=113097822337683973761068913398570777162211043704088253732500045618770280334319497174908657828372816818344430304314992760410247741225285170975119344962728883084314382093407445567724674775086423808679124143380073906159023182353116556175251427048715466914368972746661938211846262612414049036821553068430149530397389927209475908905748728402722287875974303298260579839357610962198145974153609818939841880084892796820949226354126424023144300953584658958900737493704530725894948802258740332090822797815745616247879170037794873059391625680745994045522420168248552864215035136318711240256011217929372430302003068882829637056296413462078222453765071094277727760527662423010417144554652783429899139309180017349156600053882338180319473460877576898373222480215735280046214925463242092830060830764299787309912687294672319845054775281463150375545716818434962456139485501224661520991156961587158843064393883274763714930309353593180897123378717852182761518709151878662808890356934477932099818218743384674756674800089177733447066489275506387382342429495897972218764782517198727316942685748481956118012927027254979181519862451112593068440686462293151078537886822555211870303467014484443432209106264020502334805536091587252238173816637270028678636848763</pre></td></tr><tr><td data-num="105"></td><td><pre></pre></td></tr><tr><td data-num="106"></td><td><pre>'''</pre></td></tr></table></figure><p>就完全是这篇论文的复现了<span class="exturl" data-url="aHR0cHM6Ly9lcHJpbnQuaWFjci5vcmcvMjAxNS8zOTkucGRm"> New attacks on RSA with Moduli N = p^rq</span>[6]</p><p>注意第一和第二种攻击中，用 CopperSmith 解小根就可以得到相应的未知数</p><h2 id="exp-4"><a class="anchor" href="#exp-4">#</a> exp</h2><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> sage <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment"># solve m1, m2</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">def</span> <span class="token function">solve_m1_m2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    n11 <span class="token operator">=</span> <span class="token number">801049932940568005269978912396585741498810389425615966036828877784238116634177290247194019425111606811005728521368879065336038221361037062407029836155148874719789714345603547779284558101833801155509762818376470874215789574939002212274399950433269775325144015468620263028557804618774240232988157961712628677901130814703917513004114547234375629747176834581166306552311075522669403347828095831520693563291249869832390698646691647204371133362254846234990175138047928703289833460734235302093916147489509206061923877623300596194317059884824322527532662470348274079800781120104946546063500763852622187404608639542858285661288293918912184354236687975919510300221932074135531028314170475917110204254042336116619335841213418990605590620842511615815443114612333881430920769002933370887494558640833005339906706603497809846863863967391543647049224309556936909768179259581851520214669904560467640473144481633920438487615788689262961741053146610554997224861331949716721056553499531186695425439163222802917813140266513735841447717418846360096652592844940362932171019143434080184728093326143821165097895058935372215708948088248596585127475770021962501262915274497478428868130455122612016408381607561200802267038869516896665387576895570245272035575637</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    n12 <span class="token operator">=</span> <span class="token number">635401970340205725139325006504978344512744926958688031423448003992072769931808217486709574151492230879374574313457662436423263437792389711379687512056391117410807565492548718691166183372633151644917135272259770997096195518489056319350258673723095417922153182423913759272893696867426193704479752772511081457729513843682588951499551132432923147997238597538055902932123792252593514225328196541483451747314048080824405530742533473914329294346486691684904100406972073037050089861816604505650042953778360621934380815999541183067585498606053857125775979915077329566722531830089714823979965934190338538564188253271016367299890015449611141166780048763403252309160517164569110740561584100839212138661881615351382946813818078899882595313362934594951895560189003438775450675343590147821186953526262224973333962454561275321925151619178204499342339749637758100126893330994252902926509705617882239610380420830791088907378397226817514095468815228186716220057075095711894070032344613244803934541318573847029365563159918970404057137270884587905766828750387753130065274147902379993224780149663600462492281891320702134153853359393588902750423972068679293373333869389393970353760507436913233657422185531482023237384247535554666481760197851108297145147371</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    e11 <span class="token operator">=</span> <span class="token number">1898839980562048754607069073527844852132536432440793106124181406514770178066775988232362054809850074774981836898118651469424148725970708199461113088705044905633592578936333918328544505910996746428679299419879472444790941363558025887620570856598548320246426354974395765243741646121743413447132297230365355148066914830856904433750379114692122900723772114991199979638987571559860550883470977246459523068862898859694461427148626628283198896659337135438506574799585378178678790308410266713256003479022699264568844505977513537013529212961573269494683740987283682608189406719573301573662696753903050991812884192192569737274321828986847640839813424701894578472933385727757445011291134961124822612239865</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    e12 <span class="token operator">=</span> <span class="token number">1262647419018930022617189608995712260095623047273893811529510754596636390255564988827821761126917976430978175522450277907063247981106405519094560616378241247111698915199999363948015703788616554657275147338766805289909261129165025156078136718573006479030827585347458143645738353716189131209398056741864848486818076440355778886993462012533397208330925057305502653219173629466948635110352752162442552541812665607516753186595817376029707777599029040724727499952161261179707271814405907165207904499722122779096230563548011491932378429654764486855147873135769116637484240454596231092684424572258119768093562747249251518965380465994055049411715353547147466711949391814550591591830515262296556050946881</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    c11 <span class="token operator">=</span> <span class="token number">18979511327426975645936984732782737165217332092805655747550406443960209507493506811471688957217003792679188427155591583024966608843371190136274378868083075515877811693937328204553788450031542610082653080302874606750443090466407543829279067099563572849101374714795279414177737277837595409805721290786607138569322435729584574023597293220443351227559400618351504654781318871214405850541820427562291662456382362148698864044961814456827646881685994720468255382299912036854657082505810206237294593538092338544641919051145900715456411365065867357857347860000894624247098719102875782712030938806816332901861114078070638796157513248160442185781635520426230183818695937457557248160135402734489627723104008584934936245208116232179751448263136309595931691285743580695792601141363221346329077184688857290503770641398917586422369221744736905117499140140651493031622040723274355292502182795605723573863581253354922291984335841915632076694172921289489383700174864888664946302588049384130628381766560976143458735712162489811693014419190718601945154153130272620025118408017441490090252674737105557818759190934585829634273698371996797545908125156282869589331913665938038870431655063063535672001112420959158339261862052308986374193671007982914711432579</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    c12 <span class="token operator">=</span> <span class="token number">336587005671304527566745948355290412636261748969581976214239578621816863343117433524033533838636941679300497270909696775021031004312477997130741361709262822736904340641138652359632950455651920464042448022467664596484055174270895170499076347333381222768518599018520948098943626229061996126260154604038101543546588917619576702866444998578555907070990331574722135141778182631559802154493815687284077524469331290249057291163803290619701104007028836609832847351748020354798788508790258935718399783002069490123663345156902440501507117289747695510266461539019431610123351176227443612317037899257774045751487135646052309277098939919088029284437221840182769808850184827681307611389353392683707516141736067793897378911235819049432542758429901945202632117089595899280390575706266239252841152490534353760118231918190110043319877744119083811214707593122757409240645257409097436061825613686773916466122693168971062418046703969144004779270391320645495586024342668002497155358623795942692477164489475917351003149045087283510728981096449890130735055015075557614253867698702479920619299919816768972581273507837309179450374634916567083251630203067065663910073926990517108921490442919372774170201239734064819301693527366233007925670043499415100789027665</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token keyword">for</span> _ <span class="token keyword">in</span> sub_fraction<span class="token punctuation">(</span>n11<span class="token punctuation">,</span> n12<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        q11<span class="token punctuation">,</span> q12 <span class="token operator">=</span> _<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> _<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        <span class="token keyword">if</span> n11 <span class="token operator">%</span> q11 <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">and</span> q12 <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="16"></td><td><pre>            p11 <span class="token operator">=</span> iroot<span class="token punctuation">(</span>n11 <span class="token operator">//</span> q11<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="17"></td><td><pre>            p12 <span class="token operator">=</span> iroot<span class="token punctuation">(</span>n12 <span class="token operator">//</span> q12<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="18"></td><td><pre>            <span class="token keyword">assert</span> p11 <span class="token operator">**</span> <span class="token number">2</span> <span class="token operator">*</span> q11 <span class="token operator">==</span> n11</pre></td></tr><tr><td data-num="19"></td><td><pre>            <span class="token keyword">assert</span> p12 <span class="token operator">**</span> <span class="token number">2</span> <span class="token operator">*</span> q12 <span class="token operator">==</span> n12</pre></td></tr><tr><td data-num="20"></td><td><pre>            phi1 <span class="token operator">=</span> p11 <span class="token operator">*</span> <span class="token punctuation">(</span>p11 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q11 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="21"></td><td><pre>            phi2 <span class="token operator">=</span> p12 <span class="token operator">*</span> <span class="token punctuation">(</span>p12 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q12 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="22"></td><td><pre>            d1 <span class="token operator">=</span> invert<span class="token punctuation">(</span>e11<span class="token punctuation">,</span> phi1<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="23"></td><td><pre>            d2 <span class="token operator">=</span> invert<span class="token punctuation">(</span>e12<span class="token punctuation">,</span> phi2<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre>            <span class="token keyword">return</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c11<span class="token punctuation">,</span> d1<span class="token punctuation">,</span> n11<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c12<span class="token punctuation">,</span> d2<span class="token punctuation">,</span> n12<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="25"></td><td><pre></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token comment"># solve b</span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token keyword">def</span> <span class="token function">solve_b</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="28"></td><td><pre>    n2 <span class="token operator">=</span> <span class="token number">209798341155088334158217087474227805455138848036904381404809759100627849272231840321985747935471287990313456209656625928356468120896887536235496490078123448217785939608443507649096688546074968476040552137270080120417769906047001451239544719039212180059396791491281787790213953488743488306241516010351179070869410418232801398578982244984544906579574766534671056023774009163991804748763929626213884208260660722705479782932001102089367261720194650874553305179520889083170973755913964440175393646890791491057655226024046525748177999422035469428780228224800114202385209306803288475439775037067014297973202621118959024226798935588827359265962780792266516120013602384766460619793738405476219362508944225007365127768741191310079985425349292613888185378948854602285379329682053663283534930182589905986063348509703027498270111412063194971956202729807710253369312175636837558252924035002153389909587349043986253518050303628071319876207392440085675892353421232158925122721273720564784886530611286461575045181073744696415657043278123662980166364494583141297996445429477446442693717498789391918530672770193730629928408766563592081857706608049076318165712479742423149330311238462044666384622153280310696667586565906758451118241914402257039981388209</span></pre></td></tr><tr><td data-num="29"></td><td><pre>    e2 <span class="token operator">=</span> <span class="token number">65537</span></pre></td></tr><tr><td data-num="30"></td><td><pre>    c2 <span class="token operator">=</span> <span class="token number">18352572608055902550350386950073774530453857897248738030380007830701135570310622004368605208336922266513238134127496822199799761713782366178177809597137102612444147565578155260524747439899150012223027218489946124086276814899675563837669559795153349686434242738207425653079514376089070980797596457151965772460109519623572502109592612394316680202287712465721767341302234806130244551387296133051760893033194962691942040228545508895009195291106297581470066545991352668826197346830561010198417527057944507902143965634058848276017283478933675052993657822322866778994956205033704582047618324071045349072526540250707463112668579342537349567247810715604220690215313641329522674080146047291570752430231923566302463491877377617044768978997438596643458475128936850994934029476030136643053997549253792076260765459166618369864942681056864815996253315631930002738854235841120321870075261782250357506436825550088826469396508045912258303652912217151127280959435741419961721418428605515096160344688795655562889755165362006775317188009008288782691705879510655892181975003485714604340542378477388225736316682379616676770234557939471098919647053799313777248678455620231721202780830980063824003076308811540534492317719811588898727134190545533822501681653</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    m1<span class="token punctuation">,</span> m2 <span class="token operator">=</span> solve_m1_m2<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="32"></td><td><pre>    PR<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>n2<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="33"></td><td><pre>    f <span class="token operator">=</span> m1 <span class="token operator">*</span> m2 <span class="token operator">*</span> x <span class="token operator">-</span> <span class="token punctuation">(</span>m2 <span class="token operator">-</span> m1<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="34"></td><td><pre>    f <span class="token operator">=</span> f<span class="token punctuation">.</span>monic<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="35"></td><td><pre>    root <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span>small_roots<span class="token punctuation">(</span>X<span class="token operator">=</span><span class="token number">2</span> <span class="token operator">^</span> <span class="token number">1000</span><span class="token punctuation">,</span> beta<span class="token operator">=</span><span class="token number">0.75</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="36"></td><td><pre>    p2 <span class="token operator">=</span> gcd<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>f<span class="token punctuation">(</span>root<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> n2<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="37"></td><td><pre>    p2 <span class="token operator">=</span> iroot<span class="token punctuation">(</span>p2<span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="38"></td><td><pre>    q2 <span class="token operator">=</span> n2 <span class="token operator">//</span> <span class="token punctuation">(</span>p2 <span class="token operator">**</span> <span class="token number">7</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="39"></td><td><pre>    phi2 <span class="token operator">=</span> p2 <span class="token operator">**</span> <span class="token number">6</span> <span class="token operator">*</span> <span class="token punctuation">(</span>p2 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q2 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="40"></td><td><pre>    d2 <span class="token operator">=</span> invert<span class="token punctuation">(</span>e2<span class="token punctuation">,</span> phi2<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="41"></td><td><pre>    <span class="token keyword">return</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c2<span class="token punctuation">,</span> d2<span class="token punctuation">,</span> n2<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="42"></td><td><pre></pre></td></tr><tr><td data-num="43"></td><td><pre><span class="token comment"># solve flag</span></pre></td></tr><tr><td data-num="44"></td><td><pre>n3 <span class="token operator">=</span> <span class="token number">539779851369541956878655738599584730199799866957191805784596190682932284216781781433367450841202917758999300635019369629627621029957135109806205877317954671312041249493462048283611940752235036153024920172209763260723728345918562258401803973624430150143563078517485996070862532682695228590709019451174548520135142052216785774589096706631010293690859363524584240662502290912412366366114571976050857239915691266377257797199583543940504695517331512813468837128344612227973709974625418257243011036826241599265375741977853552204640800449679679351666009764297016524814036295707311913711955324055690490892097177271718850857268982130811714517356073266905474635370690445031512184247179039751734276906533177939993769044135143389748416635981226449566039039202521305851567296884751935162651063209779647359922622084851547605090230221057349511482738300221222563908357379545905837110168948295030747460300104202323692732549831403834387939156877086852393515817984772384147449841124275061609701453997579569931391166586163299940486204581696722731952467570857217406030804590055255431828403195798003509083922294733709507134156466158642941338493323430671502043066148246348074878064089651235355282144209668143249348243220714471988019011613749340243917652821</span></pre></td></tr><tr><td data-num="45"></td><td><pre>e3 <span class="token operator">=</span> <span class="token number">8179300978753084587812861894047395225516049110376948812109811319430275614612773726672345893359691900281432484382670047044697374818043512731533402576374645405477207239801498428774783768163880078495448747421425078521981578408638790336528372019271073712013371141939808017049399434858687299480461753638164719404612128939787055797762174745092074547412183349192156638711750872083313795551439465507724807626674514935170104573715458782366469587138508845980490673890245713729782917089910271980557159592807350504157192913530007199510144004848020221181558472160543018733124225266127379373751910439604459368078652499029070936707349862139053913745186413782066470461478961703013591655136140060879250067379283913798867648758171004535775565306842444545755351202796833177560656564652632975685912935281581268141803696686952259539945588609591385807620108279333498170028167338690235117003515264281843953984997958878272347778561933726792473981855755454522886321669676790813189668084373153897754540290867346751033567500922477317530445967753955221454744946208555394588111484610700789566547507402309549957740815535069057837915204852490930168843605732632328017129154852857227895362549146737618906180651623216848500491438142456250653458053922622240299736136335179639180898730269690699965799644757774472147210271111150769048976871249731156387939260749192370361488285775377622944817570292095201906142567403539151179209316853493906909989301225903409448461436855145</span></pre></td></tr><tr><td data-num="46"></td><td><pre>c3 <span class="token operator">=</span> <span class="token number">113097822337683973761068913398570777162211043704088253732500045618770280334319497174908657828372816818344430304314992760410247741225285170975119344962728883084314382093407445567724674775086423808679124143380073906159023182353116556175251427048715466914368972746661938211846262612414049036821553068430149530397389927209475908905748728402722287875974303298260579839357610962198145974153609818939841880084892796820949226354126424023144300953584658958900737493704530725894948802258740332090822797815745616247879170037794873059391625680745994045522420168248552864215035136318711240256011217929372430302003068882829637056296413462078222453765071094277727760527662423010417144554652783429899139309180017349156600053882338180319473460877576898373222480215735280046214925463242092830060830764299787309912687294672319845054775281463150375545716818434962456139485501224661520991156961587158843064393883274763714930309353593180897123378717852182761518709151878662808890356934477932099818218743384674756674800089177733447066489275506387382342429495897972218764782517198727316942685748481956118012927027254979181519862451112593068440686462293151078537886822555211870303467014484443432209106264020502334805536091587252238173816637270028678636848763</span></pre></td></tr><tr><td data-num="47"></td><td><pre>b <span class="token operator">=</span> solve_b<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="48"></td><td><pre>PR<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>n3<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="49"></td><td><pre>f <span class="token operator">=</span> e3 <span class="token operator">*</span> x <span class="token operator">-</span> <span class="token builtin">int</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="50"></td><td><pre>f <span class="token operator">=</span> f<span class="token punctuation">.</span>monic<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="51"></td><td><pre>root <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span>small_roots<span class="token punctuation">(</span>X<span class="token operator">=</span><span class="token number">2</span> <span class="token operator">^</span> <span class="token number">675</span><span class="token punctuation">,</span> beta<span class="token operator">=</span><span class="token number">0.75</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="52"></td><td><pre>p3 <span class="token operator">=</span> gcd<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>f<span class="token punctuation">(</span>root<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> n3<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="53"></td><td><pre>p3 <span class="token operator">=</span> iroot<span class="token punctuation">(</span>p3<span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="54"></td><td><pre>q3 <span class="token operator">=</span> n3 <span class="token operator">//</span> p3 <span class="token operator">**</span> <span class="token number">7</span></pre></td></tr><tr><td data-num="55"></td><td><pre>phi3 <span class="token operator">=</span> p3 <span class="token operator">**</span> <span class="token number">6</span> <span class="token operator">*</span> <span class="token punctuation">(</span>p3 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q3 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="56"></td><td><pre>d3 <span class="token operator">=</span> invert<span class="token punctuation">(</span>e3<span class="token punctuation">,</span> phi3<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="57"></td><td><pre>m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c3<span class="token punctuation">,</span> d3<span class="token punctuation">,</span> n3<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="58"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="59"></td><td><pre><span class="token comment"># qwb&#123;8633ce6d-fece-4cf1-8f0f-f27e5bf6d678&#125;</span></pre></td></tr></table></figure><h1 id="reference"><a class="anchor" href="#reference">#</a> Reference</h1><ol><li><span class="exturl" data-url="aHR0cHM6Ly9lcHJpbnQuaWFjci5vcmcvMjAyMC80NjEucGRm">A Polynomial-Time Algorithm for Solving the Hidden Subset Sum Problem</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9lcHJpbnQuaWFjci5vcmcvMjAyMS8xMDA3LnBkZg==">Provably Solving the Hidden Subset Sum Problem via Statistical Learning</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9hZ25lc2VnaW5pLmdpdGh1Yi5pby9zbGlkZXNfaGxjX01DLnBkZg==">Provably Solving the Hidden Subset Sum Problem via Statistical Learning-ppt</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FnbmVzZWdpbmkvc29sdmluZ19oc3Nw">Provably Solving the Hidden Subset Sum Problem via Statistical Learning_Sage</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9uZWlsbWFkZGVuLmJsb2cvMjAyMi8wNC8xOS9wc3ljaGljLXNpZ25hdHVyZXMtaW4tamF2YS8=">CVE-2022-21449</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9lcHJpbnQuaWFjci5vcmcvMjAxNS8zOTkucGRm">New attacks on RSA with Moduli N = p^rq</span></li></ol><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2022-08-01 17:18:46" itemprop="dateModified" datetime="2022-08-01T17:18:46+08:00">2022-08-01</time> </span><span id="2022/08/01/match/强网杯/" class="item leancloud_visitors" data-flag-title="强网杯2022" title="阅读次数"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">阅读次数</span> <span class="leancloud-visitors-count"></span> <span class="text">次</span></span></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>Putao0v0 <i class="ic i-at"><em>@</em></i>putao</li><li class="link"><strong>本文链接：</strong> <a href="http://example.com/2022/08/01/match/%E5%BC%BA%E7%BD%91%E6%9D%AF/" title="强网杯2022">http://example.com/2022/08/01/match/强网杯/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/2022/07/25/match/DASCTF2022-07%E8%B5%8B%E8%83%BD%E8%B5%9B/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;pic.imgdb.cn&#x2F;item&#x2F;63f1dd6df144a01007af3513.jpg" title="DASCTF2022.07赋能赛"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> 比赛</span><h3>DASCTF2022.07赋能赛</h3></a></div><div class="item right"><a href="/2022/08/04/match/ctfshow%20%E4%B8%83%E5%A4%95%E6%9D%AF/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;pic.imgdb.cn&#x2F;item&#x2F;63f1dd6cf144a01007af3424.jpg" title="ctfshow七夕杯"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> 比赛</span><h3>ctfshow七夕杯</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#crypto-polydiv"><span class="toc-number">1.</span> <span class="toc-text">crypto-polydiv</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE"><span class="toc-number">1.1.</span> <span class="toc-text">题目</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#exp"><span class="toc-number">1.2.</span> <span class="toc-text">exp</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#crypto-asr"><span class="toc-number">2.</span> <span class="toc-text">crypto-ASR</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE-2"><span class="toc-number">2.1.</span> <span class="toc-text">题目</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#exp-2"><span class="toc-number">2.2.</span> <span class="toc-text">exp</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#crypto-myjwt"><span class="toc-number">3.</span> <span class="toc-text">crypto-myJWT</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE-3"><span class="toc-number">3.1.</span> <span class="toc-text">题目</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#exp-3"><span class="toc-number">3.2.</span> <span class="toc-text">exp</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#crypto-factor"><span class="toc-number">4.</span> <span class="toc-text">crypto-Factor</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE-4"><span class="toc-number">4.1.</span> <span class="toc-text">题目</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#exp-4"><span class="toc-number">4.2.</span> <span class="toc-text">exp</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#reference"><span class="toc-number">5.</span> <span class="toc-text">Reference</span></a></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li><a href="/2022/02/23/match/ctfshow%E5%AF%86%E7%A0%81%E6%8C%91%E6%88%98/" rel="bookmark" title="ctfshow密码挑战">ctfshow密码挑战</a></li><li><a href="/2022/02/23/match/ByteCTF/" rel="bookmark" title="ByteCTF">ByteCTF</a></li><li><a href="/2022/03/02/match/%E5%8D%B7%E7%8E%8B%E6%9D%AF/" rel="bookmark" title="卷王杯">卷王杯</a></li><li><a href="/2022/03/03/match/VN2022/" rel="bookmark" title="VN2022">VN2022</a></li><li><a href="/2022/03/12/match/d%5E3ctf/" rel="bookmark" title="d^3ctf">d^3ctf</a></li><li><a href="/2022/03/21/match/%E8%99%8E%E7%AC%A6%E6%9D%AF/" rel="bookmark" title="虎符杯">虎符杯</a></li><li><a href="/2022/03/24/match/%E7%BA%A2%E6%98%8E%E8%B0%B72022/" rel="bookmark" title="红明谷2022">红明谷2022</a></li><li><a href="/2022/04/09/match/HZNUCTF/" rel="bookmark" title="HZNUCTF">HZNUCTF</a></li><li><a href="/2022/04/27/match/DASCTF%20Apr%20X%20FATE%20%E9%98%B2%E7%96%AB%E6%8C%91%E6%88%98%E8%B5%9B/" rel="bookmark" title="DASCTF Apr X FATE 防疫挑战赛">DASCTF Apr X FATE 防疫挑战赛</a></li><li><a href="/2022/05/16/match/PWNHUB/" rel="bookmark" title="PWNHUB">PWNHUB</a></li><li><a href="/2022/05/16/match/%E5%AE%81%E6%B3%A2%E5%B8%82%E7%AC%AC%E4%BA%94%E5%B1%8A%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/" rel="bookmark" title="宁波市第五届网络安全大赛">宁波市第五届网络安全大赛</a></li><li><a href="/2022/05/27/match/Dest0g3/" rel="bookmark" title="Dest0g3">Dest0g3</a></li><li><a href="/2022/05/27/match/ctfshow%E5%8D%95%E8%BA%AB%E6%9D%AF/" rel="bookmark" title="ctfshow单身杯">ctfshow单身杯</a></li><li><a href="/2022/06/30/match/DASCTF%E5%87%BA%E9%A2%98%E4%BA%BA%E6%8C%91%E6%88%98%E8%B5%9B/" rel="bookmark" title="DASCTF出题人挑战赛">DASCTF出题人挑战赛</a></li><li><a href="/2022/07/08/match/babyrsa/" rel="bookmark" title="鹏程杯2022">鹏程杯2022</a></li><li><a href="/2022/07/11/match/%E8%93%9D%E5%B8%BD%E6%9D%AF2022/" rel="bookmark" title="蓝帽杯2022">蓝帽杯2022</a></li><li><a href="/2022/07/18/match/DSCTF/" rel="bookmark" title="DSCTF">DSCTF</a></li><li><a href="/2022/07/18/match/NepNep/" rel="bookmark" title="NepNep">NepNep</a></li><li><a href="/2022/07/21/match/CRYPTO%20CTF/" rel="bookmark" title="CRYPTO CTF">CRYPTO CTF</a></li><li><a href="/2022/07/25/match/DASCTF2022-07%E8%B5%8B%E8%83%BD%E8%B5%9B/" rel="bookmark" title="DASCTF2022.07赋能赛">DASCTF2022.07赋能赛</a></li><li class="active"><a href="/2022/08/01/match/%E5%BC%BA%E7%BD%91%E6%9D%AF/" rel="bookmark" title="强网杯2022">强网杯2022</a></li><li><a href="/2022/08/04/match/ctfshow%20%E4%B8%83%E5%A4%95%E6%9D%AF/" rel="bookmark" title="ctfshow七夕杯">ctfshow七夕杯</a></li><li><a href="/2022/08/29/match/%E7%BD%91%E9%BC%8E%E6%9D%AF/" rel="bookmark" title="网鼎杯预赛2022">网鼎杯预赛2022</a></li><li><a href="/2022/09/16/match/%E7%BD%91%E4%BF%A1%E6%9F%8F%E9%B9%AD%E6%9D%AF/" rel="bookmark" title="柏鹭杯">柏鹭杯</a></li><li><a href="/2022/09/17/match/2022%E6%B5%99%E6%B1%9F%E7%9C%81%E8%B5%9B/" rel="bookmark" title="2022浙江省赛">2022浙江省赛</a></li><li><a href="/2022/09/20/match/DASCTF%20X%20GFCTF%202022%E5%8D%81%E6%9C%88%E6%8C%91%E6%88%98%E8%B5%9B/" rel="bookmark" title="DASCTF X GFCTF 2022十月挑战赛">DASCTF X GFCTF 2022十月挑战赛</a></li><li><a href="/2022/09/20/match/DASCTF%20X%20CBCTF%202022%E4%B9%9D%E6%9C%88%E6%8C%91%E6%88%98%E8%B5%9B/" rel="bookmark" title="DASCTF X CBCTF 2022九月挑战赛">DASCTF X CBCTF 2022九月挑战赛</a></li><li><a href="/2022/09/24/match/2022%E6%B5%99%E6%B1%9F%E7%9C%81%E8%B5%9B%E5%86%B3%E8%B5%9B/" rel="bookmark" title="2022浙江省赛">2022浙江省赛</a></li><li><a href="/2022/11/09/match/%E7%A5%A5%E4%BA%91%E6%9D%AF/" rel="bookmark" title="祥云杯">祥云杯</a></li><li><a href="/2022/11/27/match/DASCTF%20NOV/" rel="bookmark" title="DASCTF NOV X联合出题人2022年度积分榜争夺赛！">DASCTF NOV X联合出题人2022年度积分榜争夺赛！</a></li><li><a href="/2023/03/04/match/%E9%BB%84%E6%B2%B3%E6%B5%81%E5%9F%9F%E5%85%AC%E5%AE%89%E9%99%A2%E6%A0%A1/" rel="bookmark" title="黄河流域公安院校网络空间安全技能挑战赛">黄河流域公安院校网络空间安全技能挑战赛</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="Putao0v0" data-src="/images/1.jpg"><p class="name" itemprop="name">Putao0v0</p><div class="description" itemprop="description"></div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">60</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">4</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">3</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL3B1dGFvLWFp" title="https:&#x2F;&#x2F;github.com&#x2F;putao-ai"><i class="ic i-github"></i></span> <span class="exturl item weibo" data-url="aHR0cHM6Ly93ZWliby5jb20vdS8zNjEyMTE4NDMy" title="https:&#x2F;&#x2F;weibo.com&#x2F;u&#x2F;3612118432"><i class="ic i-weibo"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>友链</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/2022/07/25/match/DASCTF2022-07%E8%B5%8B%E8%83%BD%E8%B5%9B/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/2022/08/04/match/ctfshow%20%E4%B8%83%E5%A4%95%E6%9D%AF/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2010 – <span itemprop="copyrightYear">2023</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">Putao0v0 @ Putao0v0</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">573k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">8:41</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2022/08/01/match/强网杯/",favicon:{show:"(*╹▽╹*)土豪我们做朋友好不好",hide:"你是猪吗^(*￣(oo)￣)^"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,copy_tex:!0,katex:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html><!-- rebuild by hrmmi -->