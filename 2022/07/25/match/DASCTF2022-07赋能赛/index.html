<!-- build time:Tue Jul 26 2022 20:22:56 GMT+0800 (中国标准时间) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="putao" href="http://example.com/rss.xml"><link rel="alternate" type="application/atom+xml" title="putao" href="http://example.com/atom.xml"><link rel="alternate" type="application/json" title="putao" href="http://example.com/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><link rel="canonical" href="http://example.com/2022/07/25/match/DASCTF2022-07%E8%B5%8B%E8%83%BD%E8%B5%9B/"><title>DASCTF2022.07赋能赛 - 比赛 | Putao0v0 = putao</title><meta name="generator" content="Hexo 6.2.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">DASCTF2022.07赋能赛</h1><div class="meta"><span class="item" title="创建时间：2022-07-25 11:27:25"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2022-07-25T11:27:25+08:00">2022-07-25</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>17k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>16 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Putao0v0</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1gipevarprfj20zk0m8npd.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1giclhfehz7j20zk0m8u0x.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1giclh3brzpj20zk0m8ann.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1giciuja1j1j20zk0m8kjl.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1giclx6phq6j20zk0m8e36.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1giclflwv2aj20zk0m84qp.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/match/" itemprop="item" rel="index" title="分类于 比赛"><span itemprop="name">比赛</span></a><meta itemprop="position" content="1"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="http://example.com/2022/07/25/match/DASCTF2022-07%E8%B5%8B%E8%83%BD%E8%B5%9B/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/gulu.jpeg"><meta itemprop="name" content="Putao0v0"><meta itemprop="description" content=", "></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="putao"></span><div class="body md" itemprop="articleBody"><h1 id="babysign"><a class="anchor" href="#babysign">#</a> babysign</h1><h2 id="题目"><a class="anchor" href="#题目">#</a> 题目</h2><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> hashlib</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> ecdsa</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">import</span> random</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">import</span> os</pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre>flag <span class="token operator">=</span> <span class="token string">b"xxx"</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">assert</span> flag<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">b'DASCTF&#123;'</span><span class="token punctuation">)</span> <span class="token keyword">and</span> flag<span class="token punctuation">.</span>endswith<span class="token punctuation">(</span><span class="token string">b'&#125;'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">assert</span> <span class="token builtin">len</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">40</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">def</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token triple-quoted-string string">"""</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    initiation</pre></td></tr><tr><td data-num="15"></td><td><pre>    """</pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token keyword">global</span> pub_key<span class="token punctuation">,</span> priv_key<span class="token punctuation">,</span> order<span class="token punctuation">,</span> base<span class="token punctuation">,</span>secret</pre></td></tr><tr><td data-num="17"></td><td><pre>    gen <span class="token operator">=</span> ecdsa<span class="token punctuation">.</span>NIST256p<span class="token punctuation">.</span>generator</pre></td></tr><tr><td data-num="18"></td><td><pre>    order <span class="token operator">=</span> gen<span class="token punctuation">.</span>order<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    secret <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    </pre></td></tr><tr><td data-num="21"></td><td><pre>    pub_key <span class="token operator">=</span> ecdsa<span class="token punctuation">.</span>ecdsa<span class="token punctuation">.</span>Public_key<span class="token punctuation">(</span>gen<span class="token punctuation">,</span> gen <span class="token operator">*</span> secret<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    priv_key <span class="token operator">=</span> ecdsa<span class="token punctuation">.</span>ecdsa<span class="token punctuation">.</span>Private_key<span class="token punctuation">(</span>pub_key<span class="token punctuation">,</span> secret<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="23"></td><td><pre></pre></td></tr><tr><td data-num="24"></td><td><pre></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token keyword">def</span> <span class="token function">sign</span><span class="token punctuation">(</span>msg<span class="token punctuation">,</span> nonce<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token triple-quoted-string string">"""</span></pre></td></tr><tr><td data-num="27"></td><td><pre>    sign msg</pre></td></tr><tr><td data-num="28"></td><td><pre>    """</pre></td></tr><tr><td data-num="29"></td><td><pre>    msg <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>hashlib<span class="token punctuation">.</span>sha256<span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="30"></td><td><pre>    </pre></td></tr><tr><td data-num="31"></td><td><pre>    sign <span class="token operator">=</span> priv_key<span class="token punctuation">.</span>sign<span class="token punctuation">(</span>msg<span class="token punctuation">,</span> nonce<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="32"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"R:"</span><span class="token punctuation">,</span> <span class="token builtin">hex</span><span class="token punctuation">(</span>sign<span class="token punctuation">.</span>r<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="33"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"S:"</span><span class="token punctuation">,</span> <span class="token builtin">hex</span><span class="token punctuation">(</span>sign<span class="token punctuation">.</span>s<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="34"></td><td><pre></pre></td></tr><tr><td data-num="35"></td><td><pre>init<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="36"></td><td><pre>nonce <span class="token operator">=</span> random<span class="token punctuation">.</span>getrandbits<span class="token punctuation">(</span>order<span class="token punctuation">.</span>bit_length<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="37"></td><td><pre>sign<span class="token punctuation">(</span><span class="token string">b'welcome to ecdsa'</span><span class="token punctuation">,</span> nonce<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="38"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>nonce<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="39"></td><td><pre></pre></td></tr><tr><td data-num="40"></td><td><pre><span class="token triple-quoted-string string">'''</span></pre></td></tr><tr><td data-num="41"></td><td><pre>R: 7b35712a50d463ac5acf7af1675b4b63ba0da23b6452023afddd58d4891ef6e5</pre></td></tr><tr><td data-num="42"></td><td><pre>S: a452fc44cc36fa6964d1b4f47392ff0a91350cfd58f11a4645c084d56e387e5c</pre></td></tr><tr><td data-num="43"></td><td><pre>57872441580840888721108499129165088876046881204464784483281653404168342111855</pre></td></tr><tr><td data-num="44"></td><td><pre>'''</pre></td></tr></table></figure><p>ECDSA 签名</p><blockquote><p>签名步骤如下</p><ol><li>选择随机整数数 k 作为临时密钥，0&lt;k&lt;q</li><li>计算<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>≡</mo><mo stretchy="false">(</mo><msup><mi>g</mi><mi>k</mi></msup><mi>m</mi><mi>o</mi><mi>d</mi><mi>p</mi><mo stretchy="false">)</mo><mi>m</mi><mi>o</mi><mi>d</mi><mi>q</mi></mrow><annotation encoding="application/x-tex">r≡(g^kmodp)modq</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.46375em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.099108em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.849108em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.03148em">k</span></span></span></span></span></span></span></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:.03588em">q</span></span></span></span></li><li>计算<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>≡</mo><mo stretchy="false">(</mo><mi>H</mi><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo>+</mo><mi>x</mi><mi>r</mi><mo stretchy="false">)</mo><msup><mi>k</mi><mrow><mtext>−</mtext><mn>1</mn></mrow></msup><mi>m</mi><mi>o</mi><mi>d</mi><mi>q</mi></mrow><annotation encoding="application/x-tex">s≡(H(m)+xr)k^{−1}modq</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.46375em;vertical-align:0"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.08125em">H</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-.25em"></span><span class="mord mathnormal">x</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:.03588em">q</span></span></span></span></li></ol></blockquote><p>我们已知了 r，s，H (m), k</p><p>并且</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>gen <span class="token operator">=</span> ecdsa<span class="token punctuation">.</span>NIST256p<span class="token punctuation">.</span>generator</pre></td></tr><tr><td data-num="2"></td><td><pre>order <span class="token operator">=</span> gen<span class="token punctuation">.</span>order<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>这是固定的所以 x 也已知</p><h2 id="exp"><a class="anchor" href="#exp">#</a> exp</h2><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> hashlib</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> ecdsa</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="4"></td><td><pre>R<span class="token operator">=</span><span class="token number">0x7b35712a50d463ac5acf7af1675b4b63ba0da23b6452023afddd58d4891ef6e5</span></pre></td></tr><tr><td data-num="5"></td><td><pre>S<span class="token operator">=</span><span class="token number">0xa452fc44cc36fa6964d1b4f47392ff0a91350cfd58f11a4645c084d56e387e5c</span></pre></td></tr><tr><td data-num="6"></td><td><pre>k<span class="token operator">=</span><span class="token number">57872441580840888721108499129165088876046881204464784483281653404168342111855</span></pre></td></tr><tr><td data-num="7"></td><td><pre>msg<span class="token operator">=</span><span class="token string">b'welcome to ecdsa'</span></pre></td></tr><tr><td data-num="8"></td><td><pre>H <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>hashlib<span class="token punctuation">.</span>sha256<span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>gen <span class="token operator">=</span> ecdsa<span class="token punctuation">.</span>NIST256p<span class="token punctuation">.</span>generator</pre></td></tr><tr><td data-num="10"></td><td><pre>order <span class="token operator">=</span> gen<span class="token punctuation">.</span>order<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>x<span class="token operator">=</span><span class="token punctuation">(</span>k<span class="token operator">*</span>S<span class="token operator">-</span>H<span class="token punctuation">)</span><span class="token operator">*</span>inverse<span class="token punctuation">(</span>R<span class="token punctuation">,</span>order<span class="token punctuation">)</span><span class="token operator">%</span>order</pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p><code>DASCTF&#123;11b7311d4f0137074a7256d3eb82f368&#125;</code></p><h1 id="easyntru"><a class="anchor" href="#easyntru">#</a> easyNTRU</h1><h2 id="题目-2"><a class="anchor" href="#题目-2">#</a> 题目</h2><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#from Crypto.Hash import SHA3_256</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> AES</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>Padding <span class="token keyword">import</span> pad</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">#from secret import flag</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment"># parameters</span></pre></td></tr><tr><td data-num="7"></td><td><pre>N <span class="token operator">=</span> <span class="token number">10</span></pre></td></tr><tr><td data-num="8"></td><td><pre>p <span class="token operator">=</span> <span class="token number">3</span></pre></td></tr><tr><td data-num="9"></td><td><pre>q <span class="token operator">=</span> <span class="token number">512</span></pre></td></tr><tr><td data-num="10"></td><td><pre>d <span class="token operator">=</span> <span class="token number">3</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">assert</span> q<span class="token operator">></span><span class="token punctuation">(</span><span class="token number">6</span><span class="token operator">*</span>d<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span>p</pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre>R<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token operator">></span> <span class="token operator">=</span> ZZ<span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token comment">#d1 1s and #d2 -1s</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">def</span> <span class="token function">T</span><span class="token punctuation">(</span>d1<span class="token punctuation">,</span> d2<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">assert</span> N <span class="token operator">>=</span> d1<span class="token operator">+</span>d2</pre></td></tr><tr><td data-num="18"></td><td><pre>    s <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>d1 <span class="token operator">+</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>d2 <span class="token operator">+</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token punctuation">(</span>N<span class="token operator">-</span>d1<span class="token operator">-</span>d2<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    shuffle<span class="token punctuation">(</span>s<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token keyword">return</span> R<span class="token punctuation">(</span>s<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="21"></td><td><pre></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token keyword">def</span> <span class="token function">invertModPrime</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    Rp <span class="token operator">=</span> R<span class="token punctuation">.</span>change_ring<span class="token punctuation">(</span>Integers<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>quotient<span class="token punctuation">(</span>x<span class="token operator">^</span>N<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token keyword">return</span> R<span class="token punctuation">(</span>lift<span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">/</span> Rp<span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="25"></td><td><pre></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token keyword">def</span> <span class="token function">convolution</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> g<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="27"></td><td><pre>    <span class="token keyword">return</span> <span class="token punctuation">(</span>f<span class="token operator">*</span>g<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token punctuation">(</span>x<span class="token operator">^</span>N<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="28"></td><td><pre></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token keyword">def</span> <span class="token function">liftMod</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> q<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="30"></td><td><pre>    g <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>f<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> q<span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">%</span> q<span class="token punctuation">)</span> <span class="token operator">-</span> q<span class="token operator">//</span><span class="token number">2</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    <span class="token keyword">return</span> R<span class="token punctuation">(</span>g<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="32"></td><td><pre></pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token keyword">def</span> <span class="token function">polyMod</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> q<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="34"></td><td><pre>    g <span class="token operator">=</span> <span class="token punctuation">[</span>f<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">%</span>q <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="35"></td><td><pre>    <span class="token keyword">return</span> R<span class="token punctuation">(</span>g<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="36"></td><td><pre></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token keyword">def</span> <span class="token function">invertModPow2</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> q<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="38"></td><td><pre>    <span class="token keyword">assert</span> q<span class="token punctuation">.</span>is_power_of<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="39"></td><td><pre>    g <span class="token operator">=</span> invertModPrime<span class="token punctuation">(</span>f<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="40"></td><td><pre>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="41"></td><td><pre>        r <span class="token operator">=</span> liftMod<span class="token punctuation">(</span>convolution<span class="token punctuation">(</span>g<span class="token punctuation">,</span>f<span class="token punctuation">)</span><span class="token punctuation">,</span>q<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="42"></td><td><pre>        <span class="token keyword">if</span> r <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span> <span class="token keyword">return</span> g</pre></td></tr><tr><td data-num="43"></td><td><pre>        g <span class="token operator">=</span> liftMod<span class="token punctuation">(</span>convolution<span class="token punctuation">(</span>g<span class="token punctuation">,</span><span class="token number">2</span> <span class="token operator">-</span> r<span class="token punctuation">)</span><span class="token punctuation">,</span>q<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="44"></td><td><pre></pre></td></tr><tr><td data-num="45"></td><td><pre><span class="token keyword">def</span> <span class="token function">genMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="46"></td><td><pre>    result <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>randrange<span class="token punctuation">(</span>p<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="47"></td><td><pre>    <span class="token keyword">return</span> R<span class="token punctuation">(</span>result<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="48"></td><td><pre></pre></td></tr><tr><td data-num="49"></td><td><pre><span class="token keyword">def</span> <span class="token function">genKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="50"></td><td><pre>  <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="51"></td><td><pre>    <span class="token keyword">try</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="52"></td><td><pre>      f <span class="token operator">=</span> T<span class="token punctuation">(</span>d<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> d<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="53"></td><td><pre>      g <span class="token operator">=</span> T<span class="token punctuation">(</span>d<span class="token punctuation">,</span> d<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="54"></td><td><pre>      Fp <span class="token operator">=</span> polyMod<span class="token punctuation">(</span>invertModPrime<span class="token punctuation">(</span>f<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="55"></td><td><pre>      Fq <span class="token operator">=</span> polyMod<span class="token punctuation">(</span>invertModPow2<span class="token punctuation">(</span>f<span class="token punctuation">,</span> q<span class="token punctuation">)</span><span class="token punctuation">,</span> q<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="56"></td><td><pre>      <span class="token keyword">print</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="57"></td><td><pre>      <span class="token keyword">print</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="58"></td><td><pre>      <span class="token keyword">break</span></pre></td></tr><tr><td data-num="59"></td><td><pre>    <span class="token keyword">except</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="60"></td><td><pre>      <span class="token keyword">continue</span></pre></td></tr><tr><td data-num="61"></td><td><pre>  h <span class="token operator">=</span> polyMod<span class="token punctuation">(</span>convolution<span class="token punctuation">(</span>Fq<span class="token punctuation">,</span> g<span class="token punctuation">)</span><span class="token punctuation">,</span> q<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="62"></td><td><pre>  <span class="token keyword">return</span> h<span class="token punctuation">,</span> <span class="token punctuation">(</span>f<span class="token punctuation">,</span> g<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="63"></td><td><pre></pre></td></tr><tr><td data-num="64"></td><td><pre><span class="token keyword">def</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> h<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="65"></td><td><pre>  e <span class="token operator">=</span> liftMod<span class="token punctuation">(</span>p<span class="token operator">*</span>convolution<span class="token punctuation">(</span>h<span class="token punctuation">,</span> T<span class="token punctuation">(</span>d<span class="token punctuation">,</span> d<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> m<span class="token punctuation">,</span> q<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="66"></td><td><pre>  <span class="token keyword">return</span> e</pre></td></tr><tr><td data-num="67"></td><td><pre></pre></td></tr><tr><td data-num="68"></td><td><pre><span class="token comment"># Step 1</span></pre></td></tr><tr><td data-num="69"></td><td><pre>h<span class="token punctuation">,</span> secret <span class="token operator">=</span> genKey<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="70"></td><td><pre>m <span class="token operator">=</span> genMessage<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="71"></td><td><pre>e <span class="token operator">=</span> encrypt<span class="token punctuation">(</span>m<span class="token punctuation">,</span> h<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="72"></td><td><pre></pre></td></tr><tr><td data-num="73"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'h = %s'</span> <span class="token operator">%</span> h<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="74"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'e = %s'</span> <span class="token operator">%</span> e<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="75"></td><td><pre></pre></td></tr><tr><td data-num="76"></td><td><pre><span class="token comment"># Step 2</span></pre></td></tr><tr><td data-num="77"></td><td><pre>sha3 <span class="token operator">=</span> SHA3_256<span class="token punctuation">.</span>new<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="78"></td><td><pre>sha3<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token builtin">bytes</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="79"></td><td><pre>key <span class="token operator">=</span> sha3<span class="token punctuation">.</span>digest<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="80"></td><td><pre></pre></td></tr><tr><td data-num="81"></td><td><pre>cypher <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_ECB<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="82"></td><td><pre>c <span class="token operator">=</span> cypher<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>pad<span class="token punctuation">(</span>flag<span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="83"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'c = %s'</span> <span class="token operator">%</span> c<span class="token punctuation">)</span></pre></td></tr></table></figure><p>NTRU 对 m 进行加密得到 h，e 多项式</p><p>将 m 的多项式当做 AES 的 key 对 flag 进行加密</p><p>我们只要知道 m 就可以求 flag</p><p>这道应该是非预期</p><p>本来 La 佬的脚本跑一下应该可以，但是他 Fp 没有逆元求不出来</p><p>然后看到 m</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">def</span> <span class="token function">genMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    result <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>randrange<span class="token punctuation">(</span>p<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token keyword">return</span> R<span class="token punctuation">(</span>result<span class="token punctuation">)</span></pre></td></tr></table></figure><p>p=3 n=10</p><p>也就是说 m 的系数只有 - 1,0,1 并且只有 10 位</p><p>就直接爆破 m 就行</p><h2 id="exp-2"><a class="anchor" href="#exp-2">#</a> exp</h2><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#sage</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> itertools <span class="token keyword">import</span> product</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> AES</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Hash <span class="token keyword">import</span> SHA3_256</pre></td></tr><tr><td data-num="6"></td><td><pre>li<span class="token operator">=</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="7"></td><td><pre>m<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="8"></td><td><pre>R<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token operator">></span> <span class="token operator">=</span> ZZ<span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> product<span class="token punctuation">(</span>li<span class="token punctuation">,</span>repeat<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    m<span class="token operator">=</span><span class="token builtin">list</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    m<span class="token operator">=</span>R<span class="token punctuation">(</span>m<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    sha3 <span class="token operator">=</span> SHA3_256<span class="token punctuation">.</span>new<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    sha3<span class="token operator">=</span>sha3<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token builtin">bytes</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    key <span class="token operator">=</span> sha3<span class="token punctuation">.</span>digest<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    c <span class="token operator">=</span> <span class="token string">b'\xb9W\x8c\x8b\x0cG\xde\x7fl\xf7\x03\xbb9m\x0c\xc4L\xfe\xe9Q\xad\xfd\xda!\x1a\xea@&#125;U\x9ay4\x8a\xe3y\xdf\xd5BV\xa7\x06\xf9\x08\x96="f\xc1\x1b\xd7\xdb\xc1j\x82F\x0b\x16\x06\xbcJMB\xc8\x80'</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    cypher <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_ECB<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    c <span class="token operator">=</span> cypher<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>c<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token keyword">if</span> <span class="token string">b'DAS'</span> <span class="token keyword">in</span> c<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        <span class="token keyword">break</span></pre></td></tr></table></figure><p><code>DASCTF&#123;b437acf4-aaf8-4f8f-ad84-5b1824f5af9c&#125;</code></p><h1 id="ntrursa"><a class="anchor" href="#ntrursa">#</a> NTRURSA</h1><h2 id="题目-3"><a class="anchor" href="#题目-3">#</a> 题目</h2><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">def</span> <span class="token function">gen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    p1 <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        f <span class="token operator">=</span> getRandomRange<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> iroot<span class="token punctuation">(</span>p1 <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        g <span class="token operator">=</span> getRandomRange<span class="token punctuation">(</span>iroot<span class="token punctuation">(</span>p1 <span class="token operator">//</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> iroot<span class="token punctuation">(</span>p1 <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        <span class="token keyword">if</span> gcd<span class="token punctuation">(</span>f<span class="token punctuation">,</span> p1<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token keyword">and</span> gcd<span class="token punctuation">(</span>f<span class="token punctuation">,</span> g<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token keyword">and</span> isPrime<span class="token punctuation">(</span>g<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="12"></td><td><pre>            <span class="token keyword">break</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    rand <span class="token operator">=</span> getRandomRange<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span> <span class="token operator">^</span> <span class="token number">20</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    g1 <span class="token operator">=</span> g <span class="token operator">^</span><span class="token operator">^</span> rand</pre></td></tr><tr><td data-num="15"></td><td><pre>    h <span class="token operator">=</span> <span class="token punctuation">(</span>inverse<span class="token punctuation">(</span>f<span class="token punctuation">,</span> p1<span class="token punctuation">)</span> <span class="token operator">*</span> g1<span class="token punctuation">)</span> <span class="token operator">%</span> p1</pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token keyword">return</span> h<span class="token punctuation">,</span> p1<span class="token punctuation">,</span> g<span class="token punctuation">,</span> f<span class="token punctuation">,</span> g1</pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token keyword">def</span> <span class="token function">gen_irreducable_poly</span><span class="token punctuation">(</span>deg<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="21"></td><td><pre>        out <span class="token operator">=</span> R<span class="token punctuation">.</span>random_element<span class="token punctuation">(</span>degree<span class="token operator">=</span>deg<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="22"></td><td><pre>        <span class="token keyword">if</span> out<span class="token punctuation">.</span>is_irreducible<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="23"></td><td><pre>            <span class="token keyword">return</span> out</pre></td></tr><tr><td data-num="24"></td><td><pre></pre></td></tr><tr><td data-num="25"></td><td><pre></pre></td></tr><tr><td data-num="26"></td><td><pre>h<span class="token punctuation">,</span> p1<span class="token punctuation">,</span> g<span class="token punctuation">,</span> f<span class="token punctuation">,</span> g1 <span class="token operator">=</span> gen<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="27"></td><td><pre>q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="28"></td><td><pre>n <span class="token operator">=</span> g <span class="token operator">*</span> q </pre></td></tr><tr><td data-num="29"></td><td><pre>e <span class="token operator">=</span> <span class="token number">0x10001</span></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token comment">#c1 = pow(bytes_to_long(flag), e, n)</span></pre></td></tr><tr><td data-num="31"></td><td><pre>hint <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>h<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="32"></td><td><pre>length <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>hint<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="33"></td><td><pre>bits <span class="token operator">=</span> <span class="token number">16</span></pre></td></tr><tr><td data-num="34"></td><td><pre>p2 <span class="token operator">=</span> random_prime<span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">^</span> bits <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token number">2</span> <span class="token operator">^</span> <span class="token punctuation">(</span>bits <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="35"></td><td><pre>R<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>GF<span class="token punctuation">(</span>p2<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="36"></td><td><pre>P <span class="token operator">=</span> gen_irreducable_poly<span class="token punctuation">(</span>ZZ<span class="token punctuation">.</span>random_element<span class="token punctuation">(</span>length<span class="token punctuation">,</span> <span class="token number">2</span> <span class="token operator">*</span> length<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="37"></td><td><pre>Q <span class="token operator">=</span> gen_irreducable_poly<span class="token punctuation">(</span>ZZ<span class="token punctuation">.</span>random_element<span class="token punctuation">(</span>length<span class="token punctuation">,</span> <span class="token number">2</span> <span class="token operator">*</span> length<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="38"></td><td><pre>N <span class="token operator">=</span> P <span class="token operator">*</span> Q</pre></td></tr><tr><td data-num="39"></td><td><pre>S<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token operator">></span> <span class="token operator">=</span> R<span class="token punctuation">.</span>quotient<span class="token punctuation">(</span>N<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="40"></td><td><pre>m <span class="token operator">=</span> S<span class="token punctuation">(</span>hint<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="41"></td><td><pre>c2 <span class="token operator">=</span> m <span class="token operator">^</span> e</pre></td></tr><tr><td data-num="42"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"p1 ="</span><span class="token punctuation">,</span> p1<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="43"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"c1 ="</span><span class="token punctuation">,</span> c1<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="44"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"p2 ="</span><span class="token punctuation">,</span> p2<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="45"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"c2 ="</span><span class="token punctuation">,</span> c2<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="46"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"n ="</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="47"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"N ="</span><span class="token punctuation">,</span> N<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="48"></td><td><pre></pre></td></tr><tr><td data-num="49"></td><td><pre></pre></td></tr><tr><td data-num="50"></td><td><pre><span class="token triple-quoted-string string">'''</span></pre></td></tr><tr><td data-num="51"></td><td><pre>p1 = 106472061241112922861460644342336453303928202010237284715354717630502168520267</pre></td></tr><tr><td data-num="52"></td><td><pre>c1 = 20920247107738496784071050239422540936224577122721266141057957551603705972966457203177812404896852110975768315464852962210648535130235298413611598658659777108920014929632531307409885868941842921815735008981335582297975794108016151210394446009890312043259167806981442425505200141283138318269058818777636637375101005540308736021976559495266332357714</pre></td></tr><tr><td data-num="53"></td><td><pre>p2 = 64621</pre></td></tr><tr><td data-num="54"></td><td><pre>c2 = 19921*x^174 + 49192*x^173 + 18894*x^172 + 61121*x^171 + 50271*x^170 + 11860*x^169 + 53128*x^168 + 38658*x^167 + 14191*x^166 + 9671*x^165 + 40879*x^164 + 15187*x^163 + 33523*x^162 + 62270*x^161 + 64211*x^160 + 54518*x^159 + 50446*x^158 + 2597*x^157 + 32216*x^156 + 10500*x^155 + 63276*x^154 + 27916*x^153 + 55316*x^152 + 30898*x^151 + 43706*x^150 + 5734*x^149 + 35616*x^148 + 14288*x^147 + 18282*x^146 + 22788*x^145 + 48188*x^144 + 34176*x^143 + 55952*x^142 + 9578*x^141 + 9177*x^140 + 22083*x^139 + 14586*x^138 + 9748*x^137 + 21118*x^136 + 155*x^135 + 64224*x^134 + 18193*x^133 + 33732*x^132 + 38135*x^131 + 51992*x^130 + 8203*x^129 + 8538*x^128 + 55203*x^127 + 5003*x^126 + 2009*x^125 + 45023*x^124 + 12311*x^123 + 21428*x^122 + 24110*x^121 + 43537*x^120 + 21885*x^119 + 50212*x^118 + 40445*x^117 + 17768*x^116 + 46616*x^115 + 4771*x^114 + 20903*x^113 + 47764*x^112 + 13056*x^111 + 50837*x^110 + 22313*x^109 + 39698*x^108 + 60377*x^107 + 59357*x^106 + 24051*x^105 + 5888*x^104 + 29414*x^103 + 31726*x^102 + 4906*x^101 + 23968*x^100 + 52360*x^99 + 58063*x^98 + 706*x^97 + 31420*x^96 + 62468*x^95 + 18557*x^94 + 1498*x^93 + 17590*x^92 + 62990*x^91 + 27200*x^90 + 7052*x^89 + 39117*x^88 + 46944*x^87 + 45535*x^86 + 28092*x^85 + 1981*x^84 + 4377*x^83 + 34419*x^82 + 33754*x^81 + 2640*x^80 + 44427*x^79 + 32179*x^78 + 57721*x^77 + 9444*x^76 + 49374*x^75 + 21288*x^74 + 44098*x^73 + 57744*x^72 + 63457*x^71 + 43300*x^70 + 1508*x^69 + 13775*x^68 + 23197*x^67 + 43070*x^66 + 20751*x^65 + 47479*x^64 + 18496*x^63 + 53392*x^62 + 10387*x^61 + 2317*x^60 + 57492*x^59 + 25441*x^58 + 52532*x^57 + 27150*x^56 + 33788*x^55 + 43371*x^54 + 30972*x^53 + 39583*x^52 + 36407*x^51 + 35564*x^50 + 44564*x^49 + 1505*x^48 + 47519*x^47 + 38695*x^46 + 43107*x^45 + 1676*x^44 + 42057*x^43 + 49879*x^42 + 29083*x^41 + 42241*x^40 + 8853*x^39 + 33546*x^38 + 48954*x^37 + 30352*x^36 + 62020*x^35 + 39864*x^34 + 9519*x^33 + 24828*x^32 + 34696*x^31 + 2387*x^30 + 27413*x^29 + 55829*x^28 + 40217*x^27 + 30205*x^26 + 42328*x^25 + 6210*x^24 + 52442*x^23 + 58495*x^22 + 2014*x^21 + 26452*x^20 + 33547*x^19 + 19840*x^18 + 5995*x^17 + 16850*x^16 + 37855*x^15 + 7221*x^14 + 32200*x^13 + 8121*x^12 + 23767*x^11 + 46563*x^10 + 51673*x^9 + 19372*x^8 + 4157*x^7 + 48421*x^6 + 41096*x^5 + 45735*x^4 + 53022*x^3 + 35475*x^2 + 47521*x + 27544</pre></td></tr><tr><td data-num="55"></td><td><pre>n = 31398174203566229210665534094126601315683074641013205440476552584312112883638278390105806127975406224783128340041129316782549009811196493319665336016690985557862367551545487842904828051293613836275987595871004601968935866634955528775536847402581734910742403788941725304146192149165731194199024154454952157531068881114411265538547462017207361362857</pre></td></tr><tr><td data-num="56"></td><td><pre>N = 25081*x^175 + 8744*x^174 + 9823*x^173 + 9037*x^172 + 6343*x^171 + 42205*x^170 + 28573*x^169 + 55714*x^168 + 17287*x^167 + 11229*x^166 + 42630*x^165 + 64363*x^164 + 50759*x^163 + 3368*x^162 + 20900*x^161 + 55947*x^160 + 7082*x^159 + 23171*x^158 + 48510*x^157 + 20013*x^156 + 16798*x^155 + 60438*x^154 + 58779*x^153 + 9289*x^152 + 10623*x^151 + 1085*x^150 + 23473*x^149 + 13795*x^148 + 2071*x^147 + 31515*x^146 + 42832*x^145 + 38152*x^144 + 37559*x^143 + 47653*x^142 + 37371*x^141 + 39128*x^140 + 48750*x^139 + 16638*x^138 + 60320*x^137 + 56224*x^136 + 41870*x^135 + 63961*x^134 + 47574*x^133 + 63954*x^132 + 9668*x^131 + 62360*x^130 + 15244*x^129 + 20599*x^128 + 28704*x^127 + 26857*x^126 + 34885*x^125 + 33107*x^124 + 17693*x^123 + 52753*x^122 + 60744*x^121 + 21305*x^120 + 63785*x^119 + 54400*x^118 + 17812*x^117 + 64549*x^116 + 20035*x^115 + 37567*x^114 + 38607*x^113 + 32783*x^112 + 24385*x^111 + 5387*x^110 + 5134*x^109 + 45893*x^108 + 58307*x^107 + 33821*x^106 + 54902*x^105 + 14236*x^104 + 58044*x^103 + 41257*x^102 + 46881*x^101 + 42834*x^100 + 1693*x^99 + 46058*x^98 + 15636*x^97 + 27111*x^96 + 3158*x^95 + 41012*x^94 + 26028*x^93 + 3576*x^92 + 37958*x^91 + 33273*x^90 + 60228*x^89 + 41229*x^88 + 11232*x^87 + 12635*x^86 + 17942*x^85 + 4*x^84 + 25397*x^83 + 63526*x^82 + 54872*x^81 + 40318*x^80 + 37498*x^79 + 52182*x^78 + 48817*x^77 + 10763*x^76 + 46542*x^75 + 36060*x^74 + 49972*x^73 + 63603*x^72 + 46506*x^71 + 44788*x^70 + 44905*x^69 + 46112*x^68 + 5297*x^67 + 26440*x^66 + 28470*x^65 + 15525*x^64 + 11566*x^63 + 15781*x^62 + 36098*x^61 + 44402*x^60 + 55331*x^59 + 61583*x^58 + 16406*x^57 + 59089*x^56 + 53161*x^55 + 43695*x^54 + 49580*x^53 + 62685*x^52 + 31447*x^51 + 26755*x^50 + 14810*x^49 + 3281*x^48 + 27371*x^47 + 53392*x^46 + 2648*x^45 + 10095*x^44 + 25977*x^43 + 22912*x^42 + 41278*x^41 + 33236*x^40 + 57792*x^39 + 7169*x^38 + 29250*x^37 + 16906*x^36 + 4436*x^35 + 2729*x^34 + 29736*x^33 + 19383*x^32 + 11921*x^31 + 26075*x^30 + 54616*x^29 + 739*x^28 + 38509*x^27 + 19118*x^26 + 20062*x^25 + 21280*x^24 + 12594*x^23 + 14974*x^22 + 27795*x^21 + 54107*x^20 + 1890*x^19 + 13410*x^18 + 5381*x^17 + 19500*x^16 + 47481*x^15 + 58488*x^14 + 26433*x^13 + 37803*x^12 + 60232*x^11 + 34772*x^10 + 1505*x^9 + 63760*x^8 + 20890*x^7 + 41533*x^6 + 16130*x^5 + 29769*x^4 + 49142*x^3 + 64184*x^2 + 55443*x + 45925</pre></td></tr><tr><td data-num="57"></td><td><pre>'''</pre></td></tr></table></figure><p>NTRU 与 RSA 的结合</p><p>先是生成 NTRU 的公私钥</p><p>将 g 做为 n 的一个乘数</p><p>flag 进行 RSA 加密</p><p>然后将 h 作为 hint RSA 多项式加密</p><p>我们可以求出 h 通过 h 求出 g1<span class="exturl" data-url="aHR0cHM6Ly94ei5hbGl5dW4uY29tL3QvNzE2Mw=="> 详情戳</span></p><p>再爆破 g</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>p<span class="token operator">=</span><span class="token number">64621</span></pre></td></tr><tr><td data-num="2"></td><td><pre>R<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>GF<span class="token punctuation">(</span><span class="token number">64621</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre>N<span class="token operator">=</span>R<span class="token punctuation">(</span><span class="token string">"25081*x^175 + 8744*x^174 + 9823*x^173 + 9037*x^172 + 6343*x^171 + 42205*x^170 + 28573*x^169 + 55714*x^168 + 17287*x^167 + 11229*x^166 + 42630*x^165 + 64363*x^164 + 50759*x^163 + 3368*x^162 + 20900*x^161 + 55947*x^160 + 7082*x^159 + 23171*x^158 + 48510*x^157 + 20013*x^156 + 16798*x^155 + 60438*x^154 + 58779*x^153 + 9289*x^152 + 10623*x^151 + 1085*x^150 + 23473*x^149 + 13795*x^148 + 2071*x^147 + 31515*x^146 + 42832*x^145 + 38152*x^144 + 37559*x^143 + 47653*x^142 + 37371*x^141 + 39128*x^140 + 48750*x^139 + 16638*x^138 + 60320*x^137 + 56224*x^136 + 41870*x^135 + 63961*x^134 + 47574*x^133 + 63954*x^132 + 9668*x^131 + 62360*x^130 + 15244*x^129 + 20599*x^128 + 28704*x^127 + 26857*x^126 + 34885*x^125 + 33107*x^124 + 17693*x^123 + 52753*x^122 + 60744*x^121 + 21305*x^120 + 63785*x^119 + 54400*x^118 + 17812*x^117 + 64549*x^116 + 20035*x^115 + 37567*x^114 + 38607*x^113 + 32783*x^112 + 24385*x^111 + 5387*x^110 + 5134*x^109 + 45893*x^108 + 58307*x^107 + 33821*x^106 + 54902*x^105 + 14236*x^104 + 58044*x^103 + 41257*x^102 + 46881*x^101 + 42834*x^100 + 1693*x^99 + 46058*x^98 + 15636*x^97 + 27111*x^96 + 3158*x^95 + 41012*x^94 + 26028*x^93 + 3576*x^92 + 37958*x^91 + 33273*x^90 + 60228*x^89 + 41229*x^88 + 11232*x^87 + 12635*x^86 + 17942*x^85 + 4*x^84 + 25397*x^83 + 63526*x^82 + 54872*x^81 + 40318*x^80 + 37498*x^79 + 52182*x^78 + 48817*x^77 + 10763*x^76 + 46542*x^75 + 36060*x^74 + 49972*x^73 + 63603*x^72 + 46506*x^71 + 44788*x^70 + 44905*x^69 + 46112*x^68 + 5297*x^67 + 26440*x^66 + 28470*x^65 + 15525*x^64 + 11566*x^63 + 15781*x^62 + 36098*x^61 + 44402*x^60 + 55331*x^59 + 61583*x^58 + 16406*x^57 + 59089*x^56 + 53161*x^55 + 43695*x^54 + 49580*x^53 + 62685*x^52 + 31447*x^51 + 26755*x^50 + 14810*x^49 + 3281*x^48 + 27371*x^47 + 53392*x^46 + 2648*x^45 + 10095*x^44 + 25977*x^43 + 22912*x^42 + 41278*x^41 + 33236*x^40 + 57792*x^39 + 7169*x^38 + 29250*x^37 + 16906*x^36 + 4436*x^35 + 2729*x^34 + 29736*x^33 + 19383*x^32 + 11921*x^31 + 26075*x^30 + 54616*x^29 + 739*x^28 + 38509*x^27 + 19118*x^26 + 20062*x^25 + 21280*x^24 + 12594*x^23 + 14974*x^22 + 27795*x^21 + 54107*x^20 + 1890*x^19 + 13410*x^18 + 5381*x^17 + 19500*x^16 + 47481*x^15 + 58488*x^14 + 26433*x^13 + 37803*x^12 + 60232*x^11 + 34772*x^10 + 1505*x^9 + 63760*x^8 + 20890*x^7 + 41533*x^6 + 16130*x^5 + 29769*x^4 + 49142*x^3 + 64184*x^2 + 55443*x + 45925"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre>C<span class="token operator">=</span>R<span class="token punctuation">(</span><span class="token string">"19921*x^174 + 49192*x^173 + 18894*x^172 + 61121*x^171 + 50271*x^170 + 11860*x^169 + 53128*x^168 + 38658*x^167 + 14191*x^166 + 9671*x^165 + 40879*x^164 + 15187*x^163 + 33523*x^162 + 62270*x^161 + 64211*x^160 + 54518*x^159 + 50446*x^158 + 2597*x^157 + 32216*x^156 + 10500*x^155 + 63276*x^154 + 27916*x^153 + 55316*x^152 + 30898*x^151 + 43706*x^150 + 5734*x^149 + 35616*x^148 + 14288*x^147 + 18282*x^146 + 22788*x^145 + 48188*x^144 + 34176*x^143 + 55952*x^142 + 9578*x^141 + 9177*x^140 + 22083*x^139 + 14586*x^138 + 9748*x^137 + 21118*x^136 + 155*x^135 + 64224*x^134 + 18193*x^133 + 33732*x^132 + 38135*x^131 + 51992*x^130 + 8203*x^129 + 8538*x^128 + 55203*x^127 + 5003*x^126 + 2009*x^125 + 45023*x^124 + 12311*x^123 + 21428*x^122 + 24110*x^121 + 43537*x^120 + 21885*x^119 + 50212*x^118 + 40445*x^117 + 17768*x^116 + 46616*x^115 + 4771*x^114 + 20903*x^113 + 47764*x^112 + 13056*x^111 + 50837*x^110 + 22313*x^109 + 39698*x^108 + 60377*x^107 + 59357*x^106 + 24051*x^105 + 5888*x^104 + 29414*x^103 + 31726*x^102 + 4906*x^101 + 23968*x^100 + 52360*x^99 + 58063*x^98 + 706*x^97 + 31420*x^96 + 62468*x^95 + 18557*x^94 + 1498*x^93 + 17590*x^92 + 62990*x^91 + 27200*x^90 + 7052*x^89 + 39117*x^88 + 46944*x^87 + 45535*x^86 + 28092*x^85 + 1981*x^84 + 4377*x^83 + 34419*x^82 + 33754*x^81 + 2640*x^80 + 44427*x^79 + 32179*x^78 + 57721*x^77 + 9444*x^76 + 49374*x^75 + 21288*x^74 + 44098*x^73 + 57744*x^72 + 63457*x^71 + 43300*x^70 + 1508*x^69 + 13775*x^68 + 23197*x^67 + 43070*x^66 + 20751*x^65 + 47479*x^64 + 18496*x^63 + 53392*x^62 + 10387*x^61 + 2317*x^60 + 57492*x^59 + 25441*x^58 + 52532*x^57 + 27150*x^56 + 33788*x^55 + 43371*x^54 + 30972*x^53 + 39583*x^52 + 36407*x^51 + 35564*x^50 + 44564*x^49 + 1505*x^48 + 47519*x^47 + 38695*x^46 + 43107*x^45 + 1676*x^44 + 42057*x^43 + 49879*x^42 + 29083*x^41 + 42241*x^40 + 8853*x^39 + 33546*x^38 + 48954*x^37 + 30352*x^36 + 62020*x^35 + 39864*x^34 + 9519*x^33 + 24828*x^32 + 34696*x^31 + 2387*x^30 + 27413*x^29 + 55829*x^28 + 40217*x^27 + 30205*x^26 + 42328*x^25 + 6210*x^24 + 52442*x^23 + 58495*x^22 + 2014*x^21 + 26452*x^20 + 33547*x^19 + 19840*x^18 + 5995*x^17 + 16850*x^16 + 37855*x^15 + 7221*x^14 + 32200*x^13 + 8121*x^12 + 23767*x^11 + 46563*x^10 + 51673*x^9 + 19372*x^8 + 4157*x^7 + 48421*x^6 + 41096*x^5 + 45735*x^4 + 53022*x^3 + 35475*x^2 + 47521*x + 27544"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre>S<span class="token operator">=</span>R<span class="token punctuation">(</span><span class="token string">"x^175 + 37040*x^174 + 24879*x^173 + 14573*x^172 + 33018*x^171 + 25241*x^170 + 33949*x^169 + 21333*x^168 + 31488*x^167 + 12566*x^166 + 13384*x^165 + 32134*x^164 + 9803*x^163 + 51396*x^162 + 21311*x^161 + 46915*x^160 + 56191*x^159 + 54048*x^158 + 21915*x^157 + 60654*x^156 + 12744*x^155 + 46606*x^154 + 27813*x^153 + 58327*x^152 + 51976*x^151 + 41193*x^150 + 46991*x^149 + 62161*x^148 + 42118*x^147 + 45229*x^146 + 43328*x^145 + 43132*x^144 + 47360*x^143 + 4923*x^142 + 34207*x^141 + 41295*x^140 + 23582*x^139 + 33173*x^138 + 52787*x^137 + 32953*x^136 + 61956*x^135 + 11571*x^134 + 34800*x^133 + 35486*x^132 + 46689*x^131 + 34646*x^130 + 22952*x^129 + 15720*x^128 + 57207*x^127 + 25261*x^126 + 6708*x^125 + 6744*x^124 + 1459*x^123 + 56502*x^122 + 53578*x^121 + 3930*x^120 + 40505*x^119 + 33208*x^118 + 47251*x^117 + 5962*x^116 + 40882*x^115 + 10797*x^114 + 39561*x^113 + 33573*x^112 + 14553*x^111 + 40379*x^110 + 9273*x^109 + 35779*x^108 + 52537*x^107 + 23012*x^106 + 16770*x^105 + 41799*x^104 + 18669*x^103 + 60660*x^102 + 11408*x^101 + 18032*x^100 + 41108*x^99 + 16731*x^98 + 40753*x^97 + 43719*x^96 + 58015*x^95 + 57612*x^94 + 41851*x^93 + 5452*x^92 + 41246*x^91 + 39669*x^90 + 53225*x^89 + 27078*x^88 + 39243*x^87 + 253*x^86 + 18536*x^85 + 14029*x^84 + 9735*x^83 + 20666*x^82 + 8484*x^81 + 46868*x^80 + 43436*x^79 + 40958*x^78 + 16239*x^77 + 26023*x^76 + 34094*x^75 + 8138*x^74 + 12145*x^73 + 16085*x^72 + 37075*x^71 + 53683*x^70 + 60150*x^69 + 44570*x^68 + 15521*x^67 + 555*x^66 + 44273*x^65 + 23019*x^64 + 15176*x^63 + 16181*x^62 + 44482*x^61 + 24615*x^60 + 18942*x^59 + 39750*x^58 + 59564*x^57 + 48814*x^56 + 1177*x^55 + 49053*x^54 + 58965*x^53 + 59790*x^52 + 599*x^51 + 22937*x^50 + 19399*x^49 + 53215*x^48 + 50910*x^47 + 52055*x^46 + 46395*x^45 + 9536*x^44 + 40689*x^43 + 34209*x^42 + 53536*x^41 + 55298*x^40 + 39536*x^39 + 54372*x^38 + 1225*x^37 + 3801*x^36 + 49121*x^35 + 55843*x^34 + 57913*x^33 + 15890*x^32 + 48606*x^31 + 28984*x^30 + 15322*x^29 + 23173*x^28 + 51266*x^27 + 7318*x^26 + 22491*x^25 + 61646*x^24 + 1853*x^23 + 12999*x^22 + 51701*x^21 + 55675*x^20 + 5050*x^19 + 20445*x^18 + 51646*x^17 + 22357*x^16 + 47886*x^15 + 24984*x^14 + 24470*x^13 + 63056*x^12 + 2633*x^11 + 14270*x^10 + 27955*x^9 + 33600*x^8 + 18549*x^7 + 59346*x^6 + 60878*x^5 + 28255*x^4 + 41383*x^3 + 34391*x^2 + 24028*x + 18769"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>phi <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">**</span><span class="token number">78</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>p<span class="token operator">**</span><span class="token number">97</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>e <span class="token operator">=</span> <span class="token number">65537</span></pre></td></tr><tr><td data-num="8"></td><td><pre>d <span class="token operator">=</span> inverse_mod<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>RES <span class="token operator">=</span> R<span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>MUL <span class="token operator">=</span> C</pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="13"></td><td><pre>	<span class="token keyword">if</span><span class="token punctuation">(</span>d <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="14"></td><td><pre>		RES <span class="token operator">=</span> <span class="token punctuation">(</span>RES <span class="token operator">*</span> MUL<span class="token punctuation">)</span> <span class="token operator">%</span> S</pre></td></tr><tr><td data-num="15"></td><td><pre>		d <span class="token operator">=</span> d <span class="token operator">-</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="16"></td><td><pre>	d <span class="token operator">=</span> d <span class="token operator">/</span> <span class="token number">2</span></pre></td></tr><tr><td data-num="17"></td><td><pre>	MUL <span class="token operator">=</span> <span class="token punctuation">(</span>MUL <span class="token operator">*</span> MUL<span class="token punctuation">)</span> <span class="token operator">%</span> S</pre></td></tr><tr><td data-num="18"></td><td><pre>	<span class="token keyword">if</span><span class="token punctuation">(</span>d <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="19"></td><td><pre>		<span class="token keyword">break</span></pre></td></tr><tr><td data-num="20"></td><td><pre>h<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> RES<span class="token punctuation">.</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="21"></td><td><pre></pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre>h<span class="token operator">=</span><span class="token number">88520242910362871448352317137540300262448941340486475602003226117035863930302</span></pre></td></tr><tr><td data-num="24"></td><td><pre>p1 <span class="token operator">=</span> <span class="token number">106472061241112922861460644342336453303928202010237284715354717630502168520267</span></pre></td></tr><tr><td data-num="25"></td><td><pre>c1 <span class="token operator">=</span> <span class="token number">20920247107738496784071050239422540936224577122721266141057957551603705972966457203177812404896852110975768315464852962210648535130235298413611598658659777108920014929632531307409885868941842921815735008981335582297975794108016151210394446009890312043259167806981442425505200141283138318269058818777636637375101005540308736021976559495266332357714</span></pre></td></tr><tr><td data-num="26"></td><td><pre>v1 <span class="token operator">=</span> vector<span class="token punctuation">(</span>ZZ<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> h<span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="27"></td><td><pre>v2 <span class="token operator">=</span> vector<span class="token punctuation">(</span>ZZ<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> p1<span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="28"></td><td><pre>m <span class="token operator">=</span> matrix<span class="token punctuation">(</span><span class="token punctuation">[</span>v1<span class="token punctuation">,</span>v2<span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="29"></td><td><pre>shortest_vector <span class="token operator">=</span> m<span class="token punctuation">.</span>LLL<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="30"></td><td><pre>g1<span class="token operator">=</span>shortest_vector<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="31"></td><td><pre></pre></td></tr><tr><td data-num="32"></td><td><pre></pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token keyword">from</span> tqdm <span class="token keyword">import</span> tqdm</pre></td></tr><tr><td data-num="36"></td><td><pre>g1<span class="token operator">=</span><span class="token number">228679177303871981036829786447405151037</span></pre></td></tr><tr><td data-num="37"></td><td><pre>e <span class="token operator">=</span> <span class="token number">65537</span></pre></td></tr><tr><td data-num="38"></td><td><pre>c <span class="token operator">=</span> <span class="token number">20920247107738496784071050239422540936224577122721266141057957551603705972966457203177812404896852110975768315464852962210648535130235298413611598658659777108920014929632531307409885868941842921815735008981335582297975794108016151210394446009890312043259167806981442425505200141283138318269058818777636637375101005540308736021976559495266332357714</span></pre></td></tr><tr><td data-num="39"></td><td><pre></pre></td></tr><tr><td data-num="40"></td><td><pre>n<span class="token operator">=</span><span class="token number">31398174203566229210665534094126601315683074641013205440476552584312112883638278390105806127975406224783128340041129316782549009811196493319665336016690985557862367551545487842904828051293613836275987595871004601968935866634955528775536847402581734910742403788941725304146192149165731194199024154454952157531068881114411265538547462017207361362857</span></pre></td></tr><tr><td data-num="41"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> tqdm<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">**</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="42"></td><td><pre>    g<span class="token operator">=</span>g1<span class="token operator">^</span>i</pre></td></tr><tr><td data-num="43"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span>isPrime<span class="token punctuation">(</span>g<span class="token punctuation">)</span> <span class="token keyword">and</span> n<span class="token operator">%</span>g<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="44"></td><td><pre>        p<span class="token operator">=</span>n<span class="token operator">//</span>g</pre></td></tr><tr><td data-num="45"></td><td><pre>        phi<span class="token operator">=</span><span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>g<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="46"></td><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span>inverse<span class="token punctuation">(</span>e<span class="token punctuation">,</span>phi<span class="token punctuation">)</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p><code>DASCTF&#123;P01yn0m141RS4_W17h_NTRU&#125;</code></p><h1 id="lwe未复现"><a class="anchor" href="#lwe未复现">#</a> LWE？(未复现)</h1><h2 id="题目-4"><a class="anchor" href="#题目-4">#</a> 题目</h2><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> secret <span class="token keyword">import</span> secret</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">assert</span> <span class="token builtin">len</span><span class="token punctuation">(</span>secret<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">66</span><span class="token operator">*</span><span class="token number">3</span></pre></td></tr><tr><td data-num="3"></td><td><pre>sec <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">ord</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> secret<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre>DEBUG <span class="token operator">=</span> <span class="token boolean">False</span></pre></td></tr><tr><td data-num="6"></td><td><pre>m <span class="token operator">=</span> <span class="token number">66</span></pre></td></tr><tr><td data-num="7"></td><td><pre>n <span class="token operator">=</span> <span class="token number">200</span></pre></td></tr><tr><td data-num="8"></td><td><pre>p <span class="token operator">=</span> <span class="token number">3</span></pre></td></tr><tr><td data-num="9"></td><td><pre>q <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">^</span><span class="token number">20</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">def</span> <span class="token function">errorV</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="12"></td><td><pre>  <span class="token keyword">return</span> vector<span class="token punctuation">(</span>ZZ<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span> <span class="token operator">-</span> randrange<span class="token punctuation">(</span>p<span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">def</span> <span class="token function">matrixMn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="15"></td><td><pre>  <span class="token keyword">return</span> matrix<span class="token punctuation">(</span>ZZ<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>q<span class="token operator">//</span><span class="token number">2</span> <span class="token operator">-</span> randrange<span class="token punctuation">(</span>q<span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre>A<span class="token punctuation">,</span> B<span class="token punctuation">,</span> C <span class="token operator">=</span> matrixMn<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> matrixMn<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> matrixMn<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre>x <span class="token operator">=</span> vector<span class="token punctuation">(</span>ZZ<span class="token punctuation">,</span> sec<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>m<span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="19"></td><td><pre>y <span class="token operator">=</span> vector<span class="token punctuation">(</span>ZZ<span class="token punctuation">,</span> sec<span class="token punctuation">[</span>m<span class="token punctuation">:</span><span class="token number">2</span><span class="token operator">*</span>m<span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre>z <span class="token operator">=</span> vector<span class="token punctuation">(</span>ZZ<span class="token punctuation">,</span> sec<span class="token punctuation">[</span><span class="token number">2</span><span class="token operator">*</span>m<span class="token punctuation">:</span><span class="token number">3</span><span class="token operator">*</span>m<span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="21"></td><td><pre>e <span class="token operator">=</span> errorV<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="22"></td><td><pre>b <span class="token operator">=</span> x<span class="token operator">*</span>A<span class="token operator">+</span>y<span class="token operator">*</span>B<span class="token operator">+</span>z<span class="token operator">*</span>C<span class="token operator">+</span>e</pre></td></tr><tr><td data-num="23"></td><td><pre></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token keyword">if</span> DEBUG<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="25"></td><td><pre>  <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'x = %s'</span> <span class="token operator">%</span> x<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="26"></td><td><pre>  <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'y = %s'</span> <span class="token operator">%</span> y<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="27"></td><td><pre>  <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'z = %s'</span> <span class="token operator">%</span> z<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="28"></td><td><pre>  <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'e = %s'</span> <span class="token operator">%</span> e<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'A = \n%s'</span> <span class="token operator">%</span> A<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'B = \n%s'</span> <span class="token operator">%</span> B<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'C = \n%s'</span> <span class="token operator">%</span> C<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'b = %s'</span> <span class="token operator">%</span> b<span class="token punctuation">)</span></pre></td></tr></table></figure><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2022-07-25 11:51:19" itemprop="dateModified" datetime="2022-07-25T11:51:19+08:00">2022-07-25</time> </span><span id="2022/07/25/match/DASCTF2022-07赋能赛/" class="item leancloud_visitors" data-flag-title="DASCTF2022.07赋能赛" title="阅读次数"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">阅读次数</span> <span class="leancloud-visitors-count"></span> <span class="text">次</span></span></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>Putao0v0 <i class="ic i-at"><em>@</em></i>putao</li><li class="link"><strong>本文链接：</strong> <a href="http://example.com/2022/07/25/match/DASCTF2022-07%E8%B5%8B%E8%83%BD%E8%B5%9B/" title="DASCTF2022.07赋能赛">http://example.com/2022/07/25/match/DASCTF2022-07赋能赛/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/2022/07/22/crypto/%E5%8F%8D%E9%A6%88%E7%A7%BB%E4%BD%8D%E5%AF%84%E5%AD%98%E5%99%A8/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;tva3.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1gicit31ffoj20zk0m8naf.jpg" title="LFSR"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> CRYPTO</span><h3>LFSR</h3></a></div><div class="item right"></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#babysign"><span class="toc-number">1.</span> <span class="toc-text">babysign</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE"><span class="toc-number">1.1.</span> <span class="toc-text">题目</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#exp"><span class="toc-number">1.2.</span> <span class="toc-text">exp</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#easyntru"><span class="toc-number">2.</span> <span class="toc-text">easyNTRU</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE-2"><span class="toc-number">2.1.</span> <span class="toc-text">题目</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#exp-2"><span class="toc-number">2.2.</span> <span class="toc-text">exp</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ntrursa"><span class="toc-number">3.</span> <span class="toc-text">NTRURSA</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE-3"><span class="toc-number">3.1.</span> <span class="toc-text">题目</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#lwe%E6%9C%AA%E5%A4%8D%E7%8E%B0"><span class="toc-number">4.</span> <span class="toc-text">LWE？(未复现)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE-4"><span class="toc-number">4.1.</span> <span class="toc-text">题目</span></a></li></ol></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li><a href="/2022/02/23/match/ctfshow%E5%AF%86%E7%A0%81%E6%8C%91%E6%88%98/" rel="bookmark" title="ctfshow密码挑战">ctfshow密码挑战</a></li><li><a href="/2022/02/23/match/ByteCTF/" rel="bookmark" title="ByteCTF">ByteCTF</a></li><li><a href="/2022/03/02/match/%E5%8D%B7%E7%8E%8B%E6%9D%AF/" rel="bookmark" title="卷王杯">卷王杯</a></li><li><a href="/2022/03/03/match/VN2022/" rel="bookmark" title="VN2022">VN2022</a></li><li><a href="/2022/03/12/match/d%5E3ctf/" rel="bookmark" title="d^3ctf">d^3ctf</a></li><li><a href="/2022/03/21/match/%E8%99%8E%E7%AC%A6%E6%9D%AF/" rel="bookmark" title="虎符杯">虎符杯</a></li><li><a href="/2022/03/24/match/%E7%BA%A2%E6%98%8E%E8%B0%B72022/" rel="bookmark" title="红明谷2022">红明谷2022</a></li><li><a href="/2022/04/09/match/HZNUCTF/" rel="bookmark" title="HZNUCTF">HZNUCTF</a></li><li><a href="/2022/04/27/match/DASCTF%20Apr%20X%20FATE%20%E9%98%B2%E7%96%AB%E6%8C%91%E6%88%98%E8%B5%9B/" rel="bookmark" title="DASCTF Apr X FATE 防疫挑战赛">DASCTF Apr X FATE 防疫挑战赛</a></li><li><a href="/2022/05/16/match/PWNHUB/" rel="bookmark" title="PWNHUB">PWNHUB</a></li><li><a href="/2022/05/16/match/%E5%AE%81%E6%B3%A2%E5%B8%82%E7%AC%AC%E4%BA%94%E5%B1%8A%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/" rel="bookmark" title="宁波市第五届网络安全大赛">宁波市第五届网络安全大赛</a></li><li><a href="/2022/05/27/match/Dest0g3/" rel="bookmark" title="Dest0g3">Dest0g3</a></li><li><a href="/2022/05/27/match/ctfshow%E5%8D%95%E8%BA%AB%E6%9D%AF/" rel="bookmark" title="ctfshow单身杯">ctfshow单身杯</a></li><li><a href="/2022/06/30/match/DASCTF%E5%87%BA%E9%A2%98%E4%BA%BA%E6%8C%91%E6%88%98%E8%B5%9B/" rel="bookmark" title="DASCTF出题人挑战赛">DASCTF出题人挑战赛</a></li><li><a href="/2022/07/08/match/babyrsa/" rel="bookmark" title="鹏程杯2022">鹏程杯2022</a></li><li><a href="/2022/07/11/match/%E8%93%9D%E5%B8%BD%E6%9D%AF2022/" rel="bookmark" title="蓝帽杯2022">蓝帽杯2022</a></li><li><a href="/2022/07/18/match/DSCTF/" rel="bookmark" title="DSCTF">DSCTF</a></li><li><a href="/2022/07/18/match/NepNep/" rel="bookmark" title="NepNep">NepNep</a></li><li><a href="/2022/07/21/match/CRYPTO%20CTF/" rel="bookmark" title="CRYPTO CTF">CRYPTO CTF</a></li><li class="active"><a href="/2022/07/25/match/DASCTF2022-07%E8%B5%8B%E8%83%BD%E8%B5%9B/" rel="bookmark" title="DASCTF2022.07赋能赛">DASCTF2022.07赋能赛</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="Putao0v0" data-src="/images/gulu.jpeg"><p class="name" itemprop="name">Putao0v0</p><div class="description" itemprop="description"></div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">45</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">4</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">3</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL3B1dGFvLWFp" title="https:&#x2F;&#x2F;github.com&#x2F;putao-ai"><i class="ic i-github"></i></span> <span class="exturl item weibo" data-url="aHR0cHM6Ly93ZWliby5jb20vdS8zNjEyMTE4NDMy" title="https:&#x2F;&#x2F;weibo.com&#x2F;u&#x2F;3612118432"><i class="ic i-weibo"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>友链</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2010 – <span itemprop="copyrightYear">2022</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">Putao0v0 @ Putao0v0</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">361k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">5:28</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2022/07/25/match/DASCTF2022-07赋能赛/",favicon:{show:"(*╹▽╹*)土豪我们做朋友好不好",hide:"你是猪吗^(*￣(oo)￣)^"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,copy_tex:!0,katex:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html><!-- rebuild by hrmmi -->