<!-- build time:Sun Feb 19 2023 16:19:38 GMT+0800 (中国标准时间) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="putao" href="http://example.com/rss.xml"><link rel="alternate" type="application/atom+xml" title="putao" href="http://example.com/atom.xml"><link rel="alternate" type="application/json" title="putao" href="http://example.com/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><link rel="canonical" href="http://example.com/2022/07/21/match/CRYPTO%20CTF/"><title>CRYPTO CTF - 比赛 | Putao0v0 = putao</title><meta name="generator" content="Hexo 6.2.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">CRYPTO CTF</h1><div class="meta"><span class="item" title="创建时间：2022-07-21 00:00:00"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2022-07-21T00:00:00+08:00">2022-07-21</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>30k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>28 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Putao0v0</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://tva2.sinaimg.cn/large/d74c8da0ly8hb8uz32ahej21hb0u0q6v.jpg"></li><li class="item" data-background-image="https://tva2.sinaimg.cn/large/d74c8da0ly8hb8v9b962oj20u01dq42c.jpg"></li><li class="item" data-background-image="https://tva2.sinaimg.cn/large/d74c8da0ly8hb8v0aair6j21900u0whx.jpg"></li><li class="item" data-background-image="https://tva2.sinaimg.cn/large/d74c8da0ly8hb8ux7p9nsj21a20u0tdu.jpg"></li><li class="item" data-background-image="https://tva2.sinaimg.cn/large/d74c8da0ly8hb8v99qwyvj21400u0422.jpg"></li><li class="item" data-background-image="https://tva2.sinaimg.cn/large/d74c8da0ly8hb8v9d2rbkj21900u0n5b.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/match/" itemprop="item" rel="index" title="分类于 比赛"><span itemprop="name">比赛</span></a><meta itemprop="position" content="1"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="http://example.com/2022/07/21/match/CRYPTO%20CTF/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/1.jpg"><meta itemprop="name" content="Putao0v0"><meta itemprop="description" content=", "></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="putao"></span><div class="body md" itemprop="articleBody"><h1 id="klamkin"><a class="anchor" href="#klamkin">#</a> Klamkin</h1><h2 id="题目"><a class="anchor" href="#题目">#</a> 题目</h2><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token operator">|</span>  Hello<span class="token punctuation">,</span> now we are finding the integer solution of two divisibility  <span class="token operator">|</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token operator">|</span>  relation<span class="token punctuation">.</span> In each stage send the requested solution<span class="token punctuation">.</span> Have fun <span class="token punctuation">:</span><span class="token punctuation">)</span>    <span class="token operator">|</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span><span class="token operator">|</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token operator">|</span> We know <span class="token punctuation">(</span>ax <span class="token operator">+</span> by<span class="token punctuation">)</span> <span class="token operator">%</span> q <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">for</span> <span class="token builtin">any</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> such that <span class="token punctuation">(</span>ar <span class="token operator">+</span> bs<span class="token punctuation">)</span> <span class="token operator">%</span> q <span class="token operator">=</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token operator">|</span> <span class="token keyword">and</span> <span class="token punctuation">(</span>q<span class="token punctuation">,</span> r<span class="token punctuation">,</span> s<span class="token punctuation">)</span> are given!</pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token operator">|</span> Options<span class="token punctuation">:</span> </pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token operator">|</span>	<span class="token punctuation">[</span>G<span class="token punctuation">]</span>et the parameters </pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token operator">|</span>	<span class="token punctuation">[</span>S<span class="token punctuation">]</span>end solution </pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token operator">|</span>	<span class="token punctuation">[</span>Q<span class="token punctuation">]</span>uit</pre></td></tr><tr><td data-num="11"></td><td><pre>S</pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token operator">|</span> please send requested solution like x<span class="token punctuation">,</span> y such that y <span class="token keyword">is</span> <span class="token number">12</span><span class="token operator">-</span>bit<span class="token punctuation">:</span></pre></td></tr></table></figure><p>先求出 10 个 a，b</p><p>然后看他要求几位的 x 或 y</p><p>在 check 一下</p><h2 id="exp"><a class="anchor" href="#exp">#</a> exp</h2><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> random</pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre>q <span class="token operator">=</span> <span class="token number">187664899777679218903377367769149423927</span></pre></td></tr><tr><td data-num="6"></td><td><pre>r <span class="token operator">=</span> <span class="token number">62883771665086813542392383956133061422</span></pre></td></tr><tr><td data-num="7"></td><td><pre>s <span class="token operator">=</span> <span class="token number">42242585173255963334352283606980757549</span></pre></td></tr><tr><td data-num="8"></td><td><pre>ass<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="9"></td><td><pre>bs<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    a <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    b <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">-</span> a <span class="token operator">*</span> r<span class="token punctuation">)</span> <span class="token operator">*</span> inverse<span class="token punctuation">(</span>s<span class="token punctuation">,</span> q<span class="token punctuation">)</span> <span class="token operator">%</span> q</pre></td></tr><tr><td data-num="13"></td><td><pre>    ass<span class="token punctuation">.</span>append<span class="token punctuation">(</span>a<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    bs<span class="token punctuation">.</span>append<span class="token punctuation">(</span>b<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    y <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">17</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    x <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">-</span> bs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> y<span class="token punctuation">)</span> <span class="token operator">*</span> inverse<span class="token punctuation">(</span>ass<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">)</span> <span class="token operator">%</span> q</pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token comment">#x=getPrime(12)</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token comment">#y=(-ass[0]*a)*inverse(bs[0],q)%q</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    flag<span class="token operator">=</span><span class="token number">1</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="22"></td><td><pre>        <span class="token keyword">if</span><span class="token punctuation">(</span>ass<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">*</span>x<span class="token operator">+</span>bs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">*</span>y<span class="token punctuation">)</span><span class="token operator">%</span>q<span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="23"></td><td><pre>            flag<span class="token operator">=</span><span class="token number">0</span></pre></td></tr><tr><td data-num="24"></td><td><pre>            <span class="token keyword">break</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span>flag<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="26"></td><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="27"></td><td><pre>        <span class="token keyword">break</span></pre></td></tr><tr><td data-num="28"></td><td><pre></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token comment">#CCTF&#123;f1nDin9_In7Eg3R_50Lut1Ons_iZ_in73rEStIn9!&#125;</span></pre></td></tr></table></figure><h1 id="baphomet"><a class="anchor" href="#baphomet">#</a> Baphomet</h1><h2 id="题目-2"><a class="anchor" href="#题目-2">#</a> 题目</h2><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#!/usr/bin/env python3</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> base64 <span class="token keyword">import</span> b64encode</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">from</span> flag <span class="token keyword">import</span> flag</pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">def</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="7"></td><td><pre>	ba <span class="token operator">=</span> b64encode<span class="token punctuation">(</span>msg<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>	baph<span class="token punctuation">,</span> key <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token string">''</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>	<span class="token keyword">for</span> b <span class="token keyword">in</span> ba<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="11"></td><td><pre>		<span class="token keyword">if</span> b<span class="token punctuation">.</span>islower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="12"></td><td><pre>			baph <span class="token operator">+=</span> b<span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre>			key <span class="token operator">+=</span> <span class="token string">'0'</span></pre></td></tr><tr><td data-num="14"></td><td><pre>		<span class="token keyword">else</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="15"></td><td><pre>			baph <span class="token operator">+=</span> b<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre>			key <span class="token operator">+=</span> <span class="token string">'1'</span></pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre>	baph <span class="token operator">=</span> baph<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="19"></td><td><pre>	key <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to_bytes<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">'big'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre></pre></td></tr><tr><td data-num="21"></td><td><pre>	enc <span class="token operator">=</span> <span class="token string">b''</span></pre></td></tr><tr><td data-num="22"></td><td><pre>	<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>baph<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="23"></td><td><pre>		enc <span class="token operator">+=</span> <span class="token punctuation">(</span>baph<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> key<span class="token punctuation">[</span>i <span class="token operator">%</span> <span class="token builtin">len</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to_bytes<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'big'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre></pre></td></tr><tr><td data-num="25"></td><td><pre>	<span class="token keyword">return</span> enc</pre></td></tr><tr><td data-num="26"></td><td><pre></pre></td></tr><tr><td data-num="27"></td><td><pre>enc <span class="token operator">=</span> encrypt<span class="token punctuation">(</span>flag<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="28"></td><td><pre>f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'flag.enc'</span><span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="29"></td><td><pre>f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>enc<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="30"></td><td><pre>f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><blockquote><p>将 flag base64 加密之后大小写转换再与 key 异或</p></blockquote><p>enc 是 48 位 所以 key 是 6 位</p><p>flag 以 <code>CCTF&#123;</code> 开头</p><p>base64 之后刚好 6 位固定</p><p>可以求出 key</p><p>即可得 base64 加密之后的密文</p><h2 id="exp-2"><a class="anchor" href="#exp-2">#</a> exp</h2><figure class="highlight py"><figcaption data-lang="Python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"flag.enc"</span><span class="token punctuation">,</span><span class="token string">"rb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    a<span class="token operator">=</span>f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre>key<span class="token operator">=</span><span class="token string">b'q0nurN'</span></pre></td></tr><tr><td data-num="4"></td><td><pre>k<span class="token operator">=</span><span class="token string">b''</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    k<span class="token operator">+=</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> key<span class="token punctuation">[</span>i <span class="token operator">%</span> <span class="token builtin">len</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to_bytes<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'big'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>c<span class="token operator">=</span><span class="token string">b''</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    c<span class="token operator">+=</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> k<span class="token punctuation">[</span>i <span class="token operator">%</span> <span class="token builtin">len</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to_bytes<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'big'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>x<span class="token operator">=</span><span class="token string">''</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> c<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token keyword">if</span> i<span class="token punctuation">.</span>islower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        x<span class="token operator">+=</span>i<span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token keyword">else</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        x<span class="token operator">+=</span>i<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token keyword">from</span> base64 <span class="token keyword">import</span> b64decode</pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>b64decode<span class="token punctuation">(</span>x<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h1 id="sots"><a class="anchor" href="#sots">#</a> SOTS</h1><h2 id="题目-3"><a class="anchor" href="#题目-3">#</a> 题目</h2><p>给出两个数的平方的和求这两个数</p><p>这个网站解一下</p><p><span class="exturl" data-url="aHR0cHM6Ly93d3cuYWxwZXJ0cm9uLmNvbS5hci9FQ00uSFRN">https://www.alpertron.com.ar/ECM.HTM</span></p><p><code>CCTF&#123;3Xpr3sS_4z_Th3_sUm_oF_7w0_Squ4rE5!&#125;</code></p><h1 id="polyrsa"><a class="anchor" href="#polyrsa">#</a> polyRSA</h1><h2 id="题目-4"><a class="anchor" href="#题目-4">#</a> 题目</h2><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#!/usr/bin/env python3</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">from</span> flag <span class="token keyword">import</span> flag</pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">def</span> <span class="token function">keygen</span><span class="token punctuation">(</span>nbit <span class="token operator">=</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="7"></td><td><pre>	<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="8"></td><td><pre>		k <span class="token operator">=</span> getRandomNBitInteger<span class="token punctuation">(</span>nbit<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>		p <span class="token operator">=</span> k<span class="token operator">**</span><span class="token number">6</span> <span class="token operator">+</span> <span class="token number">7</span><span class="token operator">*</span>k<span class="token operator">**</span><span class="token number">4</span> <span class="token operator">-</span> <span class="token number">40</span><span class="token operator">*</span>k<span class="token operator">**</span><span class="token number">3</span> <span class="token operator">+</span> <span class="token number">12</span><span class="token operator">*</span>k<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">-</span> <span class="token number">114</span><span class="token operator">*</span>k <span class="token operator">+</span> <span class="token number">31377</span></pre></td></tr><tr><td data-num="10"></td><td><pre>		q <span class="token operator">=</span> k<span class="token operator">**</span><span class="token number">5</span> <span class="token operator">-</span> <span class="token number">8</span><span class="token operator">*</span>k<span class="token operator">**</span><span class="token number">4</span> <span class="token operator">+</span> <span class="token number">19</span><span class="token operator">*</span>k<span class="token operator">**</span><span class="token number">3</span> <span class="token operator">-</span> <span class="token number">313</span><span class="token operator">*</span>k<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">-</span> <span class="token number">14</span><span class="token operator">*</span>k <span class="token operator">+</span> <span class="token number">14011</span></pre></td></tr><tr><td data-num="11"></td><td><pre>		<span class="token keyword">if</span> isPrime<span class="token punctuation">(</span>p<span class="token punctuation">)</span> <span class="token keyword">and</span> isPrime<span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="12"></td><td><pre>			<span class="token keyword">return</span> p<span class="token punctuation">,</span> q</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">def</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>msg<span class="token punctuation">,</span> n<span class="token punctuation">,</span> e <span class="token operator">=</span> <span class="token number">31337</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="15"></td><td><pre>	m <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>msg<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre>	<span class="token keyword">return</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre>p<span class="token punctuation">,</span> q <span class="token operator">=</span> keygen<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="19"></td><td><pre>n <span class="token operator">=</span> p <span class="token operator">*</span> q</pre></td></tr><tr><td data-num="20"></td><td><pre>enc <span class="token operator">=</span> encrypt<span class="token punctuation">(</span>flag<span class="token punctuation">,</span> n<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'n = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>n<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'enc = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>enc<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>解方程就行</p><h2 id="exp-3"><a class="anchor" href="#exp-3">#</a> exp</h2><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#sage</span></pre></td></tr><tr><td data-num="2"></td><td><pre>var<span class="token punctuation">(</span><span class="token string">'k'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre>p <span class="token operator">=</span> k<span class="token operator">**</span><span class="token number">6</span> <span class="token operator">+</span> <span class="token number">7</span><span class="token operator">*</span>k<span class="token operator">**</span><span class="token number">4</span> <span class="token operator">-</span> <span class="token number">40</span><span class="token operator">*</span>k<span class="token operator">**</span><span class="token number">3</span> <span class="token operator">+</span> <span class="token number">12</span><span class="token operator">*</span>k<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">-</span> <span class="token number">114</span><span class="token operator">*</span>k <span class="token operator">+</span> <span class="token number">31377</span></pre></td></tr><tr><td data-num="4"></td><td><pre>q <span class="token operator">=</span> k<span class="token operator">**</span><span class="token number">5</span> <span class="token operator">-</span> <span class="token number">8</span><span class="token operator">*</span>k<span class="token operator">**</span><span class="token number">4</span> <span class="token operator">+</span> <span class="token number">19</span><span class="token operator">*</span>k<span class="token operator">**</span><span class="token number">3</span> <span class="token operator">-</span> <span class="token number">313</span><span class="token operator">*</span>k<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">-</span> <span class="token number">14</span><span class="token operator">*</span>k <span class="token operator">+</span> <span class="token number">14011</span></pre></td></tr><tr><td data-num="5"></td><td><pre>n<span class="token operator">=</span><span class="token number">44538727182858207226040251762322467288176239968967952269350336889655421753182750730773886813281253762528207970314694060562016861614492626112150259048393048617529867598499261392152098087985858905944606287003243</span></pre></td></tr><tr><td data-num="6"></td><td><pre>solve<span class="token punctuation">(</span><span class="token punctuation">[</span>p<span class="token operator">*</span>q<span class="token operator">==</span>n<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment">#python</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>n <span class="token operator">=</span> <span class="token number">44538727182858207226040251762322467288176239968967952269350336889655421753182750730773886813281253762528207970314694060562016861614492626112150259048393048617529867598499261392152098087985858905944606287003243</span></pre></td></tr><tr><td data-num="13"></td><td><pre>c <span class="token operator">=</span> <span class="token number">37578889436345667053409195986387874079577521081198523844555524501835825138236698001996990844798291201187483119265306641889824719989940722147655181198458261772053545832559971159703922610578530282146835945192532</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre>e <span class="token operator">=</span> <span class="token number">31337</span></pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre>k <span class="token operator">=</span> <span class="token number">9291098683758154336</span></pre></td></tr><tr><td data-num="19"></td><td><pre>p <span class="token operator">=</span> k<span class="token operator">**</span><span class="token number">6</span> <span class="token operator">+</span> <span class="token number">7</span><span class="token operator">*</span>k<span class="token operator">**</span><span class="token number">4</span> <span class="token operator">-</span> <span class="token number">40</span><span class="token operator">*</span>k<span class="token operator">**</span><span class="token number">3</span> <span class="token operator">+</span> <span class="token number">12</span><span class="token operator">*</span>k<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">-</span> <span class="token number">114</span><span class="token operator">*</span>k <span class="token operator">+</span> <span class="token number">31377</span></pre></td></tr><tr><td data-num="20"></td><td><pre>q <span class="token operator">=</span> k<span class="token operator">**</span><span class="token number">5</span> <span class="token operator">-</span> <span class="token number">8</span><span class="token operator">*</span>k<span class="token operator">**</span><span class="token number">4</span> <span class="token operator">+</span> <span class="token number">19</span><span class="token operator">*</span>k<span class="token operator">**</span><span class="token number">3</span> <span class="token operator">-</span> <span class="token number">313</span><span class="token operator">*</span>k<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">-</span> <span class="token number">14</span><span class="token operator">*</span>k <span class="token operator">+</span> <span class="token number">14011</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token keyword">assert</span> p <span class="token operator">*</span> q <span class="token operator">==</span> n</pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre>phi <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre>d <span class="token operator">=</span> inverse<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="25"></td><td><pre>m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="26"></td><td><pre>flag <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span></pre></td></tr></table></figure><h1 id="infinity-castle"><a class="anchor" href="#infinity-castle">#</a> Infinity castle</h1><h2 id="题目-5"><a class="anchor" href="#题目-5">#</a> 题目</h2><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#!/usr/bin/env python3</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">from</span> os <span class="token keyword">import</span> urandom</pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">TaylorSeries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre>	<span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> order<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="9"></td><td><pre>		self<span class="token punctuation">.</span>order <span class="token operator">=</span> order</pre></td></tr><tr><td data-num="10"></td><td><pre>		</pre></td></tr><tr><td data-num="11"></td><td><pre>	<span class="token keyword">def</span> <span class="token function">coefficient</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="12"></td><td><pre>		i <span class="token operator">=</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="13"></td><td><pre>		coef <span class="token operator">=</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="14"></td><td><pre>		<span class="token keyword">while</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="15"></td><td><pre>			i <span class="token operator">+=</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="16"></td><td><pre>			coef <span class="token operator">*=</span> <span class="token punctuation">(</span>coef <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">/</span><span class="token number">2</span><span class="token operator">-</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> i</pre></td></tr><tr><td data-num="17"></td><td><pre>		<span class="token keyword">return</span> coef</pre></td></tr><tr><td data-num="18"></td><td><pre></pre></td></tr><tr><td data-num="19"></td><td><pre>	<span class="token keyword">def</span> <span class="token function">find</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> center<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="20"></td><td><pre>		<span class="token builtin">sum</span> <span class="token operator">=</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="21"></td><td><pre>		center <span class="token operator">-=</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="22"></td><td><pre>		i <span class="token operator">=</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="23"></td><td><pre>		<span class="token keyword">while</span> i <span class="token operator">&lt;</span> self<span class="token punctuation">.</span>order<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="24"></td><td><pre>			<span class="token builtin">sum</span> <span class="token operator">+=</span> <span class="token punctuation">(</span>center<span class="token operator">**</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">/</span><span class="token number">2</span><span class="token operator">-</span>i<span class="token punctuation">)</span> <span class="token operator">*</span> self<span class="token punctuation">.</span>coefficient<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="25"></td><td><pre>			i <span class="token operator">+=</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="26"></td><td><pre>		<span class="token keyword">return</span> <span class="token builtin">sum</span></pre></td></tr><tr><td data-num="27"></td><td><pre></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token keyword">def</span> <span class="token function">xor</span><span class="token punctuation">(</span>cip<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="29"></td><td><pre>	repeation <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>cip<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token builtin">len</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="30"></td><td><pre>	key <span class="token operator">=</span> key <span class="token operator">*</span> repeation</pre></td></tr><tr><td data-num="31"></td><td><pre>	key <span class="token operator">=</span> key<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token builtin">len</span><span class="token punctuation">(</span>cip<span class="token punctuation">)</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="32"></td><td><pre>	</pre></td></tr><tr><td data-num="33"></td><td><pre>	msg <span class="token operator">=</span> <span class="token builtin">bytes</span><span class="token punctuation">(</span><span class="token punctuation">[</span>c <span class="token operator">^</span> k <span class="token keyword">for</span> c<span class="token punctuation">,</span> k <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>cip<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="34"></td><td><pre>	<span class="token keyword">return</span> msg</pre></td></tr><tr><td data-num="35"></td><td><pre></pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token comment"># If you run these 3 functions (diamond, triage, summarize) with big numbers, they will never end</span></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token comment"># You need to optimize them first</span></pre></td></tr><tr><td data-num="38"></td><td><pre></pre></td></tr><tr><td data-num="39"></td><td><pre><span class="token keyword">def</span> <span class="token function">diamond</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="40"></td><td><pre>	output <span class="token operator">=</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="41"></td><td><pre>	<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="42"></td><td><pre>		output <span class="token operator">+=</span> i<span class="token operator">*</span><span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="43"></td><td><pre>	<span class="token keyword">return</span> output</pre></td></tr><tr><td data-num="44"></td><td><pre></pre></td></tr><tr><td data-num="45"></td><td><pre><span class="token keyword">def</span> <span class="token function">triage</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="46"></td><td><pre>	output <span class="token operator">=</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="47"></td><td><pre>	index <span class="token operator">=</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="48"></td><td><pre>	<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="49"></td><td><pre>		output <span class="token operator">+=</span> <span class="token punctuation">(</span>i<span class="token operator">+</span>index<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">6</span> <span class="token operator">+</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="50"></td><td><pre>		index <span class="token operator">+=</span> i</pre></td></tr><tr><td data-num="51"></td><td><pre>	<span class="token keyword">return</span> output</pre></td></tr><tr><td data-num="52"></td><td><pre></pre></td></tr><tr><td data-num="53"></td><td><pre><span class="token keyword">def</span> <span class="token function">summarize</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="54"></td><td><pre>	order <span class="token operator">=</span> getRandomRange<span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="55"></td><td><pre>	t <span class="token operator">=</span> TaylorSeries<span class="token punctuation">(</span>order<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="56"></td><td><pre>	output <span class="token operator">=</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="57"></td><td><pre>	</pre></td></tr><tr><td data-num="58"></td><td><pre>	i <span class="token operator">=</span> <span class="token number">2</span></pre></td></tr><tr><td data-num="59"></td><td><pre>	<span class="token keyword">while</span> i <span class="token operator">&lt;</span> b<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="60"></td><td><pre>		b1 <span class="token operator">=</span> t<span class="token punctuation">.</span>find<span class="token punctuation">(</span>i<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="61"></td><td><pre>		b2 <span class="token operator">=</span> t<span class="token punctuation">.</span>find<span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="62"></td><td><pre>		output <span class="token operator">+=</span> <span class="token punctuation">(</span>b1<span class="token operator">+</span>b2<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span></pre></td></tr><tr><td data-num="63"></td><td><pre>		i <span class="token operator">+=</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="64"></td><td><pre>	<span class="token keyword">return</span> output</pre></td></tr><tr><td data-num="65"></td><td><pre></pre></td></tr><tr><td data-num="66"></td><td><pre>KEY_SIZE <span class="token operator">=</span> <span class="token number">2048</span></pre></td></tr><tr><td data-num="67"></td><td><pre>p<span class="token punctuation">,</span> q <span class="token operator">=</span> <span class="token punctuation">[</span>getPrime<span class="token punctuation">(</span>KEY_SIZE<span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token string">'01'</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="68"></td><td><pre></pre></td></tr><tr><td data-num="69"></td><td><pre>e<span class="token punctuation">,</span> n <span class="token operator">=</span> <span class="token number">0x10001</span><span class="token punctuation">,</span> p<span class="token operator">*</span>q</pre></td></tr><tr><td data-num="70"></td><td><pre></pre></td></tr><tr><td data-num="71"></td><td><pre>f <span class="token operator">=</span> <span class="token builtin">open</span> <span class="token punctuation">(</span><span class="token string">'./message.txt'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="72"></td><td><pre>message <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="73"></td><td><pre>f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="74"></td><td><pre>msg_length <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="75"></td><td><pre>padded_msg <span class="token operator">=</span> message <span class="token operator">+</span> urandom<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> msg_length<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="76"></td><td><pre>padded_msg_length <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>padded_msg<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="77"></td><td><pre></pre></td></tr><tr><td data-num="78"></td><td><pre>xor_key <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>summarize<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span>padded_msg_length<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="79"></td><td><pre><span class="token keyword">assert</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>xor_key<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">512</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="80"></td><td><pre></pre></td></tr><tr><td data-num="81"></td><td><pre>enc0 <span class="token operator">=</span> xor<span class="token punctuation">(</span>padded_msg<span class="token punctuation">,</span> xor_key<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="82"></td><td><pre><span class="token keyword">assert</span><span class="token punctuation">(</span>bytes_to_long<span class="token punctuation">(</span>enc0<span class="token punctuation">)</span> <span class="token operator">&lt;</span> n<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="83"></td><td><pre></pre></td></tr><tr><td data-num="84"></td><td><pre>c0 <span class="token operator">=</span>  <span class="token builtin">abs</span><span class="token punctuation">(</span>diamond<span class="token punctuation">(</span>p<span class="token punctuation">)</span> <span class="token operator">-</span> diamond<span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="85"></td><td><pre>c1 <span class="token operator">=</span>  triage<span class="token punctuation">(</span>p<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="86"></td><td><pre>c1 <span class="token operator">+=</span> <span class="token number">3</span><span class="token operator">*</span>n<span class="token operator">*</span><span class="token punctuation">(</span>p<span class="token operator">+</span>q<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="87"></td><td><pre>c1 <span class="token operator">+=</span> triage<span class="token punctuation">(</span>q<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="88"></td><td><pre></pre></td></tr><tr><td data-num="89"></td><td><pre>m <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>enc0<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="90"></td><td><pre>enc1 <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="91"></td><td><pre></pre></td></tr><tr><td data-num="92"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"c0 = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>c0<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="93"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"c1 = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>c1<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="94"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"enc = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>enc1<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>先看函数</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">def</span> <span class="token function">diamond</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>	output <span class="token operator">=</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="3"></td><td><pre>	<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="4"></td><td><pre>		output <span class="token operator">+=</span> i<span class="token operator">*</span><span class="token number">2</span> <span class="token operator">+</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="5"></td><td><pre>	<span class="token keyword">return</span> output</pre></td></tr></table></figure><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>i</mi><mi>a</mi><mi>m</mi><mi>o</mi><mi>n</mi><mi>d</mi><mo stretchy="false">(</mo><mi>n</mi><mi>u</mi><mi>m</mi><mo stretchy="false">)</mo><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msubsup><mn>2</mn><mi>i</mi><mo>+</mo><mn>1</mn><mo>=</mo><msup><mi>n</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">diamond(num)=\sum \limits_{i=0}^{n-1}2i+1=n^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">a</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.478782em;vertical-align:-.9776689999999999em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5011130000000001em"><span style="top:-2.122331em;margin-left:0"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.0000050000000003em"><span class="pstrut" style="height:3em"></span><span><span class="mop op-symbol small-op">∑</span></span></span><span style="top:-3.950005em;margin-left:0"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.9776689999999999em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">2</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8141079999999999em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">def</span> <span class="token function">triage</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>	output <span class="token operator">=</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="3"></td><td><pre>	index <span class="token operator">=</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="4"></td><td><pre>	<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre>		output <span class="token operator">+=</span> <span class="token punctuation">(</span>i<span class="token operator">+</span>index<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">6</span> <span class="token operator">+</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="6"></td><td><pre>		index <span class="token operator">+=</span> i</pre></td></tr><tr><td data-num="7"></td><td><pre>	<span class="token keyword">return</span> output</pre></td></tr></table></figure><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mi>r</mi><mi>i</mi><mi>a</mi><mi>g</mi><mi>e</mi><mo stretchy="false">(</mo><mi>n</mi><mi>u</mi><mi>m</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>n</mi><mn>3</mn></msup></mrow><annotation encoding="application/x-tex">triage(num)=n^3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mord mathnormal">i</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:.03588em">g</span><span class="mord mathnormal">e</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8141079999999999em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span></span></span></p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">def</span> <span class="token function">summarize</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>	order <span class="token operator">=</span> getRandomRange<span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre>	t <span class="token operator">=</span> TaylorSeries<span class="token punctuation">(</span>order<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre>	output <span class="token operator">=</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="5"></td><td><pre>	</pre></td></tr><tr><td data-num="6"></td><td><pre>	i <span class="token operator">=</span> <span class="token number">2</span></pre></td></tr><tr><td data-num="7"></td><td><pre>	<span class="token keyword">while</span> i <span class="token operator">&lt;</span> b<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="8"></td><td><pre>		b1 <span class="token operator">=</span> t<span class="token punctuation">.</span>find<span class="token punctuation">(</span>i<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>		b2 <span class="token operator">=</span> t<span class="token punctuation">.</span>find<span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>		output <span class="token operator">+=</span> <span class="token punctuation">(</span>b1<span class="token operator">+</span>b2<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span></pre></td></tr><tr><td data-num="11"></td><td><pre>		i <span class="token operator">+=</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="12"></td><td><pre>	<span class="token keyword">return</span> output</pre></td></tr></table></figure><p 2="">summarize(b)=\sum \limits^{n-1}_{i=2}\frac{f(i)+f(i+1)}</p><blockquote><p>class TaylorSeries()</p></blockquote><p>这个是泰勒级数</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mn>0</mn></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">a_0=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub><mo>=</mo><mfrac><mrow><mn>1</mn><mi mathvariant="normal">/</mi><mn>2</mn><mo>−</mo><mi>i</mi><mo>+</mo><mn>1</mn></mrow><mi>i</mi></mfrac><msubsup><mi>a</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">a_i=\frac{1/2-i+1}{i}a_{i-1}^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.355em;vertical-align:-.345em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.485em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">/</span><span class="mord mtight">2</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.345em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-2.441336em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.316995em"><span></span></span></span></span></span></span></span></span></span></p><p>在这基础上定义函数 f</p><p 12-i="">f(x)=\sum \limits_{i=0}^{+ ∞ }a_i(x-1)^</p><p>我们得到</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mn>0</mn></msub><mo>=</mo><mi mathvariant="normal">∣</mi><mi>d</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mo>−</mo><mi>d</mi><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">c_0=|d(p)-d(q)|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">∣</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mclose">)</span><span class="mord">∣</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mn>1</mn></msub><mo>=</mo><mi>t</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mo>+</mo><mn>3</mn><mo>∗</mo><mi>n</mi><mo>∗</mo><mo stretchy="false">(</mo><mi>p</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><mi>t</mi><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">c_1=t(p)+3*n*(p+1)+t(q)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">3</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.46528em;vertical-align:0"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mclose">)</span></span></span></span></p><p>令 p&gt;q</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mn>0</mn></msub><mo>=</mo><mi mathvariant="normal">∣</mi><mi>d</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mo>−</mo><mi>d</mi><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo><mi mathvariant="normal">∣</mi><mo>=</mo><msup><mi>p</mi><mn>2</mn></msup><mo>−</mo><msup><mi>q</mi><mn>2</mn></msup><mo>=</mo><mo stretchy="false">(</mo><mi>p</mi><mo>+</mo><mi>q</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>p</mi><mo>−</mo><mi>q</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">c_0=|d(p)-d(q)|=p^2-q^2=(p+q)(p-q)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">∣</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mclose">)</span><span class="mord">∣</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mclose">)</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mn>1</mn></msub><mo>=</mo><mi>t</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mo>+</mo><mn>3</mn><mo>∗</mo><mi>n</mi><mo>∗</mo><mo stretchy="false">(</mo><mi>p</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><mi>t</mi><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>p</mi><mo>+</mo><mi>q</mi><msup><mo stretchy="false">)</mo><mn>3</mn></msup></mrow><annotation encoding="application/x-tex">c_1=t(p)+3*n*(p+1)+t(q)=(p+q)^3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">3</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.46528em;vertical-align:0"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.03588em">q</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span></span></span></p><p>可以求出 p，q</p><p>就可以求出 enc0 了</p><p>然后只要求得 key 就能求 flag</p><div class="note info"><p>大佬的思路</p><p><img data-src="https://www.zhihu.com/equation?tex=s%28n%29" alt="[公式]"> 可以看成是对 f 的梯形法积分。也就是</p><p><img data-src="https://www.zhihu.com/equation?tex=s%28n%29%3D%5Cint_%7B2%7D%5E%7Bn%7Df%28x%29%5Cmathrm%7Bd%7Dx" alt="[公式]"></p><p>所以关键还是要分析出<img data-src="https://www.zhihu.com/equation?tex=f%28n%29" alt="[公式]"> 是个啥玩意儿。主要就是弄清楚那个泰勒展开的系数是个啥。</p><p>经过一些尝试，发现<img data-src="https://www.zhihu.com/equation?tex=f%28n%29+%5Capprox+%5Csqrt%7Bn%7D" alt="[公式]">（证明留在后面），所以</p><p><img data-src="https://www.zhihu.com/equation?tex=s%28n%29+%3D+%5Cint_%7B2%7D%5E%7Bn%7D%7Bf%28x%29%5Cmathrm%7Bd%7Dx%7D+%3D+%5Cfrac%7B2%7D%7B3%7Dn%5E%7B3%2F2%7D+-+%5Cfrac%7B2%7D%7B3%7D+%5Ccdot+2%5E%7B3%2F2%7D" alt="[公式]"></p><p>所以也直接能求得<img data-src="https://www.zhihu.com/equation?tex=k" alt="[公式]"> 的值。</p></div><h2 id="exp-4"><a class="anchor" href="#exp-4">#</a> exp</h2><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="2"></td><td><pre>c0 <span class="token operator">=</span> <span class="token number">194487778980461745865921475300460852453586088781074246328543689440168930873549359227127363759885970436167330043371627413542337857082400024590112412164095470165662281502211335756288082198009158469871465280749846525326701136380764079685636158337203211609233704905784093776008350120607841177268965738426317288541638374141671346404729428158104872411498098187946543666987926130124245185069569476433120128275581891425551325847219504501925282012199947834686225770246801353666030075146469275695499044424390475398423700504158154044180028733800154044746648133536737830623670383925046006108348861714435567006327619892239876863209887013290251890513192375749866675256952802329688897844132157098061758362137357387787072005860610663777569670198971946904157425377235056152628515775755249828721767845990597859165193162537676147173896835503209596955703313430433124688537275895468076469102220355973904702901083642275544954262724054693167603475188412046722656788470695566949847884250306735314144182029335732280420629131990311054229665691517003924788583771265625694414774865289407885678238795596912006567817508035434074250123869676396153982762032750080222602796273083162627489526255501643913672882350236497429678928099868244687228703074267962827621792960</span></pre></td></tr><tr><td data-num="3"></td><td><pre>c1 <span class="token operator">=</span> <span class="token number">102325064080381160170299055162846304227217463467232681115953623386548494169967745781550171804781503102663445039561476870208178139548389771866145006535051362059443515034504958703659546162037904784821960707630188600064568878674788077706711506213779443920430038560373854184526850365974450688458342413544179732143225845085164110594063440979455274250021370090572731855665413325275414458572412561502408983107820534723804225765540316307539962199024757378469001612921489902325166003841336027940632451584642359132723894801946906069322200784708303615779699081247051006259449466759863245508473429631466831174013498995506423210088549372249221415401309493511477847517923201080509933268996867995533386571564898914042844521373220497356837599443280354679778455765441375957556266205953496871475611269965949025704864246188576674107448587696941054123618319505271195780178776338475090463487960063464172195337956577785477587755181298859587398321270677790915227557908728226236404532915215698698185501562405374498053670694387354757252731874312411228777004316623425843477845333936913444143768519959591070492639650368662529749434618783626718975406802741753688956961837855306815380844030665696781685152837849982159679122660714556706669865596780528277684800454866433826417980212164051043504955615794706595412705883261111953152250227679858538249797999044336210905975316421254442221408945203647754303635775048438188044803368249944201671941949138202928389951227347433255867504906597772044398973241425387514239164853656233776024571606159378910745571588836981735827902305330330946219857271646498602227088657739442867033212012876837654750348578740516798444734534291467314881324902354425889448102902750077077381896216130734894767553834949561471219923459897244690006643798812989271282475503126962274052192342840870308710338336817452628324667507548265612892611100350882163205858101959976</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token triple-quoted-string string">'''</span></pre></td></tr><tr><td data-num="5"></td><td><pre>#sage</pre></td></tr><tr><td data-num="6"></td><td><pre>var('p q')</pre></td></tr><tr><td data-num="7"></td><td><pre>solve([p^2-q^2==c0,(p+q)^3==c1],[p,q])</pre></td></tr><tr><td data-num="8"></td><td><pre>'''</pre></td></tr><tr><td data-num="9"></td><td><pre>p<span class="token operator">=</span><span class="token number">25465500595039564722385454268618341460440964303654692306893194812608651011894765148023201769023925823267446913594798724374078776058926548056279105656348138942211069695157129067986030357247987537066065195208337853580939616954961742954173270603234042184081995050125067398704045490448077961447418406856674045777724275017678698252609741079175784928310951915104807404003531834525200421059550762294584722178356010146438598799668537922242765662363844939035164178525445220653839693135494967926642943210917823981779895464411806829004306900926935124663285407830585204630912848783431051369106939431567473170247979142455819150893</span></pre></td></tr><tr><td data-num="10"></td><td><pre>q<span class="token operator">=</span><span class="token number">21307368246113800130311098641506744510559988209047095448061577734947715969121645982743962584143752085867914325394457857827478912559095766977509129246922499990951138184298921892924074303356650532229644986118338361761354192554363128824141104808606558539422865199413633150757655174985683830034245659632460363700309887626934298289805670092066041542014924213128271705967504359900458092855272034197878632989626323553684162988741101770565319360726673172671459797955787997515498457867020749156835947018833861229200382521269341946614058721285386773372009177934062994798868703374266787876752211055631019633581263575312198649933</span></pre></td></tr><tr><td data-num="11"></td><td><pre>enc <span class="token operator">=</span> <span class="token number">122235247669762131006183252122503937958296387791525458429403709404875223067116491817728568224832483391622109986550732469556761300197133827976956875865159629512476600711420561872409721582387803219651736262581445978042694384374119142613277808898398213602093802571586386354257378956087240174787723503606671543195193114158641301908622673736098768829071270132073818245595918660134745516367731595853832524328488074054536278197115937409643221809577554866060292157239061557708159310445977052686561229611117673473208278176118561352693319461471419694590218295911647368543698198762827636021268989705079848502749837879584394379300566277359149621932579222865430374652678738198451655509408564586496375811666876030847654260305392984710580761255795785508407844683687773983669843744274915862335181251050775093896006210092665809300090715190088851654138383362259256212093670748527819287681468901379286722214112321906917311154811516336259463356911326393701445497605365038857575515541024824906818473933597129846235905072394148879079996812146836910199111439031562946495046766063326815863624262541346543552652673629442370320109404700346028639853707278295255350982238521659924641921142615894039995513480511108116053798143154593343124822462519555715118822045</span></pre></td></tr><tr><td data-num="12"></td><td><pre>n<span class="token operator">=</span>p<span class="token operator">*</span>q</pre></td></tr><tr><td data-num="13"></td><td><pre>e<span class="token operator">=</span><span class="token number">65537</span></pre></td></tr><tr><td data-num="14"></td><td><pre>enc0<span class="token operator">=</span>long_to_bytes<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>enc<span class="token punctuation">,</span>inverse<span class="token punctuation">(</span>e<span class="token punctuation">,</span><span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>enc0<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token keyword">def</span> <span class="token function">xor</span><span class="token punctuation">(</span>cip<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    repeation <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>cip<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token builtin">len</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    key <span class="token operator">=</span> key <span class="token operator">*</span> repeation</pre></td></tr><tr><td data-num="21"></td><td><pre>    key <span class="token operator">=</span> key<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token builtin">len</span><span class="token punctuation">(</span>cip<span class="token punctuation">)</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre>    msg <span class="token operator">=</span> <span class="token builtin">bytes</span><span class="token punctuation">(</span><span class="token punctuation">[</span>c <span class="token operator">^</span> k <span class="token keyword">for</span> c<span class="token punctuation">,</span> k <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>cip<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token keyword">return</span> msg</pre></td></tr><tr><td data-num="25"></td><td><pre>key<span class="token operator">=</span>floor<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">/</span><span class="token number">3</span><span class="token operator">*</span><span class="token punctuation">(</span>n<span class="token operator">**</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">2</span><span class="token operator">**</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#python 用不了</span></pre></td></tr><tr><td data-num="26"></td><td><pre>key<span class="token operator">=</span>long_to_bytes<span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">512</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="27"></td><td><pre>m<span class="token operator">=</span> xor<span class="token punctuation">(</span>enc0<span class="token punctuation">,</span> key<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token comment">#b'Never heard of using taylor series and integral beside RSA?!\nBut there are always ways to make things complicated\n\nCCTF&#123;Mix1ng_c4lcUluS_w17h_Numb3r_The0Rry_S33ms_s7r0ng_cRyp70_Sch3m4!!&#125;\n\nWe compute integrals with just measuring the area with a little fraction, forget about tough works!\nGood luck with the rest of CryptoCTF2022\x9a\x92W\xcf\xa2dl\x1a\x91\x96\'\x88\xec\xfez\xcd\xc2\xe7\x0bC\x90\xa3\xc7\xe7U\xb4F\xa535V\x19\x9b\x9e\xd4\xf7\xe7X\x02\x19Y\x86\xfa\x9f\x0b!\x9a\xc1\xd2\xcayG\x8af/\x14\xef\xf9\x1d\xc2\x9a\xcb\x9da&#125;g8\xb8\\ 2~\xf3\xe3\xb6$\xb6i\x12\xd6\x82\xfac\x15\xeeVa[s\xa0S\x00y\x0c\x18\xc34\xbd\x96fd\xec\xcf\xb9\x02&lt;Q\x8b\xb8\x9d\xd5\xefDu\xda\xd2\xf0\xc6g\x97\xf8\x952\x0c\rs=\x19.\x11"\x08\x81\xe7*\x87\xb8\xbd>\x82\n~\xf7l,\tu\x96&#125;*\xab`\x17\xe7\xf4\xd7N^\xe3\xfe\xf3@\x1e\x1c\x15\xffC\xecVVr\xca\x8d\x03\xc5\xda\xd6\xbf=\xc6\x14+\xf2\x14N'</span></pre></td></tr></table></figure><h1 id="keydream"><a class="anchor" href="#keydream">#</a> Keydream</h1><h2 id="题目-6"><a class="anchor" href="#题目-6">#</a> 题目</h2><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#!/usr/bin/env python3</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">import</span> string</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">from</span> flag <span class="token keyword">import</span> flag</pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">def</span> <span class="token function">randstr</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="8"></td><td><pre>	rstr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span>string<span class="token punctuation">.</span>printable<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">62</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">'_'</span><span class="token punctuation">)</span><span class="token punctuation">[</span>getRandomRange<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">62</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="9"></td><td><pre>	<span class="token keyword">return</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>rstr<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">def</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>msg<span class="token punctuation">,</span> l<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="13"></td><td><pre>	<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="14"></td><td><pre>		rstr <span class="token operator">=</span> <span class="token string">'CCTF&#123;it_is_fake_flag_'</span> <span class="token operator">+</span> randstr<span class="token punctuation">(</span>l<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'_90OD_luCk___!!&#125;'</span></pre></td></tr><tr><td data-num="15"></td><td><pre>		p <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>rstr<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre>		q <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>rstr<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre>		<span class="token keyword">if</span> isPrime<span class="token punctuation">(</span>p<span class="token punctuation">)</span> <span class="token keyword">and</span> isPrime<span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="18"></td><td><pre>			n <span class="token operator">=</span> p <span class="token operator">*</span> q</pre></td></tr><tr><td data-num="19"></td><td><pre>			e<span class="token punctuation">,</span> m <span class="token operator">=</span> <span class="token number">65537</span><span class="token punctuation">,</span> bytes_to_long<span class="token punctuation">(</span>msg<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre>			c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="21"></td><td><pre>			<span class="token keyword">return</span> n<span class="token punctuation">,</span> c</pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre>n<span class="token punctuation">,</span> c <span class="token operator">=</span> encrypt<span class="token punctuation">(</span>flag<span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'n = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>n<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'c = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>c<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="27"></td><td><pre>n <span class="token operator">=</span> <span class="token number">23087202318856030774680571525957068827041569782431397956837104908189620961469336659300387982516148407611623358654041246574100274275974799587138270853364165853708786079644741407579091918180874935364024818882648063256767259283714592098555858095373381673229188828791636142379379969143042636324982275996627729079</span></pre></td></tr><tr><td data-num="28"></td><td><pre>c <span class="token operator">=</span> <span class="token number">3621516728616736303019716820373078604485184090642291670706733720518953475684497936351864366709813094154736213978864841551795776449242009307288704109630747654430068522939150168228783644831299534766861590666590062361030323441362406214182358585821009335369275098938212859113101297279381840308568293108965668609</span></pre></td></tr></table></figure><p>bytes_to_long 每一位是 2^8</p><p>a=97 aa=97*2^8+97</p><p>所以 p 和 q 的高位可以确定</p><h2 id="exp-5"><a class="anchor" href="#exp-5">#</a> exp</h2><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#sage</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="3"></td><td><pre>n <span class="token operator">=</span> <span class="token number">23087202318856030774680571525957068827041569782431397956837104908189620961469336659300387982516148407611623358654041246574100274275974799587138270853364165853708786079644741407579091918180874935364024818882648063256767259283714592098555858095373381673229188828791636142379379969143042636324982275996627729079</span></pre></td></tr><tr><td data-num="4"></td><td><pre>c <span class="token operator">=</span> <span class="token number">3621516728616736303019716820373078604485184090642291670706733720518953475684497936351864366709813094154736213978864841551795776449242009307288704109630747654430068522939150168228783644831299534766861590666590062361030323441362406214182358585821009335369275098938212859113101297279381840308568293108965668609</span></pre></td></tr><tr><td data-num="5"></td><td><pre>PR<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>e<span class="token operator">=</span><span class="token number">65537</span></pre></td></tr><tr><td data-num="7"></td><td><pre>a<span class="token operator">=</span><span class="token string">b'CCTF&#123;it_is_fake_flag_'</span></pre></td></tr><tr><td data-num="8"></td><td><pre>b<span class="token operator">=</span><span class="token string">b'0'</span><span class="token operator">*</span><span class="token number">27</span></pre></td></tr><tr><td data-num="9"></td><td><pre>c<span class="token operator">=</span><span class="token string">b'_90OD_luCk___!!&#125;'</span></pre></td></tr><tr><td data-num="10"></td><td><pre>f<span class="token operator">=</span>bytes_to_long<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span><span class="token operator">^</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token operator">+</span><span class="token builtin">len</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span>x<span class="token operator">*</span><span class="token number">2</span><span class="token operator">^</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token operator">*</span><span class="token builtin">len</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span>bytes_to_long<span class="token punctuation">(</span>c<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>f<span class="token operator">=</span>f<span class="token punctuation">.</span>monic<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>root<span class="token operator">=</span>f<span class="token punctuation">.</span>small_roots<span class="token punctuation">(</span>X<span class="token operator">=</span><span class="token number">2</span><span class="token operator">^</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>beta<span class="token operator">=</span><span class="token number">0.4</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre>p<span class="token operator">=</span>gcd<span class="token punctuation">(</span>ZZ<span class="token punctuation">(</span>f<span class="token punctuation">(</span>root<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>q<span class="token operator">=</span>n<span class="token operator">//</span>p</pre></td></tr><tr><td data-num="15"></td><td><pre>d<span class="token operator">=</span>inverse<span class="token punctuation">(</span>e<span class="token punctuation">,</span><span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token comment">#Congratz, the flag is: CCTF&#123;h0M3_m4dE_k3Y_Dr1vEn_CrYp7O_5ySTeM!&#125;</span></pre></td></tr></table></figure><h1 id="jeksign"><a class="anchor" href="#jeksign">#</a> Jeksign</h1><h2 id="题目-7"><a class="anchor" href="#题目-7">#</a> 题目</h2><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#!/usr/bin/env python3</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">from</span> secret <span class="token keyword">import</span> gensol<span class="token punctuation">,</span> nbit_gensol</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">from</span> flag <span class="token keyword">import</span> flag</pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre>m <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>a <span class="token operator">=</span> <span class="token number">1337</span></pre></td></tr><tr><td data-num="11"></td><td><pre>b <span class="token operator">=</span> <span class="token number">31337</span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">def</span> <span class="token function">die</span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="14"></td><td><pre>	pr<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre>	quit<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token keyword">def</span> <span class="token function">pr</span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="18"></td><td><pre>	s <span class="token operator">=</span> <span class="token string">" "</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="19"></td><td><pre>	sys<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>write<span class="token punctuation">(</span>s <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre>	sys<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>flush<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="21"></td><td><pre></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token keyword">def</span> <span class="token function">sc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="23"></td><td><pre>	<span class="token keyword">return</span> sys<span class="token punctuation">.</span>stdin<span class="token punctuation">.</span>readline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="26"></td><td><pre>	border <span class="token operator">=</span> <span class="token string">"|"</span></pre></td></tr><tr><td data-num="27"></td><td><pre>	pr<span class="token punctuation">(</span>border<span class="token operator">*</span><span class="token number">72</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="28"></td><td><pre>	pr<span class="token punctuation">(</span>border<span class="token punctuation">,</span> <span class="token string">"Welcome crypto guys! Here we are looking for the solution of special"</span><span class="token punctuation">,</span> border<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="29"></td><td><pre>	pr<span class="token punctuation">(</span>border<span class="token punctuation">,</span> <span class="token string">"Diophantine equation: 1337(z^4 - x^2) = 31337(y^2 - z^4) in natural "</span><span class="token punctuation">,</span> border<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="30"></td><td><pre>	pr<span class="token punctuation">(</span>border<span class="token punctuation">,</span> <span class="token string">"numbers, in each stage solve the equation in mentioned interval :)  "</span><span class="token punctuation">,</span> border<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="31"></td><td><pre>	pr<span class="token punctuation">(</span>border<span class="token operator">*</span><span class="token number">72</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="32"></td><td><pre></pre></td></tr><tr><td data-num="33"></td><td><pre>	STEP<span class="token punctuation">,</span> level <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">19</span></pre></td></tr><tr><td data-num="34"></td><td><pre></pre></td></tr><tr><td data-num="35"></td><td><pre>	<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="36"></td><td><pre>		p<span class="token punctuation">,</span> q <span class="token operator">=</span> nbit_gensol<span class="token punctuation">(</span><span class="token number">1337</span><span class="token punctuation">,</span> <span class="token number">31337</span><span class="token punctuation">,</span> STEP <span class="token operator">+</span> <span class="token number">30</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="37"></td><td><pre>		x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z <span class="token operator">=</span> gensol<span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> p<span class="token punctuation">,</span> q<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="38"></td><td><pre>		pr<span class="token punctuation">(</span>border<span class="token punctuation">,</span> <span class="token string-interpolation"><span class="token string">f"Send a solution like `x, y, z' such that the `z' is </span><span class="token interpolation"><span class="token punctuation">&#123;</span>STEP <span class="token operator">+</span> <span class="token number">30</span><span class="token punctuation">&#125;</span></span><span class="token string">-bit: "</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="39"></td><td><pre>		ans <span class="token operator">=</span> sc<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="40"></td><td><pre>		<span class="token keyword">try</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="41"></td><td><pre>			X<span class="token punctuation">,</span> Y<span class="token punctuation">,</span> Z <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>_<span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> ans<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="42"></td><td><pre>			NBIT <span class="token operator">=</span> Z<span class="token punctuation">.</span>bit_length<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="43"></td><td><pre>		<span class="token keyword">except</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="44"></td><td><pre>			die<span class="token punctuation">(</span>border<span class="token punctuation">,</span> <span class="token string">'Your input is not valid, Bye!'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="45"></td><td><pre>		<span class="token keyword">if</span> <span class="token number">1337</span><span class="token operator">*</span><span class="token punctuation">(</span>Z<span class="token operator">**</span><span class="token number">4</span> <span class="token operator">-</span> X<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">31337</span><span class="token operator">*</span><span class="token punctuation">(</span>Y<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">-</span> Z<span class="token operator">**</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token keyword">and</span> NBIT <span class="token operator">==</span> STEP <span class="token operator">+</span> <span class="token number">30</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="46"></td><td><pre>			<span class="token keyword">if</span> STEP <span class="token operator">==</span> level <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="47"></td><td><pre>				die<span class="token punctuation">(</span>border<span class="token punctuation">,</span> <span class="token string-interpolation"><span class="token string">f'Congrats, you got the flag: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>flag<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="48"></td><td><pre>			<span class="token keyword">else</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="49"></td><td><pre>				pr<span class="token punctuation">(</span><span class="token string">'| good job, try to solve the next challenge :P'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="50"></td><td><pre>				STEP <span class="token operator">+=</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="51"></td><td><pre>		<span class="token keyword">else</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="52"></td><td><pre>			die<span class="token punctuation">(</span>border<span class="token punctuation">,</span> <span class="token string">'your answer is not correct, Bye!!'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="53"></td><td><pre></pre></td></tr><tr><td data-num="54"></td><td><pre><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="55"></td><td><pre>	main<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>求不定方程</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo stretchy="false">(</mo><msup><mi>z</mi><mn>4</mn></msup><mo>−</mo><msup><mi>x</mi><mn>2</mn></msup><mo stretchy="false">)</mo><mo>=</mo><mi>b</mi><mo stretchy="false">(</mo><msup><mi>y</mi><mn>2</mn></msup><mo>−</mo><msup><mi>z</mi><mn>4</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">a(z^4-x^2)=b(y^2-z^4)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-.25em"></span><span class="mord mathnormal">a</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:.04398em">z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-.25em"></span><span class="mord mathnormal">b</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.04398em">z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p><p>的正整数解，其中 a,b 已知。</p><p>给出的第 i 个解需要满足 z 为 i 比特整数。</p><p>首先把 z 都搬到一边</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mi>b</mi><msup><mi>y</mi><mn>2</mn></msup><mo>=</mo><mo stretchy="false">(</mo><mi>a</mi><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo><msup><mi>z</mi><mn>4</mn></msup></mrow><annotation encoding="application/x-tex">ax^2+by^2=(a+b)z^4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.897438em;vertical-align:-.08333em"></span><span class="mord mathnormal">a</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-.19444em"></span><span class="mord mathnormal">b</span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-.25em"></span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal" style="margin-right:.04398em">z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span></span></span></span></p><p>令<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mi>y</mi><mo>=</mo><msup><mi>z</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">x=y=z^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8141079999999999em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.04398em">z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></p><h2 id="exp-6"><a class="anchor" href="#exp-6">#</a> exp</h2><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="3"></td><td><pre>re<span class="token operator">=</span>remote<span class="token punctuation">(</span><span class="token string">"02.cr.yp.toc.tf"</span><span class="token punctuation">,</span><span class="token number">17113</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    re<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b"| Send a solution like `x, y, z' such that the `z' is "</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    a<span class="token operator">=</span>re<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    z<span class="token operator">=</span>getPrime<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    x<span class="token operator">=</span>z<span class="token operator">**</span><span class="token number">2</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    y<span class="token operator">=</span>x</pre></td></tr><tr><td data-num="10"></td><td><pre>    h<span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">', '</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">', '</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>z<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    re<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>h<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>re<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h1 id="volgo"><a class="anchor" href="#volgo">#</a> Volgo</h1><h2 id="题目-8"><a class="anchor" href="#题目-8">#</a> 题目</h2><p><span class="exturl" data-url="aHR0cDovLzAzLmNyLnlwLnRvYy50ZjoxMTExNy8=">http://03.cr.yp.toc.tf:11117/</span></p><p>M-209 的加密机器</p><p>搜了一下发现是博福特密码类似于维吉尼亚</p><p>随便输几个数</p><p>发现收尾是固定的</p><p>只要输 A*155 得到 key 的值</p><p>然后博福特解密就行</p><p><code>YOU KNOW HOW TO FORMAT FLAG JUST PUT UPCOMING LETTERS WITHIN CURLY BRACES FOLLOWED BY CCTF OOJMPMDDIXCLNNWFTEJUMFXKBRVVMOPSLSSLUTXVDVNDMYYPHPWFJRNJBVBOMUYR</code></p><h1 id="aniely"><a class="anchor" href="#aniely">#</a> Aniely</h1><h2 id="题目-9"><a class="anchor" href="#题目-9">#</a> 题目</h2><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#!/usr/bin/env python3</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> struct <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">from</span> os <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">from</span> secret <span class="token keyword">import</span> passphrase<span class="token punctuation">,</span> flag</pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">def</span> <span class="token function">aniely_stream</span><span class="token punctuation">(</span>passphrase<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="8"></td><td><pre>	<span class="token keyword">def</span> <span class="token function">mixer</span><span class="token punctuation">(</span>u<span class="token punctuation">,</span> v<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="9"></td><td><pre>		<span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>u <span class="token operator">&lt;&lt;</span> v<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span><span class="token punctuation">)</span> <span class="token operator">|</span> u <span class="token operator">>></span> <span class="token punctuation">(</span><span class="token number">32</span> <span class="token operator">-</span> v<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre>	<span class="token keyword">def</span> <span class="token function">forge</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="12"></td><td><pre>		<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="13"></td><td><pre>			w<span class="token punctuation">[</span>a<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>w<span class="token punctuation">[</span>a<span class="token punctuation">]</span> <span class="token operator">+</span> w<span class="token punctuation">[</span>b<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span></pre></td></tr><tr><td data-num="14"></td><td><pre>			w<span class="token punctuation">[</span>d<span class="token punctuation">]</span> <span class="token operator">=</span> mixer<span class="token punctuation">(</span>w<span class="token punctuation">[</span>a<span class="token punctuation">]</span> <span class="token operator">^</span> w<span class="token punctuation">[</span>d<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">16</span> <span class="token operator">//</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre>			w<span class="token punctuation">[</span>c<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>w<span class="token punctuation">[</span>c<span class="token punctuation">]</span> <span class="token operator">+</span> w<span class="token punctuation">[</span>d<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span></pre></td></tr><tr><td data-num="16"></td><td><pre>			w<span class="token punctuation">[</span>b<span class="token punctuation">]</span> <span class="token operator">=</span> mixer<span class="token punctuation">(</span>w<span class="token punctuation">[</span>b<span class="token punctuation">]</span> <span class="token operator">^</span> w<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">12</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token operator">*</span>i<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre>	bring <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">16</span></pre></td></tr><tr><td data-num="19"></td><td><pre>	bring<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0x61707865</span><span class="token punctuation">,</span> <span class="token number">0x3320646e</span><span class="token punctuation">,</span> <span class="token number">0x79622d32</span><span class="token punctuation">,</span> <span class="token number">0x6b206574</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="20"></td><td><pre>	bring<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">=</span> unpack<span class="token punctuation">(</span><span class="token string">'&lt;8L'</span><span class="token punctuation">,</span> passphrase<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="21"></td><td><pre>	bring<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">=</span> bring<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0x0</span></pre></td></tr><tr><td data-num="22"></td><td><pre>	bring<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">2</span></pre></td></tr><tr><td data-num="23"></td><td><pre></pre></td></tr><tr><td data-num="24"></td><td><pre>	<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="25"></td><td><pre>		w <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>bring<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="26"></td><td><pre>		<span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="27"></td><td><pre>			forge<span class="token punctuation">(</span>w<span class="token punctuation">,</span> <span class="token number">0x0</span><span class="token punctuation">,</span> <span class="token number">0x4</span><span class="token punctuation">,</span> <span class="token number">0x8</span><span class="token punctuation">,</span> <span class="token number">0xc</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="28"></td><td><pre>			forge<span class="token punctuation">(</span>w<span class="token punctuation">,</span> <span class="token number">0x1</span><span class="token punctuation">,</span> <span class="token number">0x5</span><span class="token punctuation">,</span> <span class="token number">0x9</span><span class="token punctuation">,</span> <span class="token number">0xd</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="29"></td><td><pre>			forge<span class="token punctuation">(</span>w<span class="token punctuation">,</span> <span class="token number">0x2</span><span class="token punctuation">,</span> <span class="token number">0x6</span><span class="token punctuation">,</span> <span class="token number">0xa</span><span class="token punctuation">,</span> <span class="token number">0xe</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="30"></td><td><pre>			forge<span class="token punctuation">(</span>w<span class="token punctuation">,</span> <span class="token number">0x3</span><span class="token punctuation">,</span> <span class="token number">0x7</span><span class="token punctuation">,</span> <span class="token number">0xb</span><span class="token punctuation">,</span> <span class="token number">0xf</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="31"></td><td><pre>			forge<span class="token punctuation">(</span>w<span class="token punctuation">,</span> <span class="token number">0x0</span><span class="token punctuation">,</span> <span class="token number">0x5</span><span class="token punctuation">,</span> <span class="token number">0xa</span><span class="token punctuation">,</span> <span class="token number">0xf</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="32"></td><td><pre>			forge<span class="token punctuation">(</span>w<span class="token punctuation">,</span> <span class="token number">0x1</span><span class="token punctuation">,</span> <span class="token number">0x6</span><span class="token punctuation">,</span> <span class="token number">0xb</span><span class="token punctuation">,</span> <span class="token number">0xc</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="33"></td><td><pre>			forge<span class="token punctuation">(</span>w<span class="token punctuation">,</span> <span class="token number">0x2</span><span class="token punctuation">,</span> <span class="token number">0x7</span><span class="token punctuation">,</span> <span class="token number">0x8</span><span class="token punctuation">,</span> <span class="token number">0xd</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="34"></td><td><pre>			forge<span class="token punctuation">(</span>w<span class="token punctuation">,</span> <span class="token number">0x3</span><span class="token punctuation">,</span> <span class="token number">0x4</span><span class="token punctuation">,</span> <span class="token number">0x9</span><span class="token punctuation">,</span> <span class="token number">0xe</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="35"></td><td><pre>		<span class="token keyword">for</span> c <span class="token keyword">in</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;16L'</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span>w<span class="token punctuation">[</span>_<span class="token punctuation">]</span> <span class="token operator">+</span> bring<span class="token punctuation">[</span>_<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="36"></td><td><pre>			<span class="token keyword">yield</span> c</pre></td></tr><tr><td data-num="37"></td><td><pre>		bring<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>bring<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span></pre></td></tr><tr><td data-num="38"></td><td><pre>		<span class="token keyword">if</span> bring<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="39"></td><td><pre>			bring<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>bring<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span></pre></td></tr><tr><td data-num="40"></td><td><pre></pre></td></tr><tr><td data-num="41"></td><td><pre><span class="token keyword">def</span> <span class="token function">aniely_encrypt</span><span class="token punctuation">(</span>msg<span class="token punctuation">,</span> passphrase<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="42"></td><td><pre>	<span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>passphrase<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">32</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="43"></td><td><pre>		passphrase <span class="token operator">=</span> <span class="token punctuation">(</span>passphrase <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">32</span> <span class="token operator">//</span> <span class="token builtin">len</span><span class="token punctuation">(</span>passphrase<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">32</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="44"></td><td><pre>	rand <span class="token operator">=</span> urandom<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">16</span></pre></td></tr><tr><td data-num="45"></td><td><pre>	<span class="token keyword">return</span> <span class="token builtin">bytes</span><span class="token punctuation">(</span>a <span class="token operator">^</span> b <span class="token operator">^</span> c <span class="token keyword">for</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>msg<span class="token punctuation">,</span> aniely_stream<span class="token punctuation">(</span>passphrase<span class="token punctuation">)</span><span class="token punctuation">,</span> rand<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="46"></td><td><pre></pre></td></tr><tr><td data-num="47"></td><td><pre>key <span class="token operator">=</span> <span class="token builtin">bytes</span><span class="token punctuation">(</span>a <span class="token operator">^</span> b <span class="token keyword">for</span> a<span class="token punctuation">,</span> b <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>passphrase<span class="token punctuation">,</span> flag<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="48"></td><td><pre>enc <span class="token operator">=</span> aniely_encrypt<span class="token punctuation">(</span>passphrase<span class="token punctuation">,</span> key<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="49"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'key = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>key<span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="50"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'enc = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>enc<span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>flag 和 passphrase 未知</p><p>key 和 enc 已知</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mi>e</mi><mi>y</mi><mo>=</mo><mi>p</mi><mi>a</mi><mi>s</mi><mi>s</mi><mi>p</mi><mi>h</mi><mi>r</mi><mi>a</mi><mi>s</mi><mi>e</mi><mo>⊕</mo><mi>f</mi><mi>l</mi><mi>a</mi><mi>g</mi></mrow><annotation encoding="application/x-tex">key=passphrase⊕flag</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">a</span><span class="mord mathnormal">s</span><span class="mord mathnormal">s</span><span class="mord mathnormal">p</span><span class="mord mathnormal">h</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mord mathnormal">a</span><span class="mord mathnormal">s</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:.03588em">g</span></span></span></span></p><p>要求 flag 就要求 passphrase</p><p>看加密函数</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mi>n</mi><mi>c</mi><mo>=</mo><mi>p</mi><mi>a</mi><mi>s</mi><mi>s</mi><mi>p</mi><mi>h</mi><mi>r</mi><mi>a</mi><mi>s</mi><mi>e</mi><mo>⊕</mo><mi>r</mi><mi>a</mi><mi>n</mi><mi>d</mi><mo>⊕</mo><mi>s</mi><mi>t</mi><mi>r</mi><mi>e</mi><mi>a</mi><mi>m</mi><mo stretchy="false">(</mo><mi>k</mi><mi>e</mi><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">enc=passphrase⊕rand⊕stream(key)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">a</span><span class="mord mathnormal">s</span><span class="mord mathnormal">s</span><span class="mord mathnormal">p</span><span class="mord mathnormal">h</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mord mathnormal">a</span><span class="mord mathnormal">s</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.77777em;vertical-align:-.08333em"></span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mord mathnormal">a</span><span class="mord mathnormal">n</span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mord mathnormal">e</span><span class="mord mathnormal">a</span><span class="mord mathnormal">m</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mclose">)</span></span></span></span></p><p>stream (key) 已知</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>a</mi><mi>s</mi><mi>s</mi><mi>p</mi><mi>h</mi><mi>r</mi><mi>a</mi><mi>s</mi><mi>e</mi><mo>⊕</mo><mi>r</mi><mi>a</mi><mi>n</mi><mi>d</mi><mo>=</mo><mi>e</mi><mi>n</mi><msup><mi>c</mi><mi>s</mi></msup><mi>t</mi><mi>e</mi><mi>a</mi><mi>m</mi><mo stretchy="false">(</mo><mi>k</mi><mi>e</mi><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">passphrase⊕rand=enc^steam(key)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">a</span><span class="mord mathnormal">s</span><span class="mord mathnormal">s</span><span class="mord mathnormal">p</span><span class="mord mathnormal">h</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mord mathnormal">a</span><span class="mord mathnormal">s</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mord mathnormal">a</span><span class="mord mathnormal">n</span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.664392em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span></span></span></span></span><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span><span class="mord mathnormal">a</span><span class="mord mathnormal">m</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mclose">)</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>l</mi><mi>l</mi><mo>=</mo><mi>k</mi><mi>e</mi><mi>y</mi><mo>⊕</mo><mi>p</mi><mi>a</mi><mi>s</mi><mi>s</mi><mi>p</mi><mi>h</mi><mi>r</mi><mi>a</mi><mi>s</mi><mi>e</mi><mo>⊕</mo><mi>r</mi><mi>a</mi><mi>n</mi><mi>d</mi><mo>=</mo><mi>p</mi><mi>a</mi><mi>s</mi><mi>s</mi><mi>p</mi><mi>h</mi><mi>r</mi><mi>a</mi><mi>s</mi><mi>e</mi><mo>⊕</mo><mi>f</mi><mi>l</mi><mi>a</mi><mi>g</mi><mo>⊕</mo><mi>p</mi><mi>a</mi><mi>s</mi><mi>s</mi><mi>p</mi><mi>h</mi><mi>r</mi><mi>a</mi><mi>s</mi><mi>e</mi><mo>⊕</mo><mi>r</mi><mi>a</mi><mi>n</mi><mi>d</mi><mo>=</mo><mi>f</mi><mi>l</mi><mi>a</mi><mi>g</mi><mo>⊕</mo><mi>r</mi><mi>a</mi><mi>n</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">lll=key⊕passphrase⊕rand=passphrase⊕flag⊕passphrase⊕rand=flag⊕rand</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathnormal" style="margin-right:.03148em">k</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">a</span><span class="mord mathnormal">s</span><span class="mord mathnormal">s</span><span class="mord mathnormal">p</span><span class="mord mathnormal">h</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mord mathnormal">a</span><span class="mord mathnormal">s</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mord mathnormal">a</span><span class="mord mathnormal">n</span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">a</span><span class="mord mathnormal">s</span><span class="mord mathnormal">s</span><span class="mord mathnormal">p</span><span class="mord mathnormal">h</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mord mathnormal">a</span><span class="mord mathnormal">s</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:.03588em">g</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">a</span><span class="mord mathnormal">s</span><span class="mord mathnormal">s</span><span class="mord mathnormal">p</span><span class="mord mathnormal">h</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mord mathnormal">a</span><span class="mord mathnormal">s</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mord mathnormal">a</span><span class="mord mathnormal">n</span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:.03588em">g</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mord mathnormal">a</span><span class="mord mathnormal">n</span><span class="mord mathnormal">d</span></span></span></span></p><p>flag 以 <code>CCTF&#123;</code> 开头</p><p>而 rand 为 2 位重复 16 次</p><p><code>C</code> ⊕lll[0], <code>C</code> ⊕lll [1] 即可求出 rand</p><h2 id="exp-7"><a class="anchor" href="#exp-7">#</a> exp</h2><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>key <span class="token operator">=</span> <span class="token number">0x4dcceb8802ae3c45fe80ccb364c8de19f2d39aa8ebbfb0621623e67aba8ed5bc</span></pre></td></tr><tr><td data-num="2"></td><td><pre>enc <span class="token operator">=</span> <span class="token number">0xe67a67efee3a80b66af0c33260f96b38e4142cd5d9426f6f156839f2e2a8efe8</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">from</span> struct <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">from</span> os <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">def</span> <span class="token function">aniely_stream</span><span class="token punctuation">(</span>passphrase<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">def</span> <span class="token function">mixer</span><span class="token punctuation">(</span>u<span class="token punctuation">,</span> v<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>u <span class="token operator">&lt;&lt;</span> v<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span><span class="token punctuation">)</span> <span class="token operator">|</span> u <span class="token operator">>></span> <span class="token punctuation">(</span><span class="token number">32</span> <span class="token operator">-</span> v<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token keyword">def</span> <span class="token function">forge</span><span class="token punctuation">(</span>w<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="15"></td><td><pre>            w<span class="token punctuation">[</span>a<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>w<span class="token punctuation">[</span>a<span class="token punctuation">]</span> <span class="token operator">+</span> w<span class="token punctuation">[</span>b<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span></pre></td></tr><tr><td data-num="16"></td><td><pre>            w<span class="token punctuation">[</span>d<span class="token punctuation">]</span> <span class="token operator">=</span> mixer<span class="token punctuation">(</span>w<span class="token punctuation">[</span>a<span class="token punctuation">]</span> <span class="token operator">^</span> w<span class="token punctuation">[</span>d<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">16</span> <span class="token operator">//</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre>            w<span class="token punctuation">[</span>c<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>w<span class="token punctuation">[</span>c<span class="token punctuation">]</span> <span class="token operator">+</span> w<span class="token punctuation">[</span>d<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span></pre></td></tr><tr><td data-num="18"></td><td><pre>            w<span class="token punctuation">[</span>b<span class="token punctuation">]</span> <span class="token operator">=</span> mixer<span class="token punctuation">(</span>w<span class="token punctuation">[</span>b<span class="token punctuation">]</span> <span class="token operator">^</span> w<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">12</span> <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">*</span> i<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="19"></td><td><pre></pre></td></tr><tr><td data-num="20"></td><td><pre>    bring <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">16</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    bring<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0x61707865</span><span class="token punctuation">,</span> <span class="token number">0x3320646e</span><span class="token punctuation">,</span> <span class="token number">0x79622d32</span><span class="token punctuation">,</span> <span class="token number">0x6b206574</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    bring<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">=</span> unpack<span class="token punctuation">(</span><span class="token string">'&lt;8L'</span><span class="token punctuation">,</span> passphrase<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    bring<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">=</span> bring<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0x0</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    bring<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">2</span></pre></td></tr><tr><td data-num="25"></td><td><pre></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="27"></td><td><pre>        w <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>bring<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="28"></td><td><pre>        <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="29"></td><td><pre>            forge<span class="token punctuation">(</span>w<span class="token punctuation">,</span> <span class="token number">0x0</span><span class="token punctuation">,</span> <span class="token number">0x4</span><span class="token punctuation">,</span> <span class="token number">0x8</span><span class="token punctuation">,</span> <span class="token number">0xc</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="30"></td><td><pre>            forge<span class="token punctuation">(</span>w<span class="token punctuation">,</span> <span class="token number">0x1</span><span class="token punctuation">,</span> <span class="token number">0x5</span><span class="token punctuation">,</span> <span class="token number">0x9</span><span class="token punctuation">,</span> <span class="token number">0xd</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="31"></td><td><pre>            forge<span class="token punctuation">(</span>w<span class="token punctuation">,</span> <span class="token number">0x2</span><span class="token punctuation">,</span> <span class="token number">0x6</span><span class="token punctuation">,</span> <span class="token number">0xa</span><span class="token punctuation">,</span> <span class="token number">0xe</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="32"></td><td><pre>            forge<span class="token punctuation">(</span>w<span class="token punctuation">,</span> <span class="token number">0x3</span><span class="token punctuation">,</span> <span class="token number">0x7</span><span class="token punctuation">,</span> <span class="token number">0xb</span><span class="token punctuation">,</span> <span class="token number">0xf</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="33"></td><td><pre>            forge<span class="token punctuation">(</span>w<span class="token punctuation">,</span> <span class="token number">0x0</span><span class="token punctuation">,</span> <span class="token number">0x5</span><span class="token punctuation">,</span> <span class="token number">0xa</span><span class="token punctuation">,</span> <span class="token number">0xf</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="34"></td><td><pre>            forge<span class="token punctuation">(</span>w<span class="token punctuation">,</span> <span class="token number">0x1</span><span class="token punctuation">,</span> <span class="token number">0x6</span><span class="token punctuation">,</span> <span class="token number">0xb</span><span class="token punctuation">,</span> <span class="token number">0xc</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="35"></td><td><pre>            forge<span class="token punctuation">(</span>w<span class="token punctuation">,</span> <span class="token number">0x2</span><span class="token punctuation">,</span> <span class="token number">0x7</span><span class="token punctuation">,</span> <span class="token number">0x8</span><span class="token punctuation">,</span> <span class="token number">0xd</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="36"></td><td><pre>            forge<span class="token punctuation">(</span>w<span class="token punctuation">,</span> <span class="token number">0x3</span><span class="token punctuation">,</span> <span class="token number">0x4</span><span class="token punctuation">,</span> <span class="token number">0x9</span><span class="token punctuation">,</span> <span class="token number">0xe</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="37"></td><td><pre>        <span class="token keyword">for</span> c <span class="token keyword">in</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;16L'</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span>w<span class="token punctuation">[</span>_<span class="token punctuation">]</span> <span class="token operator">+</span> bring<span class="token punctuation">[</span>_<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="38"></td><td><pre>            <span class="token keyword">yield</span> c</pre></td></tr><tr><td data-num="39"></td><td><pre>        bring<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>bring<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span></pre></td></tr><tr><td data-num="40"></td><td><pre>        <span class="token keyword">if</span> bring<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="41"></td><td><pre>            bring<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>bring<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span></pre></td></tr><tr><td data-num="42"></td><td><pre></pre></td></tr><tr><td data-num="43"></td><td><pre></pre></td></tr><tr><td data-num="44"></td><td><pre>key <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span>key<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="45"></td><td><pre>enc<span class="token operator">=</span>long_to_bytes<span class="token punctuation">(</span>enc<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="46"></td><td><pre></pre></td></tr><tr><td data-num="47"></td><td><pre>ll<span class="token operator">=</span><span class="token builtin">bytes</span><span class="token punctuation">(</span>a <span class="token operator">^</span> b <span class="token keyword">for</span> a<span class="token punctuation">,</span> b <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>enc<span class="token punctuation">,</span> aniely_stream<span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="48"></td><td><pre>cc<span class="token operator">=</span><span class="token builtin">bytes</span><span class="token punctuation">(</span>a <span class="token operator">^</span> b <span class="token keyword">for</span> a<span class="token punctuation">,</span> b <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> ll<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="49"></td><td><pre>rand<span class="token operator">=</span>long_to_bytes<span class="token punctuation">(</span>cc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">^</span><span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'C'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span>long_to_bytes<span class="token punctuation">(</span>cc<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">^</span><span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'C'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="50"></td><td><pre>rand<span class="token operator">=</span>rand<span class="token operator">*</span><span class="token number">16</span></pre></td></tr><tr><td data-num="51"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">bytes</span><span class="token punctuation">(</span>a <span class="token operator">^</span> b <span class="token keyword">for</span> a<span class="token punctuation">,</span> b <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>cc<span class="token punctuation">,</span> rand<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h1 id="diploma"><a class="anchor" href="#diploma">#</a> Diploma</h1><h2 id="题目-10"><a class="anchor" href="#题目-10">#</a> 题目</h2><p>在 GF (p) 上的 d 阶可逆矩阵群 GL (d,p) 中，抽一个元素 M。求 M 的阶。</p><p>sage 可以直接用</p><h2 id="exp-8"><a class="anchor" href="#exp-8">#</a> exp</h2><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="3"></td><td><pre>re<span class="token operator">=</span>remote<span class="token punctuation">(</span><span class="token string">"08.cr.yp.toc.tf"</span><span class="token punctuation">,</span><span class="token number">37313</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    re<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'| Generating the parameters for p = '</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    p <span class="token operator">=</span> re<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b','</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    p <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    re<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'| M = \n'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    M <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        s <span class="token operator">=</span> re<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        M<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> s<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span> <span class="token keyword">if</span> x <span class="token operator">!=</span> <span class="token string">''</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre>    M <span class="token operator">=</span> Matrix<span class="token punctuation">(</span>GF<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">,</span> M<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    ans <span class="token operator">=</span> M<span class="token punctuation">.</span>multiplicative_order<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    re<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>ans<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre>re<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h1 id="oak-land"><a class="anchor" href="#oak-land">#</a> Oak land</h1><h2 id="题目-11"><a class="anchor" href="#题目-11">#</a> 题目</h2><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#!/usr/bin/env python3</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">from</span> flag <span class="token keyword">import</span> flag</pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre>p <span class="token operator">=</span> <span class="token number">7389313481223384214994762619823300589978423075857540712007981373887018860174846208000957230283669342186460652521580595183523706412588695116906905718440770776239313669678685198683933547601793742596023475603667</span></pre></td></tr><tr><td data-num="7"></td><td><pre>e <span class="token operator">=</span> <span class="token number">31337</span></pre></td></tr><tr><td data-num="8"></td><td><pre>f <span class="token operator">=</span> <span class="token number">7236042467316654159796543399639966340258093274047941788600980451877044636122969830708918356119442228154447395855689559447196348683125675305629837437591088260218138895919514078948650757100432223219969122629790</span></pre></td></tr><tr><td data-num="9"></td><td><pre>g <span class="token operator">=</span> <span class="token number">1878626136321051642174045874618248475160620873585704351202865003185878331837410979441756843820270907300810543618813757245154196050399357659526631164136221434463496532263979506870318259276669412698827040743576</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre>x <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">assert</span> x <span class="token operator">&lt;</span> p</pre></td></tr><tr><td data-num="13"></td><td><pre>c <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">110</span> <span class="token operator">*</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> x<span class="token punctuation">,</span> p<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">313</span> <span class="token operator">*</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> x<span class="token punctuation">,</span> p<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">114</span> <span class="token operator">*</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>g<span class="token punctuation">,</span> x<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> p</pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'c = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>c<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token comment">#c = 871346503375040565701864845493751233877009611275883500035764036792906970084258238763963152627486758242101207127598485219754255161617890137664012548226251138485059295263306930653899766537171223837761341914356</span></pre></td></tr></table></figure><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mo>=</mo><mn>110</mn><mo>∗</mo><msup><mi>e</mi><mi>x</mi></msup><mspace></mspace><mspace width="0.6666666666666666em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext></mtext><mtext></mtext><mi>p</mi><mo>+</mo><mn>313</mn><mo>∗</mo><msup><mi>f</mi><mi>x</mi></msup><mspace></mspace><mspace width="0.6666666666666666em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext></mtext><mtext></mtext><mi>p</mi><mo>+</mo><mn>114</mn><mo>∗</mo><msup><mi>g</mi><mi>x</mi></msup><mspace></mspace><mspace width="0.6666666666666666em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext></mtext><mtext></mtext><mi>p</mi></mrow><annotation encoding="application/x-tex">c=110*e^x\mod p+313*f^x\mod p+114*g^x\mod p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mord">1</span><span class="mord">0</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.664392em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.664392em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:.6666666666666666em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">3</span><span class="mord">1</span><span class="mord">3</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.664392em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:.6666666666666666em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mord">1</span><span class="mord">4</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.858832em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.664392em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:.6666666666666666em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal">p</span></span></span></span></p><p>f,e,p,g,c 已知</p><p>求 x</p><p>看出</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo>=</mo><msup><mi>e</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mspace></mspace><mspace width="0.6666666666666666em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext></mtext><mtext></mtext><mi>p</mi></mrow><annotation encoding="application/x-tex">f=e^{-1}\mod p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8141079999999999em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:.6666666666666666em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal">p</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo>=</mo><msup><mi>f</mi><mn>2</mn></msup><mspace></mspace><mspace width="0.6666666666666666em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext></mtext><mtext></mtext><mi>p</mi></mrow><annotation encoding="application/x-tex">g=f^2\mod p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathnormal" style="margin-right:.03588em">g</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:.6666666666666666em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal">p</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mo>=</mo><mn>110</mn><mo>∗</mo><msup><mi>e</mi><mi>x</mi></msup><mspace></mspace><mspace width="0.6666666666666666em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext></mtext><mtext></mtext><mi>p</mi><mo>+</mo><mn>313</mn><mo>∗</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>x</mi></mrow></msup><mspace></mspace><mspace width="0.6666666666666666em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext></mtext><mtext></mtext><mi>p</mi><mo>+</mo><mn>114</mn><mo>∗</mo><msup><mi>e</mi><mrow><mo>−</mo><mn>2</mn><mi>x</mi></mrow></msup><mspace></mspace><mspace width="0.6666666666666666em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext></mtext><mtext></mtext><mi>p</mi></mrow><annotation encoding="application/x-tex">c=110*e^x\mod p+313*e^{-x}\mod p+114*e^{-2x}\mod p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mord">1</span><span class="mord">0</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.664392em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.664392em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:.6666666666666666em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">3</span><span class="mord">1</span><span class="mord">3</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.771331em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.771331em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:.6666666666666666em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mord">1</span><span class="mord">4</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8141079999999999em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">2</span><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:.6666666666666666em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal">p</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mo>∗</mo><msup><mi>e</mi><mrow><mn>2</mn><mi>x</mi></mrow></msup><mo>=</mo><mn>110</mn><mo>∗</mo><msup><mi>e</mi><mrow><mn>3</mn><mi>x</mi></mrow></msup><mspace></mspace><mspace width="0.6666666666666666em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext></mtext><mtext></mtext><mi>p</mi><mo>+</mo><mn>313</mn><mo>∗</mo><msup><mi>e</mi><mi>x</mi></msup><mspace></mspace><mspace width="0.6666666666666666em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext></mtext><mtext></mtext><mi>p</mi><mo>+</mo><mn>114</mn><mspace></mspace><mspace width="0.6666666666666666em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext></mtext><mtext></mtext><mi>p</mi></mrow><annotation encoding="application/x-tex">c*e^{2x}=110*e^{3x}\mod p+313*e^{x}\mod p+114\mod p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.46528em;vertical-align:0"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8141079999999999em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mord">1</span><span class="mord">0</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8141079999999999em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:.6666666666666666em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">3</span><span class="mord">1</span><span class="mord">3</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.664392em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.664392em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:.6666666666666666em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mord">1</span><span class="mord">4</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:.6666666666666666em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal">p</span></span></span></span></p><p>在模 p 的意义下解出<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>e</mi><mi>x</mi></msup></mrow><annotation encoding="application/x-tex">e^x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.664392em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.664392em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span></span></span> 为多少</p><h2 id="exp-9"><a class="anchor" href="#exp-9">#</a> exp</h2><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> Crypro<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="2"></td><td><pre>p <span class="token operator">=</span> <span class="token number">7389313481223384214994762619823300589978423075857540712007981373887018860174846208000957230283669342186460652521580595183523706412588695116906905718440770776239313669678685198683933547601793742596023475603667</span></pre></td></tr><tr><td data-num="3"></td><td><pre>e <span class="token operator">=</span> <span class="token number">31337</span></pre></td></tr><tr><td data-num="4"></td><td><pre>f <span class="token operator">=</span> <span class="token number">7236042467316654159796543399639966340258093274047941788600980451877044636122969830708918356119442228154447395855689559447196348683125675305629837437591088260218138895919514078948650757100432223219969122629790</span></pre></td></tr><tr><td data-num="5"></td><td><pre>g <span class="token operator">=</span> <span class="token number">1878626136321051642174045874618248475160620873585704351202865003185878331837410979441756843820270907300810543618813757245154196050399357659526631164136221434463496532263979506870318259276669412698827040743576</span></pre></td></tr><tr><td data-num="6"></td><td><pre>c <span class="token operator">=</span> <span class="token number">871346503375040565701864845493751233877009611275883500035764036792906970084258238763963152627486758242101207127598485219754255161617890137664012548226251138485059295263306930653899766537171223837761341914356</span></pre></td></tr><tr><td data-num="7"></td><td><pre>F<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>f <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">110</span> <span class="token operator">*</span> x<span class="token operator">^</span><span class="token number">3</span> <span class="token operator">+</span> <span class="token number">313</span> <span class="token operator">*</span> x <span class="token operator">+</span> <span class="token number">114</span> <span class="token operator">-</span> c <span class="token operator">*</span> x<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>ex<span class="token operator">=</span>f<span class="token punctuation">.</span>root<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="10"></td><td><pre>m<span class="token operator">=</span>discrete_log<span class="token punctuation">(</span>mod<span class="token punctuation">(</span>ex<span class="token punctuation">,</span>p<span class="token punctuation">)</span><span class="token punctuation">,</span>mod<span class="token punctuation">(</span>e<span class="token punctuation">,</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token comment">#CCTF&#123;V33333rY_eeeeZy_DLP_cH41L3n9E!&#125;</span></pre></td></tr></table></figure><h1 id="cantilever"><a class="anchor" href="#cantilever">#</a> Cantilever</h1><h2 id="题目-12"><a class="anchor" href="#题目-12">#</a> 题目</h2><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#!/usr/bin/env python3</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">from</span> flag <span class="token keyword">import</span> flag</pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">def</span> <span class="token function">gen_primes</span><span class="token punctuation">(</span>nbit<span class="token punctuation">,</span> imbalance<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="7"></td><td><pre>	p <span class="token operator">=</span> <span class="token number">2</span></pre></td></tr><tr><td data-num="8"></td><td><pre>	FACTORS <span class="token operator">=</span> <span class="token punctuation">[</span>p<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="9"></td><td><pre>	<span class="token keyword">while</span> p<span class="token punctuation">.</span>bit_length<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> nbit <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">*</span> imbalance<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="10"></td><td><pre>		factor <span class="token operator">=</span> getPrime<span class="token punctuation">(</span>imbalance<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>		FACTORS<span class="token punctuation">.</span>append<span class="token punctuation">(</span>factor<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>		p <span class="token operator">*=</span> factor</pre></td></tr><tr><td data-num="13"></td><td><pre>	rbit <span class="token operator">=</span> <span class="token punctuation">(</span>nbit <span class="token operator">-</span> p<span class="token punctuation">.</span>bit_length<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre>	<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="16"></td><td><pre>		r<span class="token punctuation">,</span> s <span class="token operator">=</span> <span class="token punctuation">[</span>getPrime<span class="token punctuation">(</span>rbit<span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token string">'01'</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="17"></td><td><pre>		_p <span class="token operator">=</span> p <span class="token operator">*</span> r <span class="token operator">*</span> s</pre></td></tr><tr><td data-num="18"></td><td><pre>		<span class="token keyword">if</span> _p<span class="token punctuation">.</span>bit_length<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> nbit<span class="token punctuation">:</span> rbit <span class="token operator">+=</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="19"></td><td><pre>		<span class="token keyword">if</span> _p<span class="token punctuation">.</span>bit_length<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> nbit<span class="token punctuation">:</span> rbit <span class="token operator">-=</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="20"></td><td><pre>		<span class="token keyword">if</span> isPrime<span class="token punctuation">(</span>_p <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="21"></td><td><pre>			FACTORS<span class="token punctuation">.</span>extend<span class="token punctuation">(</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="22"></td><td><pre>			p <span class="token operator">=</span> _p <span class="token operator">+</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="23"></td><td><pre>			<span class="token keyword">break</span></pre></td></tr><tr><td data-num="24"></td><td><pre></pre></td></tr><tr><td data-num="25"></td><td><pre>	FACTORS<span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="26"></td><td><pre>	<span class="token keyword">return</span> <span class="token punctuation">(</span>p<span class="token punctuation">,</span> FACTORS<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="27"></td><td><pre></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token keyword">def</span> <span class="token function">genkey</span><span class="token punctuation">(</span>nbit<span class="token punctuation">,</span> imbalance<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="29"></td><td><pre>	<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="30"></td><td><pre>		p<span class="token punctuation">,</span> FACTORS <span class="token operator">=</span> gen_primes<span class="token punctuation">(</span>nbit <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">,</span> imbalance<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="31"></td><td><pre>		<span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>FACTORS<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">set</span><span class="token punctuation">(</span>FACTORS<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="32"></td><td><pre>			<span class="token keyword">continue</span></pre></td></tr><tr><td data-num="33"></td><td><pre>		q<span class="token punctuation">,</span> q_factors <span class="token operator">=</span> gen_primes<span class="token punctuation">(</span>nbit <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">,</span> imbalance <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="34"></td><td><pre>		<span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>q_factors<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">set</span><span class="token punctuation">(</span>q_factors<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="35"></td><td><pre>			<span class="token keyword">continue</span></pre></td></tr><tr><td data-num="36"></td><td><pre>		factors <span class="token operator">=</span> FACTORS <span class="token operator">+</span> q_factors</pre></td></tr><tr><td data-num="37"></td><td><pre>		<span class="token keyword">if</span> e <span class="token keyword">not</span> <span class="token keyword">in</span> factors<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="38"></td><td><pre>			<span class="token keyword">break</span></pre></td></tr><tr><td data-num="39"></td><td><pre>	n <span class="token operator">=</span> p <span class="token operator">*</span> q</pre></td></tr><tr><td data-num="40"></td><td><pre>	<span class="token keyword">return</span> n<span class="token punctuation">,</span> <span class="token punctuation">(</span>p<span class="token punctuation">,</span> q<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="41"></td><td><pre></pre></td></tr><tr><td data-num="42"></td><td><pre>nbit <span class="token operator">=</span> <span class="token number">2048</span></pre></td></tr><tr><td data-num="43"></td><td><pre>imbalance <span class="token operator">=</span> <span class="token number">19</span></pre></td></tr><tr><td data-num="44"></td><td><pre>e <span class="token operator">=</span> <span class="token number">0x10001</span></pre></td></tr><tr><td data-num="45"></td><td><pre></pre></td></tr><tr><td data-num="46"></td><td><pre>m_1 <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token builtin">len</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="47"></td><td><pre>m_2 <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token builtin">len</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="48"></td><td><pre></pre></td></tr><tr><td data-num="49"></td><td><pre>n<span class="token punctuation">,</span> PRIMES <span class="token operator">=</span> genkey<span class="token punctuation">(</span>nbit<span class="token punctuation">,</span> imbalance<span class="token punctuation">,</span> e<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="50"></td><td><pre></pre></td></tr><tr><td data-num="51"></td><td><pre>c_1 <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m_1<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="52"></td><td><pre>c_2 <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> m_2<span class="token punctuation">,</span> n<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="53"></td><td><pre></pre></td></tr><tr><td data-num="54"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'n = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>n<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="55"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'c_1 = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>c_1<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="56"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'c_2 = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>c_2<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="57"></td><td><pre></pre></td></tr><tr><td data-num="58"></td><td><pre></pre></td></tr><tr><td data-num="59"></td><td><pre>n <span class="token operator">=</span> <span class="token number">7069789930583271525053215046247773438899869283661158227309691853515987055334306019600324056376312479212090202373516405860759222837585952590589336295698718699890424169542280710721069784487366121478569760563045886361884895363592898476736269784284754788133722060718026577238640218755539268465317292713320841554802703379684173485217045274942603346947299152498798736808975912326592689302969859834957202716983626393365387411319175917999258829839695189774082810459527737342402920881184864625678296442001837072332161966439361793009893108796934406114288057583563496587655548536011677451960307597573257032154009427010069578913</span></pre></td></tr><tr><td data-num="60"></td><td><pre>c_1 <span class="token operator">=</span> <span class="token number">488692928085934899944055554857568564903346089951134051486941368561567330884363274156339625953702601270565654444836193796061118053575538224794730472032345171432952984560662218697488844007827176184413713651118743456250147472678673801728916283759932987216388378211555067885210167894310696549664382751443669387953644382833924884208966436685137553434532738845959014828804809425096115758364136546390809453200055265653531950423111482644330073443545410319576097902472017235065047191133112557289289189187696092145850680765843608118584107829268136014912479701945735063525799796920293418182776436767911172221104640501952880057</span></pre></td></tr><tr><td data-num="61"></td><td><pre>c_2 <span class="token operator">=</span> <span class="token number">109770827223661560471527567179288748906402603483328748683689436879660543465776899146036833470531024202351087008847594392666852763100570391337823820240726499421306887565697452868723849092658743267256316770223643723095601213088336064635680075206929620159782416078143076506249031972043819429093074684182845530529249907297736582589125917235222921623698038868900282049587768700860009877737045693722732170123306528145661683416808514556360429554775212088169626620488741903267154641722293484797745665402402381445609873333905772582972140944493849645600529147490903067975300304532955461710562911203871840101407995813072692212</span></pre></td></tr></table></figure><p>可以看到 p-1 光滑</p><p>可以分解 n</p><p>得到 m1</p><p>m2 没思路 看赵总的</p><blockquote><p>求出分解后，由于 p-1 和 q-1 均光滑，可以先用 Pohlig-Hellman 分别求出 m2 模 p-1 和模 q-1 的值，进而用中国剩余定理求出明文 m2。</p></blockquote><h2 id="exp-10"><a class="anchor" href="#exp-10">#</a> exp</h2><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="3"></td><td><pre>a <span class="token operator">=</span> <span class="token number">2</span></pre></td></tr><tr><td data-num="4"></td><td><pre>N<span class="token operator">=</span><span class="token number">7069789930583271525053215046247773438899869283661158227309691853515987055334306019600324056376312479212090202373516405860759222837585952590589336295698718699890424169542280710721069784487366121478569760563045886361884895363592898476736269784284754788133722060718026577238640218755539268465317292713320841554802703379684173485217045274942603346947299152498798736808975912326592689302969859834957202716983626393365387411319175917999258829839695189774082810459527737342402920881184864625678296442001837072332161966439361793009893108796934406114288057583563496587655548536011677451960307597573257032154009427010069578913</span></pre></td></tr><tr><td data-num="5"></td><td><pre>n <span class="token operator">=</span> <span class="token number">2</span></pre></td></tr><tr><td data-num="6"></td><td><pre>e<span class="token operator">=</span><span class="token number">0x10001</span></pre></td></tr><tr><td data-num="7"></td><td><pre>c<span class="token operator">=</span><span class="token number">488692928085934899944055554857568564903346089951134051486941368561567330884363274156339625953702601270565654444836193796061118053575538224794730472032345171432952984560662218697488844007827176184413713651118743456250147472678673801728916283759932987216388378211555067885210167894310696549664382751443669387953644382833924884208966436685137553434532738845959014828804809425096115758364136546390809453200055265653531950423111482644330073443545410319576097902472017235065047191133112557289289189187696092145850680765843608118584107829268136014912479701945735063525799796920293418182776436767911172221104640501952880057</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    a <span class="token operator">=</span> powmod<span class="token punctuation">(</span>a<span class="token punctuation">,</span> n<span class="token punctuation">,</span> N<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    res <span class="token operator">=</span> gcd<span class="token punctuation">(</span>a<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> N<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token keyword">if</span> res <span class="token operator">!=</span> <span class="token number">1</span> <span class="token keyword">and</span> res <span class="token operator">!=</span> N<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        q <span class="token operator">=</span> N <span class="token operator">//</span> res</pre></td></tr><tr><td data-num="13"></td><td><pre>        d <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token punctuation">(</span>res<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        m <span class="token operator">=</span> powmod<span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> N<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token keyword">break</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    n <span class="token operator">+=</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    </pre></td></tr><tr><td data-num="20"></td><td><pre>    </pre></td></tr><tr><td data-num="21"></td><td><pre>q<span class="token operator">=</span><span class="token number">84761154786085445040051273337185621770653977624442810400422736258693219544281946893222923335092616440575888204882883202879374137962201839964482318483860286412488851522612902055732831909496637360268825720155284438779235801463340052531340653630637729255285872455686692027630814695155220888112228977346697309127</span></pre></td></tr><tr><td data-num="22"></td><td><pre>p<span class="token operator">=</span>n<span class="token operator">//</span>q</pre></td></tr><tr><td data-num="23"></td><td><pre>Zp<span class="token punctuation">,</span> Zq <span class="token operator">=</span> Zmod<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">,</span> Zmod<span class="token punctuation">(</span>q<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre></pre></td></tr><tr><td data-num="25"></td><td><pre></pre></td></tr><tr><td data-num="26"></td><td><pre>m_2p <span class="token operator">=</span> discrete_log<span class="token punctuation">(</span>Zp<span class="token punctuation">(</span>c2<span class="token punctuation">)</span><span class="token punctuation">,</span> Zp<span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="27"></td><td><pre>m_2q <span class="token operator">=</span> discrete_log<span class="token punctuation">(</span>Zq<span class="token punctuation">(</span>c2<span class="token punctuation">)</span><span class="token punctuation">,</span> Zq<span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="28"></td><td><pre>m_2 <span class="token operator">=</span> crt<span class="token punctuation">(</span><span class="token punctuation">[</span>m_2p<span class="token punctuation">,</span> m_2q<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m_2<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="30"></td><td><pre></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token comment">#CCTF&#123;5L3Ek_4s__s1lK__Ri9H7?!&#125;</span></pre></td></tr></table></figure><h1 id="side-step"><a class="anchor" href="#side-step">#</a> Side step</h1><h2 id="题目-13"><a class="anchor" href="#题目-13">#</a> 题目</h2><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#!/usr/bin/env python3</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">import</span> random<span class="token punctuation">,</span> sys</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">from</span> flag <span class="token keyword">import</span> flag</pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">def</span> <span class="token function">pow_d</span><span class="token punctuation">(</span>g<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="8"></td><td><pre>	t<span class="token punctuation">,</span> r <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="9"></td><td><pre>	<span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">bin</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="10"></td><td><pre>		<span class="token keyword">if</span> r <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">:</span> t <span class="token operator">+=</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="11"></td><td><pre>		r <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>		<span class="token keyword">if</span> _ <span class="token operator">==</span> <span class="token string">'1'</span><span class="token punctuation">:</span> r <span class="token operator">=</span> r <span class="token operator">*</span> g <span class="token operator">%</span> n</pre></td></tr><tr><td data-num="13"></td><td><pre>	<span class="token keyword">return</span> t<span class="token punctuation">,</span> r</pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">def</span> <span class="token function">ts</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="16"></td><td><pre>	m <span class="token operator">=</span> m <span class="token operator">%</span> p</pre></td></tr><tr><td data-num="17"></td><td><pre>	<span class="token keyword">return</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="18"></td><td><pre></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token keyword">def</span> <span class="token function">die</span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="20"></td><td><pre>	pr<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="21"></td><td><pre>	quit<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token keyword">def</span> <span class="token function">pr</span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="24"></td><td><pre>	s <span class="token operator">=</span> <span class="token string">" "</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="25"></td><td><pre>	sys<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>write<span class="token punctuation">(</span>s <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="26"></td><td><pre>	sys<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>flush<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="27"></td><td><pre></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token keyword">def</span> <span class="token function">sc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="29"></td><td><pre>	<span class="token keyword">return</span> sys<span class="token punctuation">.</span>stdin<span class="token punctuation">.</span>readline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="30"></td><td><pre></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="32"></td><td><pre>	border <span class="token operator">=</span> <span class="token string">"|"</span></pre></td></tr><tr><td data-num="33"></td><td><pre>	pr<span class="token punctuation">(</span>border<span class="token operator">*</span><span class="token number">72</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="34"></td><td><pre>	pr<span class="token punctuation">(</span>border<span class="token punctuation">,</span> <span class="token string">"Hi all cryptographers! Welcome to the Sidestep task, we do powing!!!"</span><span class="token punctuation">,</span> border<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="35"></td><td><pre>	pr<span class="token punctuation">(</span>border<span class="token punctuation">,</span> <span class="token string">"You should solve a DLP challenge in some special way to get the flag"</span><span class="token punctuation">,</span> border<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="36"></td><td><pre></pre></td></tr><tr><td data-num="37"></td><td><pre>	p <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">**</span> <span class="token number">1024</span> <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">**</span> <span class="token number">234</span> <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">**</span> <span class="token number">267</span> <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">**</span> <span class="token number">291</span> <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">**</span> <span class="token number">403</span> <span class="token operator">-</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="38"></td><td><pre>	s <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="39"></td><td><pre></pre></td></tr><tr><td data-num="40"></td><td><pre>	<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="41"></td><td><pre>		pr<span class="token punctuation">(</span><span class="token string">"| Options: \n|\t[T]ry the magic machine \n|\t[Q]uit"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="42"></td><td><pre>		ans <span class="token operator">=</span> sc<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="43"></td><td><pre></pre></td></tr><tr><td data-num="44"></td><td><pre>		<span class="token keyword">if</span> ans <span class="token operator">==</span> <span class="token string">'t'</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="45"></td><td><pre>			pr<span class="token punctuation">(</span>border<span class="token punctuation">,</span> <span class="token string">"please send your desired integer: "</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="46"></td><td><pre>			g <span class="token operator">=</span> sc<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="47"></td><td><pre>			<span class="token keyword">try</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="48"></td><td><pre>				g <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="49"></td><td><pre>			<span class="token keyword">except</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="50"></td><td><pre>				die<span class="token punctuation">(</span>border<span class="token punctuation">,</span> <span class="token string">"The given input is not integer!"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="51"></td><td><pre>			<span class="token keyword">if</span> ts<span class="token punctuation">(</span>g<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="52"></td><td><pre>				t<span class="token punctuation">,</span> r <span class="token operator">=</span> pow_d<span class="token punctuation">(</span>g<span class="token punctuation">,</span> s<span class="token punctuation">,</span> p<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="53"></td><td><pre>				<span class="token keyword">if</span> r <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="54"></td><td><pre>					die<span class="token punctuation">(</span>border<span class="token punctuation">,</span> <span class="token string-interpolation"><span class="token string">f'Great! you got the flag: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>flag<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="55"></td><td><pre>				<span class="token keyword">else</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="56"></td><td><pre>					pr<span class="token punctuation">(</span>border<span class="token punctuation">,</span> <span class="token string-interpolation"><span class="token string">f"t, r = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>t<span class="token punctuation">,</span> r<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="57"></td><td><pre>			<span class="token keyword">else</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="58"></td><td><pre>				pr<span class="token punctuation">(</span>border<span class="token punctuation">,</span> <span class="token string">"The given base is NOT valid!!!"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="59"></td><td><pre>		<span class="token keyword">elif</span> ans <span class="token operator">==</span> <span class="token string">'q'</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="60"></td><td><pre>			die<span class="token punctuation">(</span>border<span class="token punctuation">,</span> <span class="token string">"Quitting ..."</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="61"></td><td><pre>		<span class="token keyword">else</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="62"></td><td><pre>			die<span class="token punctuation">(</span>border<span class="token punctuation">,</span> <span class="token string">"Bye bye ..."</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="63"></td><td><pre></pre></td></tr><tr><td data-num="64"></td><td><pre><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="65"></td><td><pre>	main<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h1 id="starter-ecc"><a class="anchor" href="#starter-ecc">#</a> Starter ECC</h1><h2 id="题目-14"><a class="anchor" href="#题目-14">#</a> 题目</h2><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#!/usr/bin/env sage</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">from</span> secret <span class="token keyword">import</span> n<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> x<span class="token punctuation">,</span> flag</pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre>y <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">assert</span> y <span class="token operator">&lt;</span> n</pre></td></tr><tr><td data-num="9"></td><td><pre>E <span class="token operator">=</span> EllipticCurve<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">try</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="12"></td><td><pre>	G <span class="token operator">=</span> E<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre>	<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'x = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>x<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>	<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'a = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>a<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre>	<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'b = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>b<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre>	<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'n = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>n<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre>	<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Find the flag :P'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token keyword">except</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="19"></td><td><pre>	<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Ooops, ERROR :-('</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>y</mi><mn>2</mn></msup><mo>=</mo><msup><mi>x</mi><mn>3</mn></msup><mo>+</mo><mi>a</mi><mi>x</mi><mo>+</mo><mi>b</mi><mspace></mspace><mspace width="0.6666666666666666em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext></mtext><mtext></mtext><mi>n</mi></mrow><annotation encoding="application/x-tex">y^2=x^3+ax+b\mod n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.897438em;vertical-align:-.08333em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.66666em;vertical-align:-.08333em"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathnormal">b</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:.6666666666666666em"></span></span><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal">n</span></span></span></span></p><p>x,a,b,n 已知</p><p>求 y</p><p>其实是求模 n 下的二次剩余</p><p>分解 n</p><p>n=<span class="exturl" data-url="aHR0cDovL3d3dy5mYWN0b3JkYi5jb20vaW5kZXgucGhwP2lkPTI=">2^63</span> · <span class="exturl" data-url="aHR0cDovL3d3dy5mYWN0b3JkYi5jb20vaW5kZXgucGhwP2lkPTExMDAwMDAwMDM3OTgxNDA4MTA=">690712633549859897233^6</span> · <span class="exturl" data-url="aHR0cDovL3d3dy5mYWN0b3JkYi5jb20vaW5kZXgucGhwP2lkPTExMDAwMDAwMDM3OTgxNDA4ODc=">651132262883189171676209466993073^5</span></p><h2 id="exp-11"><a class="anchor" href="#exp-11">#</a> exp</h2><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#sage</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span> itertools</pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre>x <span class="token operator">=</span> <span class="token number">10715086071862673209484250490600018105614048117055336074437503883703510511249361224931983788156958581275946729175531468251871452856923140435984577574698574803934567774824230985421074605062371141877954182153046477020617917601884853827611232355455223966039590143622792803800879186033924150173912925208583</span></pre></td></tr><tr><td data-num="6"></td><td><pre>a <span class="token operator">=</span> <span class="token number">31337</span></pre></td></tr><tr><td data-num="7"></td><td><pre>b <span class="token operator">=</span> <span class="token number">66826418568487077181425396984743905464189470072466833884636947306507380342362386488703702812673327367379386970252278963682939080502468506452884260534949120967338532068983307061363686987539408216644249718950365322078643067666802845720939111758309026343239779555536517718292754561631504560989926785152983649035</span></pre></td></tr><tr><td data-num="8"></td><td><pre>n <span class="token operator">=</span> <span class="token number">117224988229627436482659673624324558461989737163733991529810987781450160688540001366778824245275287757373389887319739241684244545745583212512813949172078079042775825145312900017512660931667853567060810331541927568102860039898116182248597291899498790518105909390331098630690977858767670061026931938152924839936</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>p <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">^</span><span class="token number">63</span></pre></td></tr><tr><td data-num="11"></td><td><pre>q <span class="token operator">=</span> <span class="token number">651132262883189171676209466993073</span><span class="token operator">^</span><span class="token number">5</span></pre></td></tr><tr><td data-num="12"></td><td><pre>r <span class="token operator">=</span> <span class="token number">690712633549859897233</span><span class="token operator">^</span><span class="token number">6</span></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre>ps <span class="token operator">=</span> <span class="token punctuation">[</span>p<span class="token punctuation">,</span> q<span class="token punctuation">,</span> r<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="15"></td><td><pre>ys <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="16"></td><td><pre>RHS <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token operator">^</span><span class="token number">3</span> <span class="token operator">+</span> a <span class="token operator">*</span> x <span class="token operator">+</span> b<span class="token punctuation">)</span> <span class="token operator">%</span> n</pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token keyword">for</span> p <span class="token keyword">in</span> ps<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    sol <span class="token operator">=</span> Zmod<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">(</span>RHS<span class="token punctuation">)</span><span class="token punctuation">.</span>nth_root<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token builtin">all</span><span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    ys<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span>ZZ<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> sol<span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token keyword">for</span> real_ys <span class="token keyword">in</span> itertools<span class="token punctuation">.</span>product<span class="token punctuation">(</span><span class="token operator">*</span>ys<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    y <span class="token operator">=</span> crt<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>real_ys<span class="token punctuation">)</span><span class="token punctuation">,</span> ps<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    y <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span>y<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">b'CCTF'</span> <span class="token keyword">in</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="25"></td><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span></pre></td></tr></table></figure><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2022-07-28 18:53:18" itemprop="dateModified" datetime="2022-07-28T18:53:18+08:00">2022-07-28</time> </span><span id="2022/07/21/match/CRYPTO CTF/" class="item leancloud_visitors" data-flag-title="CRYPTO CTF" title="阅读次数"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">阅读次数</span> <span class="leancloud-visitors-count"></span> <span class="text">次</span></span></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>Putao0v0 <i class="ic i-at"><em>@</em></i>putao</li><li class="link"><strong>本文链接：</strong> <a href="http://example.com/2022/07/21/match/CRYPTO%20CTF/" title="CRYPTO CTF">http://example.com/2022/07/21/match/CRYPTO CTF/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/2022/07/18/match/NepNep/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;tva2.sinaimg.cn&#x2F;mw690&#x2F;d74c8da0ly8hb8v9evb8gj20u00u0wix.jpg" title="NepNep"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> 比赛</span><h3>NepNep</h3></a></div><div class="item right"><a href="/2022/07/22/crypto/%E5%8F%8D%E9%A6%88%E7%A7%BB%E4%BD%8D%E5%AF%84%E5%AD%98%E5%99%A8/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;tva2.sinaimg.cn&#x2F;mw690&#x2F;d74c8da0ly8hb8v0aair6j21900u0whx.jpg" title="LFSR"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> CRYPTO</span><h3>LFSR</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#klamkin"><span class="toc-number">1.</span> <span class="toc-text">Klamkin</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE"><span class="toc-number">1.1.</span> <span class="toc-text">题目</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#exp"><span class="toc-number">1.2.</span> <span class="toc-text">exp</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#baphomet"><span class="toc-number">2.</span> <span class="toc-text">Baphomet</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE-2"><span class="toc-number">2.1.</span> <span class="toc-text">题目</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#exp-2"><span class="toc-number">2.2.</span> <span class="toc-text">exp</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#sots"><span class="toc-number">3.</span> <span class="toc-text">SOTS</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE-3"><span class="toc-number">3.1.</span> <span class="toc-text">题目</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#polyrsa"><span class="toc-number">4.</span> <span class="toc-text">polyRSA</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE-4"><span class="toc-number">4.1.</span> <span class="toc-text">题目</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#exp-3"><span class="toc-number">4.2.</span> <span class="toc-text">exp</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#infinity-castle"><span class="toc-number">5.</span> <span class="toc-text">Infinity castle</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE-5"><span class="toc-number">5.1.</span> <span class="toc-text">题目</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#exp-4"><span class="toc-number">5.2.</span> <span class="toc-text">exp</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#keydream"><span class="toc-number">6.</span> <span class="toc-text">Keydream</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE-6"><span class="toc-number">6.1.</span> <span class="toc-text">题目</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#exp-5"><span class="toc-number">6.2.</span> <span class="toc-text">exp</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#jeksign"><span class="toc-number">7.</span> <span class="toc-text">Jeksign</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE-7"><span class="toc-number">7.1.</span> <span class="toc-text">题目</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#exp-6"><span class="toc-number">7.2.</span> <span class="toc-text">exp</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#volgo"><span class="toc-number">8.</span> <span class="toc-text">Volgo</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE-8"><span class="toc-number">8.1.</span> <span class="toc-text">题目</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#aniely"><span class="toc-number">9.</span> <span class="toc-text">Aniely</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE-9"><span class="toc-number">9.1.</span> <span class="toc-text">题目</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#exp-7"><span class="toc-number">9.2.</span> <span class="toc-text">exp</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#diploma"><span class="toc-number">10.</span> <span class="toc-text">Diploma</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE-10"><span class="toc-number">10.1.</span> <span class="toc-text">题目</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#exp-8"><span class="toc-number">10.2.</span> <span class="toc-text">exp</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#oak-land"><span class="toc-number">11.</span> <span class="toc-text">Oak land</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE-11"><span class="toc-number">11.1.</span> <span class="toc-text">题目</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#exp-9"><span class="toc-number">11.2.</span> <span class="toc-text">exp</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#cantilever"><span class="toc-number">12.</span> <span class="toc-text">Cantilever</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE-12"><span class="toc-number">12.1.</span> <span class="toc-text">题目</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#exp-10"><span class="toc-number">12.2.</span> <span class="toc-text">exp</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#side-step"><span class="toc-number">13.</span> <span class="toc-text">Side step</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE-13"><span class="toc-number">13.1.</span> <span class="toc-text">题目</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#starter-ecc"><span class="toc-number">14.</span> <span class="toc-text">Starter ECC</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE-14"><span class="toc-number">14.1.</span> <span class="toc-text">题目</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#exp-11"><span class="toc-number">14.2.</span> <span class="toc-text">exp</span></a></li></ol></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li><a href="/2022/02/23/match/ctfshow%E5%AF%86%E7%A0%81%E6%8C%91%E6%88%98/" rel="bookmark" title="ctfshow密码挑战">ctfshow密码挑战</a></li><li><a href="/2022/02/23/match/ByteCTF/" rel="bookmark" title="ByteCTF">ByteCTF</a></li><li><a href="/2022/03/02/match/%E5%8D%B7%E7%8E%8B%E6%9D%AF/" rel="bookmark" title="卷王杯">卷王杯</a></li><li><a href="/2022/03/03/match/VN2022/" rel="bookmark" title="VN2022">VN2022</a></li><li><a href="/2022/03/12/match/d%5E3ctf/" rel="bookmark" title="d^3ctf">d^3ctf</a></li><li><a href="/2022/03/21/match/%E8%99%8E%E7%AC%A6%E6%9D%AF/" rel="bookmark" title="虎符杯">虎符杯</a></li><li><a href="/2022/03/24/match/%E7%BA%A2%E6%98%8E%E8%B0%B72022/" rel="bookmark" title="红明谷2022">红明谷2022</a></li><li><a href="/2022/04/09/match/HZNUCTF/" rel="bookmark" title="HZNUCTF">HZNUCTF</a></li><li><a href="/2022/04/27/match/DASCTF%20Apr%20X%20FATE%20%E9%98%B2%E7%96%AB%E6%8C%91%E6%88%98%E8%B5%9B/" rel="bookmark" title="DASCTF Apr X FATE 防疫挑战赛">DASCTF Apr X FATE 防疫挑战赛</a></li><li><a href="/2022/05/16/match/PWNHUB/" rel="bookmark" title="PWNHUB">PWNHUB</a></li><li><a href="/2022/05/16/match/%E5%AE%81%E6%B3%A2%E5%B8%82%E7%AC%AC%E4%BA%94%E5%B1%8A%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/" rel="bookmark" title="宁波市第五届网络安全大赛">宁波市第五届网络安全大赛</a></li><li><a href="/2022/05/27/match/Dest0g3/" rel="bookmark" title="Dest0g3">Dest0g3</a></li><li><a href="/2022/05/27/match/ctfshow%E5%8D%95%E8%BA%AB%E6%9D%AF/" rel="bookmark" title="ctfshow单身杯">ctfshow单身杯</a></li><li><a href="/2022/06/30/match/DASCTF%E5%87%BA%E9%A2%98%E4%BA%BA%E6%8C%91%E6%88%98%E8%B5%9B/" rel="bookmark" title="DASCTF出题人挑战赛">DASCTF出题人挑战赛</a></li><li><a href="/2022/07/08/match/babyrsa/" rel="bookmark" title="鹏程杯2022">鹏程杯2022</a></li><li><a href="/2022/07/11/match/%E8%93%9D%E5%B8%BD%E6%9D%AF2022/" rel="bookmark" title="蓝帽杯2022">蓝帽杯2022</a></li><li><a href="/2022/07/18/match/DSCTF/" rel="bookmark" title="DSCTF">DSCTF</a></li><li><a href="/2022/07/18/match/NepNep/" rel="bookmark" title="NepNep">NepNep</a></li><li class="active"><a href="/2022/07/21/match/CRYPTO%20CTF/" rel="bookmark" title="CRYPTO CTF">CRYPTO CTF</a></li><li><a href="/2022/07/25/match/DASCTF2022-07%E8%B5%8B%E8%83%BD%E8%B5%9B/" rel="bookmark" title="DASCTF2022.07赋能赛">DASCTF2022.07赋能赛</a></li><li><a href="/2022/08/01/match/%E5%BC%BA%E7%BD%91%E6%9D%AF/" rel="bookmark" title="强网杯2022">强网杯2022</a></li><li><a href="/2022/08/04/match/ctfshow%20%E4%B8%83%E5%A4%95%E6%9D%AF/" rel="bookmark" title="ctfshow七夕杯">ctfshow七夕杯</a></li><li><a href="/2022/08/29/match/%E7%BD%91%E9%BC%8E%E6%9D%AF/" rel="bookmark" title="网鼎杯预赛2022">网鼎杯预赛2022</a></li><li><a href="/2022/09/16/match/%E7%BD%91%E4%BF%A1%E6%9F%8F%E9%B9%AD%E6%9D%AF/" rel="bookmark" title="柏鹭杯">柏鹭杯</a></li><li><a href="/2022/09/17/match/2022%E6%B5%99%E6%B1%9F%E7%9C%81%E8%B5%9B/" rel="bookmark" title="2022浙江省赛">2022浙江省赛</a></li><li><a href="/2022/09/20/match/DASCTF%20X%20GFCTF%202022%E5%8D%81%E6%9C%88%E6%8C%91%E6%88%98%E8%B5%9B/" rel="bookmark" title="DASCTF X GFCTF 2022十月挑战赛">DASCTF X GFCTF 2022十月挑战赛</a></li><li><a href="/2022/09/20/match/DASCTF%20X%20CBCTF%202022%E4%B9%9D%E6%9C%88%E6%8C%91%E6%88%98%E8%B5%9B/" rel="bookmark" title="DASCTF X CBCTF 2022九月挑战赛">DASCTF X CBCTF 2022九月挑战赛</a></li><li><a href="/2022/09/24/match/2022%E6%B5%99%E6%B1%9F%E7%9C%81%E8%B5%9B%E5%86%B3%E8%B5%9B/" rel="bookmark" title="2022浙江省赛">2022浙江省赛</a></li><li><a href="/2022/11/09/match/%E7%A5%A5%E4%BA%91%E6%9D%AF/" rel="bookmark" title="祥云杯">祥云杯</a></li><li><a href="/2022/11/27/match/DASCTF%20NOV/" rel="bookmark" title="DASCTF NOV X联合出题人2022年度积分榜争夺赛！">DASCTF NOV X联合出题人2022年度积分榜争夺赛！</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="Putao0v0" data-src="/images/1.jpg"><p class="name" itemprop="name">Putao0v0</p><div class="description" itemprop="description"></div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">59</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">4</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">3</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL3B1dGFvLWFp" title="https:&#x2F;&#x2F;github.com&#x2F;putao-ai"><i class="ic i-github"></i></span> <span class="exturl item weibo" data-url="aHR0cHM6Ly93ZWliby5jb20vdS8zNjEyMTE4NDMy" title="https:&#x2F;&#x2F;weibo.com&#x2F;u&#x2F;3612118432"><i class="ic i-weibo"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>友链</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/2022/07/18/match/NepNep/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/2022/07/22/crypto/%E5%8F%8D%E9%A6%88%E7%A7%BB%E4%BD%8D%E5%AF%84%E5%AD%98%E5%99%A8/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2010 – <span itemprop="copyrightYear">2023</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">Putao0v0 @ Putao0v0</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">525k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">7:57</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2022/07/21/match/CRYPTO CTF/",favicon:{show:"(*╹▽╹*)土豪我们做朋友好不好",hide:"你是猪吗^(*￣(oo)￣)^"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,copy_tex:!0,katex:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html><!-- rebuild by hrmmi -->